<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
canvas {
    border:1px solid #d3d3d3;
    background-color: #f1f1f1;
}
</style>
</head>
<body onload="startGame()">

<script>

//<p id='p2'>Message!</p>

/*
For i = 0 To 2
    Label14[i].Left = width - Label14[i].Width
    Label14[i].Top = Label4.Height + Label14[i].Height * i
}; //Next i
Label4.Left = width - Label4.Width
Label12.Left = width - Label12.Width
Label12.Top = height - Label12.Height

Me.FontBold = true
With Label1
    rct.Left = .Left / 15
    rct.Right = (.Width + .Left) / 15
    rct.Top = .Top / 15
    rct.Bottom = (.Height + .Top) / 15
    Me.Font.size = .Font.size
    Me.ForeColor = .ForeColor
    DrawText Me.hDC, .Caption, -1, rct, &H10
End With
With Label3
    rct.Left = .Left / 15
    rct.Right = (.Width + .Left) / 15
    rct.Top = .Top / 15
    rct.Bottom = (.Height + .Top) / 15
    Me.Font.size = .Font.size
    Me.ForeColor = .ForeColor
    DrawText Me.hDC, .Caption, -1, rct, &H10
End With
With Label4
    rct.Left = .Left / 15
    rct.Right = (.Width + .Left) / 15
    rct.Top = .Top / 15
    rct.Bottom = (.Height + .Top) / 15
    Me.Font.size = .Font.size
    Me.ForeColor = .ForeColor
    DrawText Me.hDC, .Caption, -1, rct, &H10
End With
With Label12
    rct.Left = .Left / 15
    rct.Right = (.Width + .Left) / 15
    rct.Top = .Top / 15
    rct.Bottom = (.Height + .Top) / 15
    Me.Font.size = .Font.size
    Me.ForeColor = .ForeColor
    DrawText Me.hDC, .Caption, -1, rct, &H10
End With

For i = 0 To 2
    With Label14[i]
        rct.Left = .Left / 15
        rct.Right = (.Width + .Left) / 15
        rct.Top = .Top / 15
        rct.Bottom = (.Height + .Top) / 15
        Me.Font.size = .Font.size
        Me.ForeColor = .ForeColor
        DrawText Me.hDC, .Caption, -1, rct, &H10
    End With
}; //Next i

if ( Picture13.Visible = true ) {
    SlowRoter = SlowRoter + 2
    if ( SVeh = false ) {
        DrawCar MX, MY + 5, SlowRoter
    } else {
        DrawPlane MX, MY + 5, BallZ(MX, MY + 4), SlowRoter
    }
    Picture14.PaintPicture Me.Image, 0, 0, Picture14.Width, Picture14.Height //', width / 4, height / 2, width / 2, height / 2
    Picture18.PaintPicture Image2.Picture, 0, 0, Picture18.Width, Picture18.Height
    testface
}
if ( width < 2 * Picture5.Width ) {
    Picture5.Left = 0
    Picture7.Top = height - Picture7.Height
    Picture7.Left = 0
}

if ( Weapon != Text6.Text ) { Text6.Text = Weapon
if ( Cond != Text7.Text ) { Text7.Text = Cond
*/




var myGamePiece;
var KeyDown = new Array(80);

function startGame() {
    myGameArea.start();
    window.addEventListener('resize', function resizeCanvas() {
            myGameArea.canvas.width = window.innerWidth;
            myGameArea.canvas.height = window.innerHeight;
            this.width = window.innerWidth;
            this.height = window.innerHeight;
            redraw();
        }, false);
    //setup()
    
    //width = 900; //750;
    //height = 550;
    width = window.innerWidth;
    height = window.innerHeight;
    
    // setup of the canvas
    var canvas = myGameArea.canvas;
    var ctx = canvas.getContext('2d');

    // pointer lock object forking for cross browser
    canvas.requestPointerLock = canvas.requestPointerLock ||
                                canvas.mozRequestPointerLock;
    document.exitPointerLock = document.exitPointerLock ||
                               document.mozExitPointerLock;
    canvas.onclick = function() {
      canvas.requestPointerLock();
    };

    // pointer lock event listeners
    // Hook pointer lock state change events for different browsers
    document.addEventListener('pointerlockchange', lockChangeAlert, false);
    document.addEventListener('mozpointerlockchange', lockChangeAlert, false);

    function lockChangeAlert() {
      if (document.pointerLockElement === canvas ||
          document.mozPointerLockElement === canvas) {
        console.log('The pointer lock status is now locked');
        //document.addEventListener("mousemove", updatePosition, false);
      } else {
        console.log('The pointer lock status is now unlocked');  
        //document.removeEventListener("mousemove", updatePosition, false);
      }
    }
    
    MX = 252;
    MY = 252;
    //'MZ = 0.5
    MZ = 15;
    X = 7;
    RX = -90;
    RY = 0;
    mouseX = width/2;
    mouseY = height/2;

	init();
    BuildMap();
}


function keyPressed(key) {
    if (key == 'a' || key == 'A') {
        KeyDown[37] = true;
    }
    if (key == 'w' || key == 'W') {
        KeyDown[38] = true;
    }
    if (key == 's' || key == 'S') {
        KeyDown[40] = true;
    }
    if (key == 'd' || key == 'D') {
        KeyDown[39] = true;
    }
    if (key.charCodeAt(0) == 37) {
        KeyDown[37] = true;
    }
    if (key.charCodeAt(0) == 38) {
        KeyDown[38] = true;
    }
    if (key.charCodeAt(0) == 39) {
        KeyDown[39] = true;
    }
    if (key.charCodeAt(0) == 40) {
        KeyDown[40] = true;
    }
    if (key.charCodeAt(0) == 4) {
        KeyDown[4] = true;
    } else if (key.charCodeAt(0) == 90) {
        KeyDown[4] = true;
    } else if (key.charCodeAt(0) == 81) {
        KeyDown[4] = true;
    } else {
        Zoom = 1;
    }
    if (key == 'e') {
        KeyDown[2] = true;
    }
    if (key.charCodeAt(0) == 69) {
        KeyDown[2] = true;
    }
    if (key.charCodeAt(0) == 16) {
        KeyDown[2] = true;
    }
    if (key.charCodeAt(0) == 17) {
        KeyDown[2] = true;
    }
    if (key.charCodeAt(0) == 2) {
        KeyDown[2] = true;
    }
    if (key.charCodeAt(0) == 9) { //TAB???
        KeyDown[9] = true;
    }
}
function keyReleased(key) {
    if (key == 'a' || key == 'A') {
        KeyDown[37] = false;
    }
    if (key == 'w' || key == 'W') {
        KeyDown[38] = false;
    }
    if (key == 's' || key == 'S') {
        KeyDown[40] = false;
    }
    if (key == 'd' || key == 'D') {
        KeyDown[39] = false;
    }
    if (key.charCodeAt(0) == 37) {
        KeyDown[37] = false;
    }
    if (key.charCodeAt(0) == 38) {
        KeyDown[38] = false;
    }
    if (key.charCodeAt(0) == 39) {
        KeyDown[39] = false;
    }
    if (key.charCodeAt(0) == 40) {
        KeyDown[40] = false;
    }
    if (key.charCodeAt(0) == 4) {
        KeyDown[4] = false;
    }
    if (key.charCodeAt(0) == 90) {
        KeyDown[4] = false;
    }
    if (key.charCodeAt(0) == 81) {
        KeyDown[4] = false;
    }
    if (key == 'e') {
        KeyDown[2] = false;
    }
    if (key.charCodeAt(0) == 69) {
        KeyDown[2] = false;
    }
    if (key.charCodeAt(0) == 16) {
        KeyDown[2] = false;
    }
    if (key.charCodeAt(0) == 17) {
        KeyDown[2] = false;
    }
    if (key.charCodeAt(0) == 2) {
        KeyDown[2] = false;
    }
    if (key.charCodeAt(0) == 9) { //TAB???
        KeyDown[9] = false;
    }
    
    //KeyDown[2]
}

var myGameArea = {
    canvas : document.createElement("canvas"),
    start : function() {
        this.canvas.width = window.innerWidth;
        this.canvas.height = window.innerHeight;
        //center the frame:
        this.canvas.setAttribute('style',"position: absolute;  left: 0%;margin-left:0px; top: 0%;margin-top:0px;background-color:black; width: 100%;height: 100%;margin: 0px;border: 0;overflow: hidden;display: block;");
        this.context = this.canvas.getContext("2d");
        this.canvas.addEventListener('click', function(event) {
            click = true;
            //selTwr = 0;
        }, false);
        this.canvas.addEventListener('mousedown', function(event) {
            var x = event.clientX - this.offsetLeft;
            var y = event.clientY - this.offsetTop;
            shoot = true;
            mousePressed(x, y);
        }, false);
        this.canvas.addEventListener('mouseup', function(event) {
            var x = event.clientX - this.offsetLeft;
            var y = event.clientY - this.offsetTop;
            shoot = false;
            mouseReleased(x, y);
        }, false);
        this.canvas.addEventListener('mousemove', function(event) {
            var x = event.clientX - this.offsetLeft;
            var y = event.clientY - this.offsetTop;
            //mouseX = x;
            //mouseY = y;
            mouseX += event.movementX*5;
            mouseY += event.movementY*5;
            //mouseM(x, y);
            mouseM(event);
        }, false);
        addEventListener("keydown", function(event) {
            var key = String.fromCharCode(event.keyCode);
            keyPressed(key);
        });
        addEventListener("keyup", function(event) {
            var key = String.fromCharCode(event.keyCode);
            keyReleased(key);
        });
        document.body.insertBefore(this.canvas, document.body.childNodes[0]);
        //this.interval = setInterval(updateGameArea, 20);
        this.interval = setInterval(draw, 50);
    },
    clear : function() {
        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
    }
}

function Rnd() {
    return Math.random()
}
function Int(i) {
    return Math.round(i);
}
function dist(x1, x2, y1, y2) {
    return Math.sqrt(Math.pow((x1 - x2), 2) + Math.pow((y1 - y2), 2))
}
function dist3d(x1, y1, z1, x2, y2, z2) {
    return Math.sqrt(Math.pow((x1 - x2), 2) + Math.pow((y1 - y2), 2)+ Math.pow((z1 - z2), 2))
}

function textSize(size) {
    ctx = myGameArea.context;
    ctx.font = size + "px Arial";
}
function text(txt, x, y) {
    ctx = myGameArea.context;
    ctx.fillText(txt,x,y);
}
function rect(x,y,w,h, c) {
    fill(c);
    ctx = myGameArea.context;
    ctx.fillRect(x,y,w,h);
}
function strokeWeight(w) {
    ctx = myGameArea.context;
    ctx.lineWidth = w;
}
function _rect(x,y,w,h) {
    ctx = myGameArea.context;
    ctx.beginPath();
    ctx.rect(x,y,w,h);
    ctx.stroke();
}
function line(x,y,x2,y2,c) {
    fill(c);
    ctx = myGameArea.context;
    ctx.beginPath();
    ctx.moveTo(x, y);
    ctx.lineTo(x2, y2);
    ctx.stroke();
}
function quad(x,y,x2,y2,x3,y3,x4,y4) {
    ctx = myGameArea.context;
    ctx.beginPath();
    ctx.moveTo(x, y);
    ctx.lineTo(x2, y2);
    ctx.stroke();
    ctx.lineTo(x3, y3);
    ctx.stroke();
    ctx.lineTo(x4, y4);
    ctx.stroke();
    ctx.closePath();
    ctx.fill();
}
function RGB(red,green,blue) {
    return {"r": red,
            "g": green,
            "b": blue,
            "a": 255};
}
function ellipse(x,y,w,c) {
    ctx = myGameArea.context;
    //color = c
    drawEllipse(ctx,x,y,w*2,w*2,true);
}
function fill(c) {
    ctx = myGameArea.context;
    ctx.fillStyle = 'rgba(' + c.r +', ' + c.g + ', ' + c.b + ',' + c.a + ')';
    stroke(c.r,c.g,c.b);
}
function stroke(r, g, b) {
    ctx = myGameArea.context;
    ctx.strokeStyle = 'rgba(' + r +', ' + g + ', ' + b + ', 1)';
}
function strokewidth(w) {
    ctx = myGameArea.context;
    ctx.lineWidth = w;
}

function msgbox(txt) {
    text(txt,0,0)
}

function drawEllipse(ctx, x, y, w, h,add) {
  //https://stackoverflow.com/questions/2172798/how-to-draw-an-oval-in-html5-canvas
  var kappa = .5522848,
      ox = (w / 2) * kappa, // control point offset horizontal
      oy = (h / 2) * kappa, // control point offset vertical
      xe = x + w,           // x-end
      ye = y + h,           // y-end
      xm = x + w / 2,       // x-middle
      ym = y + h / 2;       // y-middle

  ctx.beginPath();
  ctx.moveTo(x, ym);
  ctx.bezierCurveTo(x, ym - oy, xm - ox, y, xm, y);
  ctx.bezierCurveTo(xm + ox, y, xe, ym - oy, xe, ym);
  ctx.bezierCurveTo(xe, ym + oy, xm + ox, ye, xm, ye);
  ctx.bezierCurveTo(xm - ox, ye, x, ym + oy, x, ym);
  //ctx.closePath(); // not used correctly, see comments (use to close off open path)
  ctx.closePath();
  ctx.fill();
  //if (add)
  ctx.stroke();
}


var imges = new Array(10);
function picture(x,y,w,h,name, angle) {
    var image = new Image();
    var name2 = name;
    var ctx = myGameArea.context;
    ctx.translate( x + w/2, y  + h/2);
    ctx.rotate( angle );

    //http://gdurl.com/
    //STATS: https://gdurl.com/fOPn/stats
    if (name == "Rocket") {
        if (imges[0] == null) {
            name2 = "https://gdurl.com/sOU3B"; //"Ship.png";
            imges[0] = new Image();
            imges[0].src = name2;
        } else {
            image = imges[0];
        }
    } else if (name == "Shotgun") {
        if (imges[1] == null) {
            name2 = "https://gdurl.com/miCQ"; //"Ship.png";
            imges[1] = new Image();
            imges[1].src = name2;
        } else {
            image = imges[1];
        }
    } else if (name == "Sniper") {
        if (imges[2] == null) {
            name2 = "https://gdurl.com/j68t"; //"Ship.png";
            imges[2] = new Image();
            imges[2].src = name2;
        } else {
            image = imges[2];
        }
    } else if (name == "Grenade") {
        if (imges[3] == null) {
            name2 = "https://gdurl.com/Q20T"; //"Ship.png";
            imges[3] = new Image();
            imges[3].src = name2;
        } else {
            image = imges[3];
        }
    } else if (name == "Pistol") {
        if (imges[4] == null) {
            name2 = "https://gdurl.com/YYJA"; //"Ship.png";
            imges[4] = new Image();
            imges[4].src = name2;
        } else {
            image = imges[4];
        }
    } else if (name == "Rifle") {
        if (imges[5] == null) {
            name2 = "https://gdurl.com/9Obu"; //"Ship.png";
            imges[5] = new Image();
            imges[5].src = name2;
        } else {
            image = imges[5];
        }
    }
    //image.src = name2 //"drone.png"
    //img = document.getElementById(name);
    if (!image.complete || image.src == "" || image.naturalWidth < 5) {
        //ellipse(0,0,w/2,true) //
        //drawEllipse2(ctx,-w/4,-h/2,w/2,h,true);
        //rect(-w/6*2.5,-h/8,w/6*5,h/4);
    } else {
        ctx.drawImage(image, -w/2, -h/2, w, h);
    }
    ctx.rotate( -angle );
    ctx.translate( -(x + w/2), -(y + h/2) );
}


//function To3D(Xin, Yin, Zin) { //As ObjectO
//}



function mousePressed() {
    SXX = mouseX;
    SYY = mouseY;
    SRX = RX;
    SRY = RY;
    MDown = true;
}


function mouseM(e) {
    CX = mouseX;
    CY = mouseY;
    RY = -60 + mouseY * 120 / height;
    RX = -20 + -30 - mouseX * 120 / width;
}

function mouseReleased() {
    MDown = false;
}

function draw() {

	Timer1_Timer();

}

//calculates the rotation of a point around zero
function CalcAngle(FirstX, FirstY) { 
  //On Error Resume };
  var Angle ;// double;
  
  //calculates the angle and changes to degrees instead of radians
  Angle = (Math.atan((FirstY / FirstX))) * (180 / (Math.PI));
  
  //returns instantly for values where X = 0 (90* or 270*)
  if ( FirstX == 0 ) {
    if ( FirstY <= 0 ) {
      return(270);
    } 
    else {
      return(90);
    }
  } 
  //modifies the result depending on what secter the point is in:
  else if ( FirstX < 0 ) {
    return(180 + Angle);
  } 
  else {
    if ( FirstY <= 0 ) {
      return(360 + Angle);
    } 
    else {
      return(Angle);
    }
  }
}


////'Kano Framework: Christopher Rhys Jones 14/3/10 4:56

//Option Explicit

//Private Declare Function SetWindowPos& Lib "User32" (ByVal hwnd&, ByVal hWndInsertAfter&, ByVal x&, ByVal y&, ByVal Wid&, ByVal Hgt&, ByVal Flags&)

//Private Declare Function PlaySound& Lib "winmm.dll" Alias "PlaySoundA" (ByVal lpszName = ""; //xAs String, ByVal hModule = 0; //xAs Long, ByVal dwFlags = 0; //xAs Long)


var size = 250;
var vnum = 12;
var wl = -9;

var Seed = 0; //xAs Long

var HtInc = 0; //xAs Double
var LstHtInc = 0; //xAs Double

var Rainfor = 0; //xAs Long

var Clip2 = false; //xAs Boolean

var ZADD = 0; //xAs Double

var minx = 0; //xAs Long
var miny = 0; //xAs Long

var fromr = [0,0,0,0,0,0]; //xAs Long
var fromt = [0,0,0,0,0,0]; //xAs Long
var nxtfrom = 0; //xAs Long

var WpObj = 0; //xAs Long

var ND = 0; //xAs Long
var NDHealth = 0; //xAs Long

var objz = 0; //xAs Long

var SVeh = false; //xAs Boolean
var Surf = false; //xAs Boolean

var Sens = 0; //xAs Double

var GameType = 0; //xAs Long

var SlowRoter = 0; //xAs Double

var RainQt = 0; //xAs Long

var THold = false; //xAs Boolean
var speed = 1; //xAs Double

var FileFish = false; //xAs Boolean

var JTime = 0; //xAs Long

var LstCnfrm = 0; //xAs Long

var Cond = 0; //xAs Long

var Target = 0; //xAs Long

var LoadScreen = false; //xAs Boolean

var TFreeze = 0; //xAs Double

var Colup = 0; //xAs Double

var EHold = false; //xAs Boolean

var PlayerX = 0; //xAs Long

var APPs = 0; //xAs Long

var RKills = 0; //xAs Long
var RKDown = 0; //xAs Long

var TreeDown = 0; //xAs Long

var Kills = 0; //xAs Long
var Tink = true; //xAs Boolean

var Zoom = 0; //xAs Long
var ZHold = false; //xAs Boolean

var Red = 0; //xAs Double

var Fired = false; //xAs Boolean

var Health = 100; //xAs Long
var Start; //As Date

var Record = 0; //xAs Long
var Hits = 0; //xAs Long
var Deaths = 0; //xAs Long

var WKills = new Array(101); //xAs Long

var LstHit = 0; //xAs Long
var HitFor = 0; //xAs Long

//Private Type ObjectY
//    x(0 To 3) = 0; //xAs Double
//    y(0 To 3) = 0; //xAs Double
//    z(0 To 3) = 0; //xAs Double
//    Type = 0; //xAs Long
//    Colour = 0; //xAs Long
//    size = 0; //xAs Double
//End Type
var PolyX = new Array(500000); //As ObjectY
var LineAt = 0; //xAs Long

//Private Type Dad
//    x = 0; //xAs Double
//    y = 0; //xAs Double
//    Type = 0; //xAs Double
//    Color = 0; //xAs Long
//    speed = 0; //xAs Double
//    Grav = false; //xAs Boolean
//    Height = 0; //xAs Double
//End Type

var lava = new Array(500000); //As Dad
var NxtDad = 0; //xAs Long


//Private Type sht
//    x(0 To 1) = 0; //xAs Double
//    y(0 To 1) = 0; //xAs Double
//    z(0 To 1) = 0; //xAs Double
//    Type = 0; //xAs Long
//End Type
var Bullet = new Array(500); //As sht
var NxtBlt = 0; //xAs Long

var shoot = false; //xAs Boolean
var GrabX = 0; //xAs Long
var GrabY = 0; //xAs Long

var LstWep = 0; //xAs Long

var sll = 0; //xAs Long

var Sec = 0; //xAs Long
var Frame = 0; //xAs Long
var AvFrame = 10; //xAs Long

var _block = new Array(550); //(-20 To 520, -20 To 520) = 0; //xAs Double
var _Elev = new Array(550);
var _doodad = new Array(550);
var _Push = new Array(550);
var HScroll4Value = 2;
var HScroll2Value = 0;
var HScroll1Value = 0;
//var _Elev(-20 To 520, -20 To 520) = 0; //xAs Long
//var _doodad(-20 To 520, -20 To 520) = 0; //xAs Long
//var _Push(-20 To 520, -20 To 520) = 0; //xAs Long

//Private Declare Function GetAsyncKeyState Lib "User32" _
//   (ByVal vKey; //As KeyCodevarants) = 0; //xAs Long
   
//Private Declare Function SetCursorPos Lib "User32" (ByVal x = 0; //xAs Long, ByVal y = 0; //xAs Long) = 0; //xAs Long

var Ammo = 17; //xAs Long

var MX = 250; //xAs Double
var MY = 250; //xAs Double
var MZ = 0; //xAs Double

var PX = 100; //xAs Double
var PY = 100; //xAs Double
var PZ = 0; //xAs Double

var Jmp = 0; //xAs Double

var LMX = 0; //xAs Double
var LMY = 0; //xAs Double

var Screeny = 0; //xAs Long
var Screenz = 0; //xAs Long

var CX = 0; //xAs Double
var CY = 0; //xAs Double
var RX = 0; //xAs Double
var RY = 0; //xAs Double

var LstR = 0; //xAs Double

var SXX = 0; //xAs Double
var SYY = 0; //xAs Double
var SRX = 0; //xAs Double
var SRY = 0; //xAs Double
var SSpeed = 0; //xAs Double

var LPX = 0; //xAs Double
var LPY = 0; //xAs Double
var LPZ = 0; //xAs Double

var Rcoil = 0; //xAs Double
var Weapon = 0; //xAs Long

var CAt = 0; //xAs Long
var Bat = 0; //xAs Long

//Private Type ObjectO
//    x = 0; //xAs Long
//    y = 0; //xAs Long
//    z = 0; //xAs Long
//    size = 0; //xAs Long
//End Type

//Private Type dubz
//    x = 0; //xAs Double
//    y = 0; //xAs Double
//    z = 0; //xAs Double
//End Type

//Private Type Mas
//    x = 0; //xAs Double
//    y = 0; //xAs Double
//    LstX = 0; //xAs Double
//    LstY = 0; //xAs Double
//    DirectX = 0; //xAs Double
//    DirectY = 0; //xAs Double
//    Fire = 0; //xAs Double
//    //'RLoad = 0; //xAs Long
//    Kills = 0; //xAs Long
//    Deaths = 0; //xAs Long
//    Name = ""; //xAs String
//    Jump = 0; //xAs Double
//End Type
var Plr = new Array(101); //As Mas
var PMax = 0; //xAs Long
var ZPmx = 0; //xAs Long

var Achieved = new Array(500); //xAs Long

var Score = [0,0,0,0,0,0,0,0]; //xAs String

//Private Type Objectz
//    x(0 To 3) = 0; //xAs Double
//    y(0 To 3) = 0; //xAs Double
//    z(0 To 3) = 0; //xAs Double
//    Type = 0; //xAs Long
//    Colour = 0; //xAs Long
//    size = 0; //xAs Double
//    Dis = 0; //xAs Double
//End Type
var part = new Array(31); //As Objectz

//Private Type POINTAPI
//x = 0; //xAs Long
//y = 0; //xAs Long
//End Type
//Private Declare Function Polygon Lib "gdi32" (ByVal hDC = 0; //xAs Long, lpPoint; //As POINTAPI, ByVal nCount = 0; //xAs Long) = 0; //xAs Long

//Private Type RECT
//    Left = 0; //xAs Long
//    Top = 0; //xAs Long
//    Right = 0; //xAs Long
//    Bottom = 0; //xAs Long
//End Type
//Private Declare Function DrawText Lib "User32" Alias "DrawTextA" (ByVal hDC = 0; //xAs Long, ByVal lpStr = ""; //xAs String, ByVal nCount = 0; //xAs Long, lpRect; //As RECT, ByVal wFormat = 0; //xAs Long) = 0; //xAs Long

function block(i,j) {
	return _block[Int(i+25)][Int(j+25)];
}
function Elev(i,j) {
	return _Elev[Int(i+25)][Int(j+25)];
}
function doodad(i,j) {
	return _doodad[Int(i+25)][Int(j+25)];
}
function Push(i,j) {
	return _Push[Int(i+25)][Int(j+25)];
}

function init() {

    for (var i = 0; i < 31; i++) {
        part[i] = {"x": [0,0,0,0],
                    "y": [0,0,0,0],
                    "z": [0,0,0,0],
                    "Type": 0,
                    "Colour": 0,
                    "Size": 0,
                    "Dis": 0};
    };
    for (var i = 0; i < 101; i++) {
		WKills[i] = 0;
        Plr[i] = {"x": 0,
                  "y": 0,
                  "LstX": 0,
                  "LstY": 0,
                  "DirectX": 0,
                  "DirectY": 0,
                  "Fire": 0,
                  "Kills": 0,
                  "Deaths": 0,
                  "Jump": 0,
                  "Name": "Chris"};
    };
	
    for (var i = 0; i < 500; i++) {
		Achieved[i] = 0;
		Bullet[i] = {"x": [0,0],
                    "y": [0,0],
                    "z": [0,0],
                    "Type": 0};
	};
	
    for (var i = 0; i < 500000; i++) {
		PolyX[i] = {"x": [0,0,0,0],
                    "y": [0,0,0,0],
                    "z": [0,0,0,0],
                    "Type": 0,
					"Colour": RGB(0,0,0),
					"size": 0};
		lava[i] = {"x": 0,
                    "y": 0,
                    "Type": 0,
					"Color": RGB(0,0,0),
					"speed": 0,
					"Grav": 0,
					"Height": 0};
	};
    for (var i = 0; i < 550; i++) {
		_block[i] = new Array(550); //(-20 To 520, -20 To 520) = 0; //xAs Double
		_Elev[i] = new Array(550);
		_doodad[i] = new Array(550);
		_Push[i] = new Array(550);
		for (var j = 0; j < 550; j++) {
			_block[i][j] = 0; //(-20 To 520, -20 To 520) = 0; //xAs Double
			_Elev[i][j] = 0;
			_doodad[i][j] = 0;
			_Push[i][j] = 0;
		};
	};
}

function To3D(Xin, Yin, Zin) { //As ObjectO
    var GX  = 0; //xAs Double
    var GY  = 0; //xAs Double
    var GZ  = 0; //xAs Double
    var r1  = 0; //xAs Double
    var r2  = 0; //xAs Double
    var size = 0;
    r1 = RX + CalcAngle((Xin), (Yin)) + 180;

    GX = Math.cos(r1 * 4 * Math.atan(1) / 180) * dist(Xin,0,Yin,0);
    GY = Math.sin(r1 * 4 * Math.atan(1) / 180) * dist(Xin,0,Yin,0);

    r2 = RY + CalcAngle((Zin), (GY)) + 180;

    GZ = Math.cos(r2 * 4 * Math.atan(1) / 180) * dist(Zin,0,GY,0);
    GY = Math.sin(r2 * 4 * Math.atan(1) / 180) * dist(Zin,0,GY,0);
    if (GY > 0) {
        //size = (width / 15/((GX / 100) ^ 3 + (GY / 100) ^ 3 + (GZ / 100) ^ 3) ^ (1 / 3)) * (Zoom * 0.3 + ZADD)
        //size = (width/ 15/Math.abs(Math.abs(GX / 100) ^ 3 + Math.abs(GY / 100) ^ 3 + Math.abs(GZ / 100) ^ 3) ^ (1 / 3)) * (Zoom * 0.3 + ZADD)
        //size = (width/ 15/Math.abs(Math.abs(Xin / 100) ^ 3 + Math.abs(Yin / 100) ^ 3 + Math.abs(Zin / 100) ^ 3) ^ (1 / 3)) * (Zoom * 0.3 + ZADD)
        size = width*3/dist3d(Xin,Yin,Zin,0,0,0) * (Zoom * 0.3 + ZADD)
        
        //size = 10/(dist(Xin,Yin,0,0)) //(width / 15/((GX / 100) ^ 3 + (GY / 100) ^ 3 + (GZ / 100) ^ 3) ^ (1 / 3)) * (Zoom * 0.3 + ZADD)
        
        //size = (width/((GX / 100) ^ 2 + (GY / 100) ^ 2) ^ (1 / 2)) * (Zoom * 0.3 + ZADD) / 10
        //Int(Me.Width / 15 / ((GX / 100) ^ 3 + (GY / 100) ^ 3 + (GZ / 100) ^ 3) ^ (1 / 3)) * (Zoom * 0.3 + ZADD)
        GX = width * (Zoom * 0.3 + ZADD) / (GY / 100) * (GX / 100) + width / 2;
        GY = width * (Zoom * 0.3 + ZADD) / (GY / 100) * (GZ / 100) + height / 2;
        return {"x": (GX), 
                "y": (GY), 
                //"size": 
                "size": size }
    } else {
        return {"x": 0,"y": 0,"size": 0}
    }
}

var gameStart = true;

function Timer1_Timer() {
    //On Error Resume }; //Next
    var i = 0; //xAs Long
    var j = 0; //xAs Long
    var x = 0; //xAs Long
    var y = 0; //xAs Long
    var GX = 0; //xAs Double
    var GY = 0; //xAs Double
    var GZ = 0; //xAs Double
    var V = 0; //xAs Long
    var R1 = 0; //xAs Double
    var r2 = 0; //xAs Double
    var Ovr = 0; //xAs Long
    var k = 0; //xAs Long
    var Rr = 0; //xAs Double

    var txt = ""; //xAs String
    var Ins = false; //xAs Boolean
    var Rep = false; //xAs Boolean
    var mm = 0; //xAs Long
    var Yay = 0; //xAs Long
    var Alive = 0; //xAs Long
    var hevlex = 0; //xAs Long

    var rct = {"left": 0,
               "right":0,
               "top":0,
               "bottom":0}; //As RECT

    //'Label1.Caption = AvFrame
    
    //Label19[2].Caption = Label18.Caption + " Network"

    GameType = -5;
    AvFrame = 15;
    
    if ( gameStart ) {
        try {
            
            if ( GameType == 1 && Cond == 2 ) { Cond = 3; }
            
            //Picture21.Visible = false
            
            if ( Weapon == 98 ) { Ammo = 0 }
            
            if ( GameType == -5 ) {
                Alive = 0;
                for (i = 0; i < (2 ^ (HScroll4Value - 1)); i++) {
                    if ( Plr[i].Kills <= 0 ) {
                        Plr[i].x = 0;
                        Plr[i].y = 0;
                        Plr[i].DirectX = 0;
                    } else {
                        
                        Plr[i].LstX = Plr[i].x;
                        Plr[i].LstY = Plr[i].y;
                        
                        if ( (Weapon == 99 || (Weapon == 98 && PZ < BallZ(PX, PY) + 1)) && dist(Plr[i].x, PX,Plr[i].y, PY) < 2 ) {
                            Plr[i].Kills = -1;
                            KillInc();
                        }
                        
                        Alive = Alive + 1;
                        if ( Plr[i].y < 0 ) { Plr[i].y = Plr[i].y + size; }
                        if ( Plr[i].y > size ) { Plr[i].y = Plr[i].y - size; }
                        Yay = Math.abs(Plr[i].y - PY);
                        Rr = CalcAngle(Plr[i].x - PX, Plr[i].y - PY);
                        if ( Math.abs(Plr[i].y - PY - size) < Yay ) {
                            Yay = Math.abs(Plr[i].y - PY - size);
                            Rr = CalcAngle(Plr[i].x - PX, Plr[i].y - PY - size);
                        } else if ( Math.abs(Plr[i].y - PY + size) < Yay ) {
                            Yay = Math.abs(Plr[i].y - PY + size);
                            Rr = CalcAngle(Plr[i].x - PX, Plr[i].y - PY + size);
                        }
                        GX = Math.cos((180 + Rr) * 4 * Math.atan(1) / 180);
                        GY = Math.sin((180 + Rr) * 4 * Math.atan(1) / 180);
                        if ( Plr[i].Name == 100 ) {
                            if ( Math.abs(PX - Plr[i].x) > Math.abs(PY - Plr[i].y) ) {
                                GZ = CalcAngle((BallZ(Plr[i].x, Plr[i].y) + 0.5) - PZ, GX * dist(Plr[i].x, PX,Plr[i].y, PY));
                            } else {
                                GZ = CalcAngle((BallZ(Plr[i].x, Plr[i].y) + 0.5) - PZ, GY * dist(Plr[i].x, PX,Plr[i].y, PY));
                            }
                            Plr[i].Fire = Int(Plr[i].Name);
                            Plr[i].DirectX = -90 - Rr;
                            Plr[i].DirectY = GZ + 90;
                            Plr[i].x = Plr[i].x + GX / AvFrame * 8;
                            Plr[i].y = Plr[i].y + GY / AvFrame * 8;
                        } else {
                            if ( dist(Plr[i].x, PX,Plr[i].y, PY) > 5 ) {
                                Plr[i].x = Plr[i].x + GX / AvFrame * 2;
                                Plr[i].y = Plr[i].y + GY / AvFrame * 2;
                            }
                            if ( dist(Plr[i].x, PX,Plr[i].y, PY) < 8 ) {
                                if ( Plr[i].Deaths == 0 ) {
                                    if ( Math.abs(PX - Plr[i].x) > Math.abs(PY - Plr[i].y) ) {
                                        GZ = CalcAngle((BallZ(Plr[i].x, Plr[i].y) + 0.5) - PZ, GX * dist(Plr[i].x, PX,Plr[i].y, PY));
                                    } else {
                                        GZ = CalcAngle((BallZ(Plr[i].x, Plr[i].y) + 0.5) - PZ, GY * dist(Plr[i].x, PX,Plr[i].y, PY));
                                    }
                                    Plr[i].Fire = Int(Plr[i].Name);
                                    Plr[i].DirectX = -90 - Rr;
                                    Plr[i].DirectY = GZ + 90;
                                    Plr[i].Deaths = 1 + Rnd() * (5 - HScroll4Value);
                                } else if ( Tink == true ) {
                                    Plr[i].Deaths = Plr[i].Deaths - 1;
                                }
                            }
                        }
                        if ( dist(Plr[i].x, PX,Plr[i].y, PY) < 10 ) {
                            if ( doodad(Plr[i].x, Plr[i].y) > 400 || (doodad(Plr[i].x, Plr[i].y) > 0 && doodad(Plr[i].x, Plr[i].y) < 100) || (Elev(Plr[i].x, Plr[i].y) != 0 && HtInc == 0) ) {
                                Plr[i].x = Plr[i].LstX;
                                Plr[i].y = Plr[i].LstY;
                            }
                        }
                        
                    }
                }; //Next i
                PMax = 10;
                if ( Alive = 0 ) {
                    Health == 100
                    for (i = 0; i <= 10; i++) {
                        Plr[i].x = Rnd() * size;
                        Plr[i].y = Rnd() * size;
                        Plr[i].Kills = 100;
                        Plr[i].Name = 1;
                        hevlex = Rnd() * 50;
                        if ( hevlex < 15 ) { Plr[i].Name = 4; }
                        if ( hevlex < 2 ) { Plr[i].Name = 2; }
                    }; //Next i
                }
            }
            
            if ( TFreeze < 1 && RainQt > 0 ) {
                Ovr = RainQt;
                for (k = 0; k <= NxtDad + RainQt; k++) {
                    if ( lava[k].Type == 0 || k > NxtDad ) {
                        if ( Ovr > 0 ) {
                            Ovr = Ovr - 1;
                            lava[k].x = MX - 10 + Rnd() * 20;
                            lava[k].y = MY - 10 + Rnd() * 20;
                            lava[k].Color = RGB(0, 0, 200 + Rnd() * 55);
                            if ( Cond == 3 ) { lava[k].Color = RGB(200 + Rnd() * 55, 0, 0); }
                            if ( doodad(lava[k].x, lava[k].y) != 180 ) { lava[k].Type = 1; }
                            lava[k].speed = 0.05 + Rnd() * 0.3;
                            lava[k].Grav = true;
                            lava[k].Height = 10;
                            if ( k > NxtDad ) { NxtDad = k; }
                        } else {
                            lava[k] = lava[k + 1];
                            lava[k + 1].Type = 0;
                        }
                    }
                }; //Next k
            }
            
            
            try {
                if ( Weapon < 98 ) {
                    //'speed = 1
                    if (Weapon == 0) {
                        speed = 1.5; //'pistol
                    } else if (Weapon == 1) {
                        speed = 1.1; //'rlauncher
                    } else if (Weapon == 2) {
                        speed = 1.3; //'sniper
                    } else if (Weapon == 3) {
                        speed = 1.2; //'glauncher
                    } else if (Weapon == 4) {
                        speed = 1.4; //'shotgun
                    } else if (Weapon == 5) {
                        speed = 1.3; //'scarh
                    }
                } else {
                    //'if ( speed > 0.5 ) {
                    //'    speed = speed - 0.1
                    //'} else {
                    //'    speed = 0.5
                    //'}
                    if ( Weapon == 99 && speed > 3 ) { speed = 3; }
                    if ( Weapon == 98 && speed > 5 ) { speed = 5; }
                    if ( PZ < wl + 0.3 && Cond != 2 ) {
                        _doodad[PX][PY] = 1;
                        if ( Weapon == 98 ) { _doodad[PX][PY] = 2; }
                        GX = Math.cos((90 - RX) * 4 * Math.atan(1) / 180);
                        GY = Math.sin((90 - RX) * 4 * Math.atan(1) / 180);
                        PX = PX - GX;
                        PY = PY - GY;
                        Weapon = LstWep;
                    }
                }
            } catch(e) {
                //text ("EE", 0, height - 30);
                //To fix later? - happens sometimes
            }
            
            if ( KeyDown[4] ) { // KeyDown(90) || KeyDown(81) || 
                if ( ZHold == false ) {
                    if ( Zoom == 1 ) { Zoom = 5; } else { Zoom = 1; }
                }
                ZHold = true;
            } else {
                ZHold = false;
            }
            if ( Weapon >= 98 ) { Zoom = 1; }
            
            
            RX = RX - Int(RX / 720) * 720;
            
            if ( (KeyDown[37] ) && Weapon < 98 ) {
                GX = Math.cos((0 - RX) * 4 * Math.atan(1) / 180);
                GY = Math.sin((0 - RX) * 4 * Math.atan(1) / 180);
                PX = PX + GX / AvFrame * 2 * speed;
                PY = PY + GY / AvFrame * 2 * speed;
            }
            if ( KeyDown[38] ) {
                GX = Math.cos((90 - RX) * 4 * Math.atan(1) / 180);
                GY = Math.sin((90 - RX) * 4 * Math.atan(1) / 180);
                PX = PX + GX / AvFrame * 2 * speed;
                PY = PY + GY / AvFrame * 2 * speed;
                if ( Weapon == 98 ) {
                    GZ = Math.cos((-90 - RY) * 4 * Math.atan(1) / 180);
                    PZ = PZ + GZ / AvFrame * 2 * speed;
                }
                speed = speed + 0.2;
                LstR = RX;
            } else {
                speed = 0.5;
            }
            if ( (KeyDown[39]) && Weapon < 98 ) {
                GX = Math.cos((180 - RX) * 4 * Math.atan(1) / 180);
                GY = Math.sin((180 - RX) * 4 * Math.atan(1) / 180);
                PX = PX + GX / AvFrame * 2 * speed;
                PY = PY + GY / AvFrame * 2 * speed;
            }
            if ( KeyDown[40] ) {
                GX = Math.cos((270 - RX) * 4 * Math.atan(1) / 180);
                GY = Math.sin((270 - RX) * 4 * Math.atan(1) / 180);
                PX = PX + GX / AvFrame * 2 * speed;
                PY = PY + GY / AvFrame * 2 * speed;
                if ( Weapon == 98 ) {
                    GZ = Math.cos((-270 - RY) * 4 * Math.atan(1) / 180);
                    PZ = PZ + GZ / AvFrame * 2 * speed;
                }
                LstR = RX;
            }
            
            if ( TFreeze > 0 ) { TFreeze = TFreeze - 10 / AvFrame; }
            
            if ( KeyDown[32] ) {
                if ( Jmp == 0 ) { Jmp = 1; }
                //'TFreeze = 50
            }
            
            
            if ( Jmp > 0 ) {
                Jmp = Jmp - 2 / AvFrame
                if ( Jmp < 2 / AvFrame ) { Jmp = 0; }
            }
            
            if ( Weapon != 98 ) {
                if ( (doodad(PX - 0.5, PY - 0.5) < 180 || doodad(PX - 0.5, PY - 0.5) > 200) ) {
                    if ( HtInc > 0 ) {
                        LstHtInc = 1.5;
                        HtInc = HtInc - 2 / AvFrame;
                        if ( HtInc < 0 ) { HtInc = 0; }
                    } else {
                        LstHtInc = 0;
                    }
                } else if ( doodad(PX - 0.5, PY - 0.5) == 190 && HtInc < 2 ) {
                    //HtInc = (PY - Int(PY)) * 1.5;
                    HtInc = 1.5 - (PY - Int(PY)) * 1.5;
                } else if ( doodad(PX - 0.5, PY - 0.5) == 191 && HtInc < 2 ) {
                    HtInc = 1.5 - (PX - Int(PX)) * 1.5;
                } else if ( doodad(PX - 0.5, PY - 0.5) == 192 && HtInc < 2 ) {
                    HtInc = 1.5 - (PY - Int(PY)) * 1.5;
                } else if ( doodad(PX - 0.5, PY - 0.5) == 193 && HtInc < 2 ) {
                    //HtInc = (PX - Int(PX)) * 1.5;
                    HtInc = 1.5 - (PX - Int(PX)) * 1.5;
                } else if ( doodad(PX - 0.5, PY - 0.5) == 194 && HtInc > 1 ) {
                    //HtInc = 1.5 + (PY - Int(PY)) * 1.5;
                    HtInc = 3 - (PY - Int(PY)) * 1.5;
                } else if ( doodad(PX - 0.5, PY - 0.5) == 195 && HtInc > 1 ) {
                    HtInc = 3 - (PX - Int(PX)) * 1.5;
                } else if ( doodad(PX - 0.5, PY - 0.5) == 196 && HtInc > 1 ) {
                    HtInc = 3 - (PY - Int(PY)) * 1.5;
                } else if ( doodad(PX - 0.5, PY - 0.5) == 197 && HtInc > 1 ) {
                    //HtInc = 1.5 + (PX - Int(PX)) * 1.5;
                    HtInc = 3 - (PX - Int(PX)) * 1.5;
                
                } else if ( HtInc > 1 && HtInc < 2 ) {
                    HtInc = 1.5;
                } else if ( HtInc > 2.5 ) {
                    HtInc = 3;
                }
                if ( Weapon == 99 ) { HtInc = 0; LstHtInc = 0; }
                PZ = BallZ(PX, PY) + 0.5 + Jmp + HtInc;
            }
            
            if ( Cond == 1 && PZ < wl + 0.5 ) { PZ = wl + 0.5; }
            
            if ( RY > 60 ) { RY = 60; }
            if ( RY < -60 ) { RY = -60; }
            
            
            Frame = Frame + 1;
            //Tink = false;
            
            if ( Tink == true ) { Rainfor = Rainfor + 1; }
            if ( Rainfor >= 0 && PlayerX == 0 ) {
                if ( RainQt < 1 ) { RainQt = 1; }
                if ( Tink == true ) { RainQt = RainQt + Int(RainQt * Rnd()); }
                i = 1;
                if ( Cond == 0 || Cond == 2 ) { i = 2; }
                if ( Rainfor > 20 * i ) {
                    Rainfor = -20 - Rnd() * 60;
                }
                RainQt += 1;
            } else {
                if ( Tink == true ) { RainQt = RainQt - Int(RainQt * Rnd()); }
            }
            
            if ( Cond == 0 && RainQt > 100 ) { RainQt = 100; }
            if ( Cond == 1 && RainQt > 40 ) { RainQt = 40; }
            if ( Cond == 2 && RainQt > 5 ) { RainQt = 5; }
            if ( Cond == 3 && RainQt > 15 ) { RainQt = 15; }
            if ( RainQt < 3 ) { RainQt = 3; }
            
            //'if ( block(px, py) > 0 && block(px, py) != 2 && block(lmx, lmy) = 0 ) {
            //'    px = lmx
            //'    py = lmy
            //'} else if ( block(px, py) = 0 && block(lmx, lmy) != 2 && block(lmx, lmy) > 0 ) {
            //'    px = lmx
            //'    py = lmy
            //'}
            
            if ( Weapon != 98 ) {
                if ( Elev((PX - 0.5), PY) == 99 || Elev(PX, (PY - 0.5)) == 99 ) {
                } else if ( (Elev(PX, PY) > 0 && HtInc == 0) || (Elev(PX, PY) > 20 && HtInc < 2) ) {
                    if ( Elev(PX, LMY) == 0 ) {
                        PY = LMY;
                    } else {
                        PX = LMX;
                        if ( Elev(PX, PY) > 0 ) { PY = LMY; }
                    }
                    if ( LstHtInc > HtInc ) { HtInc = LstHtInc; }
                }
                
                if ( (doodad((PX - 0.5), (PY - 0.5)) > 0 && doodad((PX - 0.5), (PY - 0.5)) < 100) || doodad((PX - 0.5), (PY - 0.5)) > 400 ) {
                    if ( doodad((PX - 0.5), (PY - 0.5)) > 400 && Weapon == 99 ) {
                        _doodad[Int(PX - 0.5)+25][Int(PY - 0.5)+25] = 0;
                        //newPush (PX - 0.5), (PY - 0.5);
                        KillInc();
                    } else {
                        if ( doodad((PX - 0.5), (LMY - 0.5)) == 0 ) {
                            PY = LMY;
                        } else {
                            PX = LMX;
                            if ( doodad((PX - 0.5), (PY - 0.5)) > 0 ) { PY = LMY; }
                        }
                    }
                }
            } else {
                if ( Elev(PX, PY) > 0 && PZ < BallZ(PX, PY) + 1.5 ) {
                    if ( Elev(PX, LMY) == 0 ) {
                        PY = LMY;
                    } else {
                        PX = LMX;
                        if ( Elev(PX, PY) > 0 ) { PY = LMY; }
                    }
                }
                
                if ( Elev(PX, PY) > 20 && PZ < BallZ(PX, PY) + 3 ) {
                    if ( Elev(PX, LMY) == 0 ) {
                        PY = LMY;
                    } else {
                        PX = LMX;
                        if ( Elev(PX, PY) > 20 ) { PY = LMY; }
                    }
                }
                var ddddskip = false;
                //'if ( doodad(Bullet[i].X[0], Bullet[i].Y[0]) = 1 && Bullet[i].z[0] < BallZ(Bullet[i].X[0], Bullet[i].Y[0]) + 0.5 ) { Bullet[i].Type = 0
                if ( (doodad((PX - 0.5), (PY - 0.5)) > 0 && doodad((PX - 0.5), (PY - 0.5)) < 100) || doodad((PX - 0.5), (PY - 0.5)) > 400 ) {
                    var dddddad = doodad((PX - 0.5), (PY - 0.5));
                    if (dddddad == 1 || dddddad == 2) {
                        if ( PZ > BallZ(PX, PY) + 0.5 ) { ddddskip = true; }
                    } else if (dddddad == 5) {
                        if ( PZ > BallZ(PX, PY) + 2 ) { ddddskip = true; }
                    } else if (dddddad == 6 || dddddad == 7 ||dddddad == 8) {
                        if ( PZ > BallZ(PX, PY) + 1 ) { ddddskip = true; }
                    } else if (dddddad == 500 || dddddad == 501 || dddddad == 502 || dddddad == 503 || dddddad == 504 || dddddad == 505 || dddddad == 510) {
                        //Case 500, 501, 502, 503, 504, 505, 210
                        if ( PZ < BallZ(PX, PY) + 1 ) {
                            if ( doodad((PX - 0.5), (PY - 0.5)) == 210 ) {
                                //Push((PX - 0.5), (PY - 0.5)) = 1;
                            } else {
                                //newPush (PX - 0.5, PY - 0.5);
                            }
                            _doodad[Int(PX - 0.5)+ 25][Int(PY - 0.5)+ 25] = 0;
                            
                            KillInc();
                        }
                        ddddskip = true;
                    }
                    if (ddddskip == false) {
                        if ( doodad((PX - 0.5), (PY - 0.5)) > 400 && Weapon == 99 ) {
                            _doodad[Int(PX - 0.5)+ 25][Int(PY - 0.5) + 25] = 0;
                            //newPush (PX - 0.5), (PY - 0.5);
                            KillInc();
                        } else {
                            if ( doodad((PX - 0.5), (LMY - 0.5)) == 0 ) {
                                PY = LMY;
                            } else {
                                PX = LMX;
                                if ( doodad((PX - 0.5), (PY - 0.5)) > 0 ) { PY = LMY; }
                            }
                        }
                    }
                }
                if (ddddskip == false) {
                    if ( doodad((PX - 0.5), (PY - 0.5)) == 180 && PZ < BallZ(PX, PY) + 1.8 ) {
                        PZ = BallZ(PX, PY) + 1.8;
                    }
                    if ( doodad((PX - 0.5), (PY - 0.5)) == 181 && PZ < BallZ(PX, PY) + 3.3 ) {
                        PZ = BallZ(PX, PY) + 3.3;
                    }
                    if ( doodad((PX - 0.5), (PY - 0.5)) == 182 && (PZ < BallZ(PX, PY) + 3.3 && PZ > BallZ(PX, PY) + 2.5) ) {
                        PZ = BallZ(PX, PY) + 3.3;
                    }
                }
            }
        //ttnext:
            LMX = PX;
            LMY = PY;
            
            if ( KeyDown[9] ) { //vbKeyTab
                if ( THold == false ) {
                    if ( Check1.Value == 1 ) { Check1.Value = 0; } else { Check1.Value = 1; }
                }
                THold = true;
            } else {
                THold = false;
            }
            
            if ( Rcoil <= 0 ) {
                if ( shoot == true && Ammo > 0 ) {
                    if ( Weapon != 4 ) {
                        Bullet[NxtBlt].x[0] = PX;
                        Bullet[NxtBlt].y[0] = PY;
                        Bullet[NxtBlt].z[0] = BallZ(PX, PY) + 0.5 + Jmp + HtInc;
                        
                        GX = Math.cos((90 - RX) * 4 * Math.atan(1) / 180);
                        GY = Math.sin((90 - RX) * 4 * Math.atan(1) / 180);
                        
                        GZ = Math.cos((-RY - 90) * 4 * Math.atan(1) / 180); //' * 1.1 //' * Sqr(Abs[1] ^ 2 + Math.abs(GY) ^ 2) * 0.9
                        //'GY = Math.sin(RY * 4 * Math.atan(1) / 180) * Sqr(Abs[1] ^ 2 + Math.abs(GY) ^ 2)
                        
                        Bullet[NxtBlt].x[1] = GX * 2;
                        Bullet[NxtBlt].y[1] = GY * 2;
                        Bullet[NxtBlt].z[1] = GZ * 2;
                        Bullet[NxtBlt].Type = 1 + Weapon;
                        NxtBlt = NxtBlt + 1;
                        if ( NxtBlt > 300 ) { NxtBlt = 0; }
                    } else {
                        for (i = 0; i <= 10; i++) {
                            Bullet[NxtBlt].x[0] = PX;
                            Bullet[NxtBlt].y[0] = PY;
                            Bullet[NxtBlt].z[0] = BallZ(PX, PY) + 0.5 + Jmp + HtInc;
                            
                            GX = Math.cos((93 - RX - Rnd() * 6) * 4 * Math.atan(1) / 180);
                            GY = Math.sin((93 - RX - Rnd() * 6) * 4 * Math.atan(1) / 180);
                            
                            GZ = Math.cos((-RY - 93 + Rnd() * 6) * 4 * Math.atan(1) / 180); //' * 1.1 //' * Sqr(Abs[1] ^ 2 + Math.abs(GY) ^ 2) * 0.9
                            //'GY = Math.sin(RY * 4 * Math.atan(1) / 180) * Sqr(Abs[1] ^ 2 + Math.abs(GY) ^ 2)
                            
                            Bullet[NxtBlt].x[1] = GX * 2;
                            Bullet[NxtBlt].y[1] = GY * 2;
                            Bullet[NxtBlt].z[1] = GZ * 2;
                            Bullet[NxtBlt].Type = 1;
                            NxtBlt = NxtBlt + 1;
                            if ( NxtBlt > 300 ) { NxtBlt = 0; }
                        }; //Next i
                        Record = Record + 9;
                    }
                    Ammo = Ammo - 1;
                    if ( Weapon == 5 ) { Ammo = Ammo - 2; }
                    if ( Ammo < 0 ) { Ammo = 0; }
                    Record = Record + 1;
                    Fired = true;
                    if (Weapon == 0) {//'pistol
                        Rcoil = 2;
                        //PlaySound App.Path + "\pistol.wav", 0, 1
                    } else if (Weapon == 1) {  //'rlauncher
                        Rcoil = 30;
                        //PlaySound App.Path + "\rocket.wav", 0, 1
                    } else if (Weapon == 2) { //'sniper
                        Rcoil = 20;
                        //PlaySound App.Path + "\sniper.wav", 0, 1
                    } else if (Weapon == 3) { //'glauncher
                        Rcoil = 15;
                        //PlaySound App.Path + "\grenade.wav", 0, 1
                    } else if (Weapon == 4) {//'shotgun
                        Rcoil = 10;
                        //PlaySound App.Path + "\shotgun.wav", 0, 1
                    } else if (Weapon == 5) { //'scarh
                        Rcoil = 5;
                        //PlaySound App.Path + "\scarh.wav", 0, 1
                    }
                }
            } else {
                Rcoil = Rcoil - 4 / AvFrame;
            }
            
            
            if ( Weapon == 99 ) {
                txt = "";
                if ( (KeyDown[2]) && EHold == false ) {
                    Weapon = LstWep;
                    _doodad[Int(PX+25)][Int(PY+25)] = 1;
                    GX = Math.cos((90 - RX) * 4 * Math.atan(1) / 180);
                    GY = Math.sin((90 - RX) * 4 * Math.atan(1) / 180);
                    PX = PX - GX;
                    PY = PY - GY;
                    Weapon = LstWep;
                }
            } else if ( Weapon == 98 ) {
                txt = "";
                if ( (KeyDown[2]) && EHold == false ) {
                    Weapon = LstWep;
                    _doodad[Int(PX+25)][Int(PY+25)] = 2;
                    GX = Math.cos((90 - RX) * 4 * Math.atan(1) / 180);
                    GY = Math.sin((90 - RX) * 4 * Math.atan(1) / 180);
                    PX = PX - GX;
                    PY = PY - GY;
                    Weapon = LstWep;
                }
            } else {
                for (i = -1; i <= 1; i++) {
                    for (j = -1; j <= 1; j++) {
                        if ( doodad(PX - 0.5 + i, PY - 0.5 + j) == 1 ) {
                            txt = "Press E to Enter Vehicle";
                            if ( (KeyDown[2]) && Weapon < 98 && EHold == false ) {
                                LstWep = Weapon;
                                Weapon = 99;
                                Ammo = 0;
                                _doodad[Int(PX - 0.5 + i+25)][Int(PY - 0.5 + j+25)] = 0;
                            }
                        }
                        if ( doodad(PX - 0.5 + i, PY - 0.5 + j) == 2 ) {
                            txt = "Press E to Enter Vehicle";
                            if ( (KeyDown[2]) && Weapon < 98 && EHold == false ) {
                                LstWep = Weapon;
                                Weapon = 98;
                                Ammo = 0;
                                _doodad[Int(PX - 0.5 + i+25)][Int(PY - 0.5 + j+25)] = 0;
                            }
                        }
                        if ( doodad(PX - 0.5 + i, PY - 0.5 + j) == 101 || doodad(PX - 0.5 + i, PY - 0.5 + j) == 201 ) {
                            txt = "Press E to Pick Up Shotgun";
                            if ( Weapon == 4 ) {
                                _doodad[Int(PX - 0.5 + i+25)][Int(PY - 0.5 + j+25)] = 0;
                                Ammo = 12;
                                txt = "Picked Up Shotgun Ammo";
                                Clip2 = true;
                            }
                            if ( (KeyDown[2]) ) {
                                Weapon = 4;
                                Ammo = 12;
                                Clip2 = true;
                                _doodad[Int(PX - 0.5 + i+25)][Int(PY - 0.5 + j+25)] = 0;
                            }
                        }
                        if ( doodad(PX - 0.5 + i, PY - 0.5 + j) == 102 || doodad(PX - 0.5 + i, PY - 0.5 + j) == 202 ) {
                            txt = "Press E to Pick Up Rocket Launcher";
                            if ( Weapon == 1 ) {
                                _doodad[Int(PX - 0.5 + i+25)][Int(PY - 0.5 + j+25)] = 0;
                                Ammo = 2;
                                txt = "Picked Up Rocket Launcher Ammo";
                                Clip2 = true;
                            }
                            if ( (KeyDown[2]) ) {
                                Weapon = 1;
                                Ammo = 2;
                                Clip2 = true;
                                _doodad[Int(PX - 0.5 + i+25)][Int(PY - 0.5 + j+25)] = 0;
                            }
                        }
                        if ( doodad(PX - 0.5 + i, PY - 0.5 + j) == 103 || doodad(PX - 0.5 + i, PY - 0.5 + j) == 203 ) {
                            txt = "Press E to Pick Up Grenade Launcher";
                            if ( Weapon == 3 ) {
                                _doodad[Int(PX - 0.5 + i+25)][Int(PY - 0.5 + j+25)] = 0;
                                Ammo = 6;
                                txt = "Picked Up Grenade Launcher Ammo";
                                Clip2 = true;
                            }
                            if ( (KeyDown[2]) ) {
                                Weapon = 3;
                                Ammo = 6;
                                Clip2 = true;
                                _doodad[Int(PX - 0.5 + i+25)][Int(PY - 0.5 + j+25)] = 0;
                            }
                        }
                        if ( doodad(PX - 0.5 + i, PY - 0.5 + j) == 104 || doodad(PX - 0.5 + i, PY - 0.5 + j) == 204 ) {  //'pya
                            txt = "Press E to Pick Up Pistol";
                            if ( Weapon == 0 ) {
                                _doodad[Int(PX - 0.5 + i+25)][Int(PY - 0.5 + j+25)] = 0;
                                Ammo = 17;
                                txt = "Picked Up Pistol Ammo";
                                Clip2 = true;
                            }
                            if ( (KeyDown[2]) ) {
                                Weapon = 0;
                                Ammo = 17;
                                Clip2 = true;
                                _doodad[Int(PX - 0.5 + i+25)][Int(PY - 0.5 + j+25)] = 0;
                            }
                        }
                        if ( doodad(PX - 0.5 + i, PY - 0.5 + j) == 105 || doodad(PX - 0.5 + i, PY - 0.5 + j) == 205 ) {
                            txt = "Press E to Pick Up Sniper";
                            if ( Weapon == 2 ) {
                                _doodad[Int(PX - 0.5 + i+25)][Int(PY - 0.5 + j+25)] = 0;
                                Ammo = 5;
                                txt = "Picked Up Sniper Ammo";
                                Clip2 = true;
                            }
                            if ( (KeyDown[2]) ) {
                                Weapon = 2;
                                Ammo = 5;
                                Clip2 = true;
                                _doodad[Int(PX - 0.5 + i+25)][Int(PY - 0.5 + j+25)] = 0;
                            }
                        }
                        if ( doodad(PX - 0.5 + i, PY - 0.5 + j) == 106 || doodad(PX - 0.5 + i, PY - 0.5 + j) == 206 ) {
                            txt = "Press E to Pick Up Scar-H";
                            if ( Weapon == 5 ) {
                                _doodad[Int(PX - 0.5 + i+25)][Int(PY - 0.5 + j+25)] = 0;
                                Ammo = 20;
                                txt = "Picked Up Scar-H Ammo";
                                Clip2 = true;
                            }
                            if ( (KeyDown[2]) ) {
                                Weapon = 5;
                                Ammo = 20;
                                _doodad[Int(PX - 0.5 + i+25)][Int(PY - 0.5 + j+25)] = 0;
                                Clip2 = true;
                            }
                        }
                        if ( doodad(PX - 0.5 + i, PY - 0.5 + j) == 133 ) {
                            Health = Health + 1;
                        }
                    }; //Next j
                }; //Next i
            }
            if ( Health > 100 ) { Health = 100; }
            
            if ( (KeyDown[2]) ) {
                EHold = true;
            } else {
                EHold = false;
            }
            
            //if ( Label4.Caption != txt ) { Label4.Caption = txt; }
            
            //'GX = Math.cos(R1 * 4 * Math.atan(1) / 180) * Sqr(Math.abs(Xin) ^ 2 + Math.abs(Yin) ^ 2)
            //'GY = Math.sin(R1 * 4 * Math.atan(1) / 180) * Sqr(Math.abs(Xin) ^ 2 + Math.abs(Yin) ^ 2)
            
            //'r2 = RY + CalcAngle(Int(Zin), Int(GY)) + 180
            
            //'GZ = Math.cos(r2 * 4 * Math.atan(1) / 180) * Sqr(Math.abs(Zin) ^ 2 + Math.abs(GY) ^ 2)
            //'GY = Math.sin(r2 * 4 * Math.atan(1) / 180) * Sqr(Math.abs(Zin) ^ 2 + Math.abs(GY) ^ 2)
            if ( PY < 0 ) { PY = size + PY; }
            if ( PX < 1 ) { PX = 1; }
            if ( PY > size ) { PY = PY - size; }
            if ( PX > size - 1 ) { PX = size - 1; }
            
            if ( Weapon == 99 ) {
                GX = Math.cos((90 - RX) * 4 * Math.atan(1) / 180);
                GY = Math.sin((90 - RX) * 4 * Math.atan(1) / 180);
                MX = PX - GX * 3;
                MY = PY - GY * 3;
                MZ = BallZ(MX, MY) + 1 + HtInc;
                ZADD = 0.4;
            } else if ( Weapon == 98 ) {
                if ( PZ < BallZ(PX, PY) ) { PZ = BallZ(PX, PY); }
                if ( PZ > BallZ(PX, PY) + 5 ) { PZ = BallZ(PX, PY) + 5; }
                GX = Math.cos((90 - RX) * 4 * Math.atan(1) / 180);
                GY = Math.sin((90 - RX) * 4 * Math.atan(1) / 180);
                GZ = Math.cos((-90 - RY) * 4 * Math.atan(1) / 180);
                MX = PX - GX * 3;
                MY = PY - GY * 3;
                MZ = PZ - GZ * 3;
                ZADD = 0.4;
            } else {
                GX = Math.cos((90 - RX) * 4 * Math.atan(1) / 180);
                GY = Math.sin((90 - RX) * 4 * Math.atan(1) / 180);
                GZ = Math.cos((-90 - RY) * 4 * Math.atan(1) / 180);
                MX = PX - GX * 0.5;
                MY = PY - GY * 0.5;
                MZ = PZ - GZ * 0.5;
                ZADD = 0.4;
            }
        } catch (e) {}
        
        
        ScreenDraw();
        fill(RGB(150,150,255));
        text (txt, 0, 100);

        //if ( Check1.Value == 1 && Text1.Enabled == false ) { Text1.Enabled = true; }
        //if ( Check1.Value == 0 && Text1.Enabled == true ) { Text1.Enabled = false; }
        
        //if ( Check2.Value == 1 && Text3.Enabled == false ) { Text3.Enabled = true; }
        //if ( Check2.Value == 0 && Text3.Enabled == true ) { Text3.Enabled = false; }
        
        //Label2.Caption = "Lines: " + LineAt;
        //Label3.Caption = "FPS: " + AvFrame;
        //Label12.Caption = Kills + " Kills";
        
        if ( NDHealth > Health ) {
            NDHealth = Health;
            ND = 0;
        } else if (Rcoil < 1) {
            ND = ND + 1;
        } else {
            ND = 0;
        }
        if ( Health == 100 ) { NDHealth = 100; }
        if ( ND > 50 && Health < 100 ) {
            Health = Health + 1;
        }
        
        //'Health = 100
        
        //if ( Picture21.Visible == false ) { CheckAch(); }
        //if ( Check9.Value == 1 ) { Health = 100; }
        
        if ( Health <= 0 ) { // && PlayerX > 0
            Health = 100;
            Weapon = 0;
            Ammo = 18;
            Deaths = Deaths + 1;
            do {
                MX = Rnd() * size;
                MY = Rnd() * size;
                LMX = MX;
                LMY = MY;
                RX = 180;
                MZ = 5.5;
                RY = 26;
                PX = MX;
                PY = MY;
                PZ = MZ;
            } while (doodad(MX - 0.5, MY - 0.5) != 0 || Elev(MX, MY) != 0 || MX < 1 || MY < 1 || MX > size - 1 || MY > size - 1);
            Red = 100;
            Kills = 0; //Reset kills
        }
        
        //if ( Health <= 0 || KeyDown(vbKeyEscape) ) {
            //'if ( Health <= 0 ) { Command7.Enabled = false
            //Me.MousePointer = 0;
            //if ( GameType == -5 ) {
            //Label13[2].Caption = Kills
            //} else {
            //Label13[2].Caption = Kills
            //}
            //Picture6.Visible = true
            //Label13[0].Caption = Kills
            //if ( Record > 0 ) { Label13[1].Caption = Int(Hits / Record * 1000) / 10 + "%"
            //Label13[3].Caption = Format(Now - Start, "hh:MM:ss")
            //Timer2.Enabled = true
            
            //if ( PlayerX > 0 ) {
            //    Label13[8].Caption = Deaths
            //    if ( JTime < 80 ) {
            //        Text4.Enabled = false
            //    } else {
            //        Text4.Enabled = true
            //    }
            //} else {
            //    if ( Health <= 0 ) {
            //        Label13[8].Caption = 1
            //    } else {
            //        Label13[8].Caption = 0
            //    }
            //    Text4.Enabled = true
            //}
            
            //if ( PlayerX > 0 ) {
            //    List1.Clear
            //    For i = 0 To 6
            //        List1.AddItem Score[i]
            //    }; //Next i
            //    //'Text4.Enabled = false
            //} else {
            //    List1.Clear
            //    For i = 0 To 6
            //       if ( Score[i] = "" ) {
            //           if ( Ins = false ) { List1.AddItem StrNum + " - " + Text4.Text: Ins = true
            //        } else if ( StrNum > Mid(Score[i], 1, 5) ) {
            //            if ( Ins = false ) { List1.AddItem StrNum + " - " + Text4.Text: Ins = true
            //        }
            //        if ( i != 6 || Ins = false ) { List1.AddItem Score[i]
            //    }; //Next i
            //    For i = 0 To 6
            //        SaveSetting "Jonesy", "PP", "Score" + i, List1.List[i]
            //    }; //Next i
            //}
        //}
        
        if ( Red > 1 ) {
            var colcol = RGB(Red * 2, 0, 0);
            colcol.a = 1*(Red/100)
            rect(0,0,width,height,colcol)
            
            Red = Red - Red / (3 * AvFrame);
            for (i = 0; i <= 100; i++) {
                WKills[i] = 0;
            }; //Next i
        } else {
            Red = 0;
        }
        
        if ( Tink == true ) {
            if ( RKDown > 0 ) {
                RKDown = RKDown - 1;
            } else {
                RKills = 0;
            }
        }
        
        if ( PZ < wl + 0.3 && GameType == 1 ) {
            Health = Health - 0.1;
            ND = 0;
        }
        if ( PZ < wl - 0.3 && Tink == true && Cond != 2 ) {
            Health = Health - 0.1;
            ND = 0;
        }
        if ( PZ < wl + 0.2 && Tink == true && Cond == 3 ) {
            Health = Health - 0.3;
            ND = 0;
        }
        //text (ND, 0, 120);
    } else {
    //} else if ( Picture5.Visible == true || Picture11.Visible == true ) {
        Frame = Frame + 1;
        //if ( Format(Now, "ss") != Sec ) {
        //    Sec = Format(Now, "ss")
        //    AvFrame = Frame
        //    Frame = 0
        //} else if ( Frame > AvFrame ) {
        //    AvFrame = Frame
        //}
        
        RainQt = 100;
        Ovr = RainQt;
        for (k = 0; k < NxtDad + RainQt; k++) {
            if ( lava[k].Type == 0 || k > NxtDad ) {
                if ( Ovr > 0 ) {
                    Ovr = Ovr - 1;
                    lava[k].x = MX - 10 + Rnd() * 20;
                    lava[k].y = MY - 10 + Rnd() * 20;
                    lava[k].Color = RGB(0, 0, 200 + Rnd() * 55);
                    if ( Cond == 3 ) { lava[k].Color = RGB(200 + Rnd() * 55, 0, 0); }
                    if ( doodad(lava[k].x, lava[k].y) != 180 ) { lava[k].Type = 1; }
                    lava[k].speed = 0.05 + Rnd() * 0.3;
                    lava[k].Grav = true;
                    lava[k].Height = 10;
                    if ( k > NxtDad ) { NxtDad = k; }
                } else {
                    lava[k] = lava[k + 1];
                    lava[k + 1].Type = 0;
                }
            }
        }; //Next k
        
        //MX = 72;
        //MY = 195;
        if ( Weapon != 98 ) { MZ = BallZ(MX, MY) + 1; }
        //RX = 0;
        //RY = 0;
            
        //Label3.Caption = "FPS: " + AvFrame
        
        if ( LoadScreen == false ) {
            GX = Colup;
            Colup = 3;
            ScreenDraw();
            Colup = GX;
            //Picture5.PaintPicture Me.Image, -Picture5.Left, -Picture5.Top
            LoadScreen = true;
        }
        
        ScreenDraw();
        
         if ( LstCnfrm < vnum ) {
            //Picture11.Visible = true;
            //Picture5.Visible = false;
            //if ( Check5.Value == 1 ) {
            //    Command10.Enabled = true;
            //} else {
            //    Command10.Enabled = false;
            //}
            //Picture7.Visible = false;
            //Command9.Visible = false;
            
        } else {
            //Picture11.Visible = false;
            //Picture7.Visible = true;
            //Command9.Visible = true;
            
            //for (i = 0; i <= 6; i++) {
                //rct.Left = Label19[i].Left / 15;
                //rct.Right = (Label19[i].Width + Label19[i].Left) / 15;
                //rct.Top = Label19[i].Top / 15;
                //rct.Bottom = (Label19[i].Height + Label19[i].Top) / 15;
                //Me.Font.size = Label19[i].Font.size;
                //Me.ForeColor = Label19[i].ForeColor;
                //DrawText Me.hDC, Label19[i].Caption, -1, rct, &H10
                //text
            //}; //Next i
        }
        
        //if ( KeyDown(vbKeyEscape) ) { End
    }

    Target = Target + 2;
    if ( Target > 360 ) { Target = 0; }

    if ( Achieved[0] == 0 && PlayerX == 0 && GameType == 0 && (HScroll4Value != 4 || dist(125, MX,125, MY) < 20) ) {
        
        var d3d = To3D((125 - MX) * 100, (125 - MY) * 100, (-3 - MZ) * 100);
        if ( d3d.y != 0 ) { Hvr(d3d.x, d3d.y); }
    }
}

function Map() {
    for (var i = 0; i <= 549; i++) {
        for (var j = 0; j <= 549; j++) {
            rect(i,j,1,1,RGB(0,-_block[i][j],0));
            if (_Elev[i][j] != 0) {
                rect(i,j,1,1,RGB(0,0,_Elev[i][j]*10));
            }
        }
    }
    rect(PX+25-2,PY+25-2,4,4,RGB(255,0,0));
    
    rect(RX+175-2,RY+175-2,4,4,RGB(0,255,0));
    //rect(25,25,525,525,RGB(255,255,255),false);
    
}

function ScreenDraw() {
    //On Error Resume }; //Next
    var i = 0; //xAs Long
    var j = 0; //xAs Long
    var k = 0; //xAs Double
    var l = 0; //xAs Long
    var sz = 0; //xAs Long
    var Ln = 0; //xAs Long
    var V = new Array(4);//(0 To 4); //As POINTAPI
    for (i = 0; i < 4; i++) {
        V[i] = {"x":0, "y":0};
    }
    
    

    var Dist = 0; //xAs Double
    var Lst = 0; //xAs Double
    var insidex = false; //xAs Boolean

    var GX = 0; //xAs Double
    var GY = 0; //xAs Double
    var GZ = 0; //xAs Double //'
    var hh = 0; //xAs Double
    var dsz = 0; //xAs Double
    var lp = 0; //xAs Long
    var lsttype = 0; //xAs Long

    var TFX = 0; //xAs Double
    var TFY = 0; //xAs Double
    var TFZ = 0; //xAs Double

    var Yay = 0; //xAs Double

    var plp = 0; //xAs Long

    myGameArea.clear();
	textSize(15);
	fill(RGB(255,255,255));

    //Me.Cls

    LineAt = 0;
    /*
    GX = Math.cos((90 - RX) * 4 * Math.atan(1) / 180);
    GY = Math.sin((90 - RX) * 4 * Math.atan(1) / 180);
    
    GZ = To3D((GX), (GY), BallZ(Int(PX + GX),Int(PY + GY))).y;
    GZ = GZ;
    //Me.FillStyle = 6;
    //Me.FillColor = RGB(0, 0, 255)
    var colXXX = RGB(0,255,0);
    if ( Cond == 3 ) { colXXX = RGB(255,100,100); }
    fill(colXXX);
    if (GZ < 0) {
        GZ = 0;
    }
    rect(0,GZ,width,height, colXXX);
    */

    GX = Math.cos((90 - RX) * 4 * Math.atan(1) / 180);
    GY = Math.sin((90 - RX) * 4 * Math.atan(1) / 180);

    GZ = To3D((GX) * 100, (GY) * 100, 0).y;
    GZ = Int(GZ / 15) * 15;
    //'if ( GZ != 0 ) {
    //Me.Line (0, GZ)-(width, height), 0, BF
    //line(0,GZ,width,height, RGB(0,0,0));
    fill(RGB(0,10,10));
    rect(0,0,width,GZ, RGB(0,10,10));
    
    //hh = Image1.Height / Image1.Width * width * 4 //' * Colup
    if ( Zoom == 1 ) {
        //picture(0,0,width,height,"Ship.png",0);
        //Me.PaintPicture Image1.Picture, (RX - 270) / 360 * width * 4, GZ - hh, width * 4, hh
        //'Me.PaintPicture Image1.Picture, 0, 0, width * 4, hh, -(RX - 270) / 360 * width, -(GZ - hh) / , width, height
        //if ( (RX - 270) > 0 ) {
        //    Me.PaintPicture Image1.Picture, (RX - 360 - 270) / 360 * width * 4, GZ - hh, width * 4, hh
        //}
    }
    //'}

    fill(RGB(255,255,255));
    //Map();
    Surface();
    //'FromGrid
            
    i = LineAt;
    //'For i = 0 To LineAt - 1
    while (i > 0) {
        i = i - 1;
        try {
            var ddddraw = true;
            //Me.DrawWidth = 1;
            strokewidth(1);
            if ( PolyX[i].Type == 77 ) {
                var d3d = To3D((PolyX[i].x[0] - MX) * 100, (PolyX[i].y[0] - MY) * 100, (PolyX[i].z[0] - MZ) * 100);
                if ( d3d.x == 0 && d3d.y == 0 ) {
                } else {
                    //Me.FillStyle = 0;
                    //Me.FillColor = PolyX[i].Colour;
                    //Me.ForeColor = PolyX[i].Colour;
                    strokewidth(1);
                    fill(PolyX[i].Colour);
                    //if ( Check7.Value == 0 ) {
                    var ssizex = d3d.size * PolyX[i].size*2;
                    ellipse(d3d.x - ssizex, d3d.y - ssizex, ssizex, PolyX[i].Colour); //  //'
                    //} else {
                    //drawface(d3d.x, d3d.y, d3d.size * PolyX[i].size);
                    //}
                    //Me.FillStyle = 1;
                }
            } else if ( PolyX[i].Type == 3 ) {
                var d3d = To3D((PolyX[i].x[0] - MX) * 100, (PolyX[i].y[0] - MY) * 100, (PolyX[i].z[0] - MZ) * 100);
                if ( d3d.x == 0 && d3d.y == 0 ) {
                } else {
                    //Me.FillStyle = 0;
                    //Me.FillColor = PolyX[i].Colour;
                    //Me.ForeColor = PolyX[i].Colour;
                    var ssizex = d3d.size * PolyX[i].size*1.5;
                    strokewidth(1);
                    fill(PolyX[i].Colour);
                    ellipse(d3d.x - ssizex, d3d.y - ssizex, ssizex, PolyX[i].Colour); //'
                    //Me.FillStyle = 1;
                }
            } else if ( PolyX[i].Type == 1 ) {
                sz = 0;
                for (j = 0; j <= 1; j++) {
                    var d3d = To3D((PolyX[i].x[j] - MX) * 100, (PolyX[i].y[j] - MY) * 100, (PolyX[i].z[j] - MZ) * 100);
                    V[j].x = d3d.x; //' / 15 //' * 3
                    V[j].y = d3d.y; //' / 15 //' * 3
                    if ( d3d.size > 0 ) { sz = d3d.size; }
                    if ( V[j].x == 0 && V[j].y == 0 ) { ddddraw = false; }
                }; //Next j
                if (ddddraw) {
                    //Me.FillStyle = 1;
                    //Me.DrawWidth = sz * PolyX[i].size; //' / 100
                    //Me.ForeColor = PolyX[i].Colour;
                    fill(PolyX[i].Colour);
                    line(V[0].x, V[0].y,V[1].x, V[1].y, PolyX[i].Colour);
                    //Me.DrawWidth = 1;
                }
            } else if ( PolyX[i].Type == 2 ) {
                for (j = 0; j <=3; j++) {
                    var d3d = To3D((PolyX[i].x[j] - MX) * 100, (PolyX[i].y[j] - MY) * 100, (PolyX[i].z[j] - MZ) * 100);
                    V[j].x = d3d.x; /// 15 //' * 3
                    V[j].y = d3d.y; /// 15 //' * 3
                    if ( V[j].x == 0 && V[j].y == 0 ) { ddddraw = false; }
                }; //Next j
                if (ddddraw) {
                    //Me.FillStyle = 0;
                    //Me.FillColor = PolyX[i].Colour;
                    //Me.ForeColor = PolyX[i].Colour; //'RGB(255, 255, 255) //'
                    //Polygon Me.hDC, V[0], 4
                    //Me.FillStyle = 1
                    fill(PolyX[i].Colour);
                    quad(V[0].x,V[0].y,V[1].x,V[1].y,V[2].x,V[2].y,V[3].x,V[3].y);
                }
            } else if ( PolyX[i].Type == 4 ) {
                for (j = 0; j <=3; j++) {
                    var d3d = To3D((PolyX[i].x[j] - MX) * 100, (PolyX[i].y[j] - MY) * 100, (PolyX[i].z[j] - MZ) * 100);
                    V[j].x = d3d.x /// 15 //' * 3
                    V[j].y = d3d.y /// 15 //' * 3
                    if ( V[j].x == 0 && V[j].y == 0 ) { ddddraw = false; }
                }; //Next j
                if (ddddraw) {
                    //Me.FillStyle = 7
                    //Me.FillColor = PolyX[i].Colour
                    //Me.ForeColor = PolyX[i].Colour //'RGB(255, 255, 255) //'
                    //Polygon Me.hDC, V[0], 4
                    //Me.FillStyle = 1
                    PolyX[i].Colour = RGB(255,0,200);
                    PolyX[i].Colour.a = 0.5;
                    fill(PolyX[i].Colour);
                    quad(V[0].x,V[0].y,V[1].x,V[1].y,V[2].x,V[2].y,V[3].x,V[3].y);
                }
            } else if ( PolyX[i].Type == 5 ) { //'width-adjustable line
                for (j = 0; j <=1; j++) {
                    var d3d = To3D((PolyX[i].x[j] - MX) * 100, (PolyX[i].y[j] - MY) * 100, (PolyX[i].z[j] - MZ) * 100);
                    V[j].x = d3d.x //' / 15
                    V[j].y = d3d.y //' / 15
                    //Me.DrawWidth = PolyX[i].size * .size / 100
                    //ctx.strokewidth = x
                    strokewidth(PolyX[i].size * d3d.size / 5); //  / 100
                    //strokewidth(10); // / 100
                    if ( V[j].x == 0 && V[j].y == 0 ) { ddddraw = false; }
                }; //Next j
                if (ddddraw) {
                    line(V[0].x, V[0].y,V[1].x, V[1].y, PolyX[i].Colour);
                }
                //Me.DrawWidth = 1;
                strokewidth(1);
            } else if ( PolyX[i].Type > 20 && PolyX[i].Type < 25 ) {
                var d3d =  To3D((PolyX[i].x[0] - MX) * 100, (PolyX[i].y[0] - MY) * 100, (PolyX[i].z[0] - MZ) * 100);
                if ( d3d.x == 0 && d3d.y == 0 ) {
                } else {
                    //Me.FillStyle = 0;
                    //Me.FillColor = PolyX[i].Colour;
                    //Me.ForeColor = PolyX[i].Colour;
                    var ssizex = d3d.size * PolyX[i].size;
                    fill(PolyX[i].Colour);
                    ellipse(d3d.x - ssizex/2, d3d.y - ssizex/2, ssizex, PolyX[i].Colour); //'
                    //Me.FillStyle = 1;
                }
            }
    
        } catch (e) {
        }
    //ovrs:
    }

    //Me.DrawWidth = 2
    //ctx.strokewidth = x
    strokewidth(2);
    for (i = 0; i <= 400; i++) {
        if ( Bullet[i].Type > 0 ) {
            try {
                if ( Bullet[i].y[0] < 1 ) { Bullet[i].y[0] = Bullet[i].y[0] + size; }
                if ( Bullet[i].y[0] > size - 1 ) { Bullet[i].y[0] = Bullet[i].y[0] - size; }
                
                if ( Bullet[i].x[0] < 1 || Bullet[i].x[0] > size - 1 || Bullet[i].z[0] > 5 ) { Bullet[i].Type = 0; }
                
                if ( doodad(Bullet[i].x[0] - 0.5, Bullet[i].y[0] - 0.5) == 180 || doodad(Bullet[i].x[0] - 0.5, Bullet[i].y[0] - 0.5) == 210 ) {
                    insidex = true;
                } else {
                    insidex = false;
                }
                
                if ( TFreeze > 0 ) {
                    TFX = Bullet[i].x[0];
                    TFY = Bullet[i].y[0];
                    TFZ = Bullet[i].z[0];
                }
                
                lsttype = Bullet[i].Type;
                
                var xd3d = To3D((Bullet[i].x[0] - MX) * 100, (Bullet[i].y[0] - MY) * 100, (Bullet[i].z[0] - MZ) * 100);
                V[0].x = xd3d.x;
                V[0].y = xd3d.y;
                dsz = xd3d.size;
                
                if ( (doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) >= 500 || doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) == 210) && Bullet[i].z[0] < BallZ(Bullet[i].x[0], Bullet[i].y[0]) + 1 ) {
                    if ( doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) == 210 && Bullet[i].Type < 33 ) { _doodad[Int(Bullet[i].x[0] - 0.5)+25][Int(Bullet[i].y[0] - 0.5)+25] = 0;}
                    
                    if (Bullet[i].Type == 1 || Bullet[i].Type == 5) {
                        _doodad[Int(Bullet[i].x[0] - 0.5)+25][Int(Bullet[i].y[0] - 0.5)+25] = doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) - 1;
                    } else if (Bullet[i].Type == 2) { //'rlaunch
                        _doodad[Int(Bullet[i].x[0] - 0.5)+25][Int(Bullet[i].y[0] - 0.5)+25] = 0;
                    } else if (Bullet[i].Type == 3) { //'snip
                        _doodad[Int(Bullet[i].x[0] - 0.5)+25][Int(Bullet[i].y[0] - 0.5)+25] = 0;
                    } else if (Bullet[i].Type == 4) { //'glaunch
                        _doodad[Int(Bullet[i].x[0] - 0.5)+25][Int(Bullet[i].y[0] - 0.5)+25] = doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) - 3;
                    } else if (Bullet[i].Type == 6) { //'scarh
                        _doodad[Int(Bullet[i].x[0] - 0.5)+25][Int(Bullet[i].y[0] - 0.5)+25] = doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) - 2;
                    }
                    
                    if ( Bullet[i].Type < 33 ) { Hits = Hits + 1; }
                    if ( doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) < 500 && doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) != 210 ) {
                        
                        
                        _doodad[Int(Bullet[i].x[0] - 0.5)+25][Int(Bullet[i].y[0] - 0.5)+25] = 0;
                        //if ( Push((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) != 1 ) { newPush (Bullet[i].x[0] - 0.5, Bullet[i].y[0] - 0.5); }
                        KillInc();
                        if ( Bullet[i].Type < 33 ) { Bullet[i].Type = 0; }
                        lava[NxtDad].x = Int(Bullet[i].x[0] - 0.5) + 0.5;
                        lava[NxtDad].y = Int(Bullet[i].y[0] - 0.5) + 0.5;
                        lava[NxtDad].Color = RGB(255, 155, 155);
                        lava[NxtDad].Type = 77;
                        lava[NxtDad].speed = 0.04;
                        lava[NxtDad].Grav = true;
                        lava[NxtDad].Height = 0.5;
                        
                        lava[NxtDad + 1].x = Int(Bullet[i].x[0] - 0.5) + 0.5;
                        lava[NxtDad + 1].y = Int(Bullet[i].y[0] - 0.5) + 0.5;
                        lava[NxtDad + 1].Color = RGB(200, 0, 0);
                        lava[NxtDad + 1].Type = 1;
                        lava[NxtDad + 1].speed = 0.02 + Rnd() * 0.02;
                        lava[NxtDad + 1].Grav = true;
                        lava[NxtDad + 1].Height = 0.2;
                        
                        lava[NxtDad + 2].x = Int(Bullet[i].x[0] - 0.5) + 0.5;
                        lava[NxtDad + 2].y = Int(Bullet[i].y[0] - 0.5) + 0.5;
                        lava[NxtDad + 2].Color = RGB(200, 0, 0);
                        lava[NxtDad + 2].Type = 1;
                        lava[NxtDad + 2].speed = 0.02 + Rnd() * 0.02;
                        lava[NxtDad + 2].Grav = true;
                        lava[NxtDad + 2].Height = 0.2;
                        
                        NxtDad = NxtDad + 3;
                        
                    }
                }
                
                
                //'if ( insidex = false ) {
                if ( Elev(Bullet[i].x[0], Bullet[i].y[0]) > 0 && Bullet[i].z[0] < BallZ(Bullet[i].x[0], Bullet[i].y[0]) + 1.5 ) {
                    //'if ( -0.1 < Bullet[i].y[1] < 0.1 && (Elev(Bullet[i].x[0] - 1, Bullet[i].y[0]) = 0 && Elev(Bullet[i].x[0] + 1, Bullet[i].y[0]) = 0) ) { GoTo ttrus
                    //'if ( -0.1 < Bullet[i].x[1] < 0.1 && (Elev(Bullet[i].x[0], Bullet[i].y[0] - 1) = 0 && Elev(Bullet[i].x[0], Bullet[i].y[0] + 1) = 0) ) { GoTo ttrus
                    if ( Elev(Bullet[i].x[0] - 0.5, Bullet[i].y[0] - 0.5) == 99 ) {
                    } else {
                        if ( Bullet[i].Type == 2 || Bullet[i].Type == 4 || Bullet[i].Type == 34 || Bullet[i].Type == 36 ) {
                            _Elev[Int(Bullet[i].x[0])+25][Int(Bullet[i].y[0])+25] = 0;
                            if ( Achieved[60] == 0 ) {
                                Achieved[60] = 1;
                                //SaveSetting "Jonesy", "PP", "Ach60", 1
                                //Picture7.Visible = true
                                //Picture7.Tag = 80
                                //Label15.Caption = "Achievement Unlocked"
                                msgbox("//'Rage//': Destroy one wall piece in a single game")
                            }
                        }
                        Bullet[i].Type = 0;
                    }
                }
                //'}

                if ( doodad(Bullet[i].x[0], Bullet[i].y[0]) == 1 && Bullet[i].z[0] < BallZ(Bullet[i].x[0], Bullet[i].y[0]) + 0.5 ) { Bullet[i].Type = 0; }
                if ( doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) >= 5 && doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) < 8 && Bullet[i].z[0] < BallZ(Bullet[i].x[0], Bullet[i].y[0]) + 3 ) {
                    if ( Bullet[i].Type == 2 || Bullet[i].Type == 4 || Bullet[i].Type == 34 || Bullet[i].Type == 36 ) {
                        if ( Cond != 2 && Check8Value == 0 ) {
                            if ( doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) == 6 ) {
                                lava[NxtDad + 1].x = Int(Bullet[i].x[0] - 0.5) + 0.5;
                                lava[NxtDad + 1].y = Int(Bullet[i].y[0] - 0.5) + 0.5;
                                lava[NxtDad + 1].Color = RGB(0, 200, 0);
                                lava[NxtDad + 1].Type = 88;
                                lava[NxtDad + 1].speed = 0.04;
                                lava[NxtDad + 1].Grav = true;
                                lava[NxtDad + 1].Height = 1;
                                NxtDad = NxtDad + 2;
                                TreeDown = TreeDown + 1;
                            } else if ( doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) == 5 ) {
                                lava[NxtDad].x = Int(Bullet[i].x[0] - 0.5) + 0.5;
                                lava[NxtDad].y = Int(Bullet[i].y[0] - 0.5) + 0.5;
                                lava[NxtDad].Color = RGB(0, 200, 0);
                                lava[NxtDad].Type = 88;
                                lava[NxtDad].speed = 0.04;
                                lava[NxtDad].Grav = true;
                                lava[NxtDad].Height = 2;
                                
                                lava[NxtDad + 1].x = Int(Bullet[i].x[0] - 0.5) + 0.5;
                                lava[NxtDad + 1].y = Int(Bullet[i].y[0] - 0.5) + 1.2;
                                lava[NxtDad + 1].Color = RGB(0, 200, 0);
                                lava[NxtDad + 1].Type = 88;
                                lava[NxtDad + 1].speed = 0.04;
                                lava[NxtDad + 1].Grav = true;
                                lava[NxtDad + 1].Height = 1.5;
                                NxtDad = NxtDad + 2;
                                TreeDown = TreeDown + 1;
                            }
                        }
                        _doodad[Int(Bullet[i].x[0] - 0.5)+25][Int(Bullet[i].y[0] - 0.5)+25] = 0;
                    }
                    Bullet[i].Type = 0;
                }
                if ( Bullet[i].z[0] < BallZ(Bullet[i].x[0], Bullet[i].y[0]) ) { Bullet[i].Type = 0; }
                
                if ( Bullet[i].Type < 33 ) {
                    for (plp = 0; plp <= PMax; plp++) {
                         if ( (plp != (PlayerX - 1) || GameType == -5) && Int(Bullet[i].x[0]) == Int(Plr[plp].x) && Int(Bullet[i].y[0]) == Int(Plr[plp].y) && Bullet[i].z[0] < BallZ(Plr[plp].x, Plr[plp].y) + 1 ) {
                            if ( GameType == -5 && Plr[plp].Kills > 0 ) {
                                if (Bullet[i].Type == 1 || Bullet[i].Type == 5) {
                                    Plr[plp].Kills = Plr[plp].Kills - 35
                                } else if (Bullet[i].Type == 2) {
                                    Plr[plp].Kills = 0
                                } else if (Bullet[i].Type == 3) {
                                    Plr[plp].Kills = 0
                                } else if (Bullet[i].Type == 4) {
                                    Plr[plp].Kills = Plr[plp].Kills - 50
                                } else if (Bullet[i].Type == 6) {
                                    Plr[plp].Kills = Plr[plp].Kills - 50
                                }
                                if ( Plr[plp].Kills <= 0 ) { KillInc(); }
                            }
                            Bullet[i].Type = 0;
                            LstHit = plp;
                            HitFor = 0;
                            Hits = Hits + 1;
                        }
                    }; //Next plp
                }
                if ( Bullet[i].Type == 33 || Bullet[i].Type == 37 ) {
                    Bullet[i].x[0] = Bullet[i].x[0] + Bullet[i].x[1] / AvFrame * 5;
                    Bullet[i].y[0] = Bullet[i].y[0] + Bullet[i].y[1] / AvFrame * 5;
                    Bullet[i].z[0] = Bullet[i].z[0] + Bullet[i].z[1] / AvFrame * 5;
                    var d3d = To3D((Bullet[i].x[0] - MX) * 100, (Bullet[i].y[0] - MY) * 100, (Bullet[i].z[0] - MZ) * 100)
                    //'V[0].x = .x / 15
                    //'V[0].y = .y / 15
                    if ( (d3d.x == 0 && d3d.y == 0) || (V[0].x == 0 && V[0].y == 0) ) {
                    } else {
                        line(V[0].x, V[0].y,d3d.x, d3d.y, RGB(255, 255, 255));
                    }
                    if ( Bullet[i].x[0] > PX - 1 && Bullet[i].x[0] < PX + 1 && Bullet[i].y[0] > PY - 1 && Bullet[i].y[0] < PY + 1 && Bullet[i].z[0] > PZ - 0.5 && Bullet[i].z[0] < PZ + 0.5 ) {
                        Health = Health - 20;
                        if ( Bullet[i].Type == 37 ) { Health = Health - 20; }
                        fromr[nxtfrom] = CalcAngle(Bullet[i].x[1], Bullet[i].y[1]);
                        if ( Weapon < 90 ) { fromt[nxtfrom] = 250; }
                        nxtfrom = nxtfrom + 1;
                        if ( nxtfrom > 5 ) { nxtfrom = 0; }
                        Bullet[i].Type = 0;
                    }
                    if ( PlayerX > 0 && Bullet[i].x[0] > LPX - 1 && Bullet[i].x[0] < LPX + 1 && Bullet[i].y[0] > LPY - 1 && Bullet[i].y[0] < LPY + 1 && Bullet[i].z[0] > LPZ - 0.5 && Bullet[i].z[0] < LPZ + 0.5 ) {
                        Health = Health - 20;
                        if ( Bullet[i].Type == 37 ) { Health = Health - 20; }
                        fromr[nxtfrom] = CalcAngle(Bullet[i].x[1], Bullet[i].y[1]);
                        if ( Weapon < 90 ) { fromt[nxtfrom] = 250; }
                        nxtfrom = nxtfrom + 1;
                        if ( nxtfrom > 5 ) { nxtfrom = 0; }
                        Bullet[i].Type = 0;
                    }
                    
                    if ( Achieved[59] == 0 && Int(Bullet[i].x[0]) == Int(PX) && Int(Bullet[i].y[0]) == Int(PY) && Bullet[i].z[0] < PZ - 0.5 && Weapon < 90 ) {
                        Achieved[59] = 1;
                        //SaveSetting "Jonesy", "PP", "Ach59", 1
                        //Picture7.Visible = true;
                        //Picture7.Tag = 80;
                        //Label15.Caption = "Achievement Unlocked"
                        msgbox("//'Skill//': Jump over an approaching bullet")
                    }
                } else if ( Bullet[i].Type == 34 ) {
                    Bullet[i].x[0] = Bullet[i].x[0] + Bullet[i].x[1] / AvFrame * 5;
                    Bullet[i].y[0] = Bullet[i].y[0] + Bullet[i].y[1] / AvFrame * 5;
                    Bullet[i].z[0] = Bullet[i].z[0] + Bullet[i].z[1] / AvFrame * 5;
                    //fill(RGB(255, 0, 0));
                    //Me.FillStyle = 0;
                    //Me.FillColor = ;
                    fill(RGB(255, 0, 0));
                    ellipse(V[0].x, V[0].y, dsz * 2, RGB(255, 0, 0));
                    //Me.FillStyle = 1;
                    if ( Bullet[i].x[0] > PX - 1 && Bullet[i].x[0] < PX + 1 && Bullet[i].y[0] > PY - 1 && Bullet[i].y[0] < PY + 1 && Bullet[i].z[0] > PZ - 0.5 && Bullet[i].z[0] < PZ + 0.5 ) {
                        
                        if ( Achieved[67] == 0 && Health == 100 ) {
                            Achieved[67] = 1;
                            //SaveSetting "Jonesy", "PP", "Ach67", 1
                            //Picture7.Visible = true
                            //Picture7.Tag = 80
                            //Label15.Caption = "Achievement Unlocked"
                            msgbox("//'Unlucky//': From full health, die of a lethal shot")
                        }
                        
                        Health = 0;
                        fromr[nxtfrom] = CalcAngle(Bullet[i].x[1], Bullet[i].y[1]);
                        if ( Weapon < 90 ) { fromt[nxtfrom] = 250; }
                        nxtfrom = nxtfrom + 1;
                        if ( nxtfrom > 5 ) { nxtfrom = 0; }
                        Bullet[i].Type = 0;
                    }
                    if ( PlayerX > 0 && Bullet[i].x[0] > LPX - 1 && Bullet[i].x[0] < LPX + 1 && Bullet[i].y[0] > LPY - 1 && Bullet[i].y[0] < LPY + 1 && Bullet[i].z[0] > LPZ - 0.5 && Bullet[i].z[0] < LPZ + 0.5 ) {
                        Health = 0;
                        fromr[nxtfrom] = CalcAngle(Bullet[i].x[1], Bullet[i].y[1]);
                        if ( Weapon < 90 ) { fromt[nxtfrom] = 250; }
                        nxtfrom = nxtfrom + 1;
                        if ( nxtfrom > 5 ) { nxtfrom = 0; }
                        Bullet[i].Type = 0;
                    }
                    
                    //if ( Bullet[i].Type = 0 ) { PlaySound App.Path + "\explosion.wav", 0, 1
                } else if ( Bullet[i].Type == 35 ) {
                    for (lp = 0; lp <= 4; lp++) {
                        if ( Bullet[i].Type != 0 ) {
                            //'Me.Circle (V[0].x, V[0].y), 500, RGB(255, 0, 0)
                            Bullet[i].x[0] = Bullet[i].x[0] + Bullet[i].x[1] / AvFrame * 5;
                            Bullet[i].y[0] = Bullet[i].y[0] + Bullet[i].y[1] / AvFrame * 5;
                            Bullet[i].z[0] = Bullet[i].z[0] + Bullet[i].z[1] / AvFrame * 5;
                            
                            if ( Bullet[i].x[0] < 0 || Bullet[i].x[0] > size ) { Bullet[i].Type = 0; }
                            if ( Bullet[i].y[0] < 0 || Bullet[i].y[0] > size ) { Bullet[i].Type = 0; }
                            
                            if ( insidex == false && Elev(Bullet[i].x[0], Bullet[i].y[0]) > 0 && Bullet[i].z[0] < BallZ(Bullet[i].x[0], Bullet[i].y[0]) + 1.5 ) { Bullet[i].Type = 0; }
                            if ( doodad(Bullet[i].x[0], Bullet[i].y[0]) = 1 && Bullet[i].z[0] < BallZ(Bullet[i].x[0], Bullet[i].y[0]) + 0.5 ) { Bullet[i].Type = 0; }
                            if ( doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) >= 5 && doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) < 8 && Bullet[i].z[0] < BallZ(Bullet[i].x[0], Bullet[i].y[0]) + 3 ) { Bullet[i].Type = 0; }
                            if ( Bullet[i].z[0] < BallZ(Bullet[i].x[0], Bullet[i].y[0]) ) { Bullet[i].Type = 0; }
                            
                            if ( Bullet[i].x[0] > PX - 1 && Bullet[i].x[0] < PX + 1 && Bullet[i].y[0] > PY - 1 && Bullet[i].y[0] < PY + 1 && Bullet[i].z[0] > PZ - 0.5 && Bullet[i].z[0] < PZ + 0.5 ) {
                                
                                if ( Achieved[67] == 0 && Health == 100 ) {
                                    Achieved[67] = 1;
                                    //SaveSetting "Jonesy", "PP", "Ach67", 1
                                    //Picture7.Visible = true
                                    //Picture7.Tag = 80
                                    //Label15.Caption = "Achievement Unlocked"
                                    msgbox("//'Unlucky//': From full health, die of a lethal shot")
                                }
                                
                                Health = 0;
                                fromr[nxtfrom] = CalcAngle(Bullet[i].x[1], Bullet[i].y[1]);
                                if ( Weapon < 90 ) { fromt[nxtfrom] = 250; }
                                nxtfrom = nxtfrom + 1;
                                if ( nxtfrom > 5 ) { nxtfrom = 0; }
                                Bullet[i].Type = 0;
                            }
                            if ( PlayerX > 0 && Bullet[i].x[0] > LPX - 1 && Bullet[i].x[0] < LPX + 1 && Bullet[i].y[0] > LPY - 1 && Bullet[i].y[0] < LPY + 1 && Bullet[i].z[0] > LPZ - 0.5 && Bullet[i].z[0] < LPZ + 0.5 ) {
                                Health = 0;
                                fromr[nxtfrom] = CalcAngle(Bullet[i].x[1], Bullet[i].y[1]);
                                if ( Weapon < 90 ) { fromt[nxtfrom] = 250; }
                                nxtfrom = nxtfrom + 1;
                                if ( nxtfrom > 5 ) { nxtfrom = 0; }
                                Bullet[i].Type = 0;
                            }
                            
                            if ( Bullet[i].Type == 0 ) {
                                var d3d =  To3D((Bullet[i].x[0] - MX) * 100, (Bullet[i].y[0] - MY) * 100, (Bullet[i].z[0] - MZ) * 100);
                                    //'V[0].x = .x / 15
                                    //'V[0].y = .y / 15
                                if ( (d3d.x == 0 && d3d.y == 0) ) {
                                } else {
                                    picture("explode.png", d3d.x - d3d.size, d3d.y - d3d.size, d3d.size * 2, d3d.size * 2, 0);
                                }
                            }
                        }
                    }; //Next lp
                } else if ( Bullet[i].Type == 36 ) {
                    //Me.FillStyle = 0;
                    //Me.FillColor = RGB(155, 155, 155);
                    fill(RGB(155, 155, 155));
                    ellipse(V[0].x, V[0].y, dsz * 2, RGB(155, 155, 155));
                    //Me.FillStyle = 1;
                    Bullet[i].x[0] = Bullet[i].x[0] + Bullet[i].x[1] / AvFrame * 5;
                    Bullet[i].y[0] = Bullet[i].y[0] + Bullet[i].y[1] / AvFrame * 5;
                    Bullet[i].z[0] = Bullet[i].z[0] + Bullet[i].z[1] / AvFrame * 5;
                    Bullet[i].z[1] = Bullet[i].z[1] - 0.05 / AvFrame * 5;
                    if ( Bullet[i].x[0] > PX - 1 && Bullet[i].x[0] < PX + 1 && Bullet[i].y[0] > PY - 1 && Bullet[i].y[0] < PY + 1 && Bullet[i].z[0] > PZ - 0.5 && Bullet[i].z[0] < PZ + 0.5 ) {
                        Health = Health - 50;
                        fromr[nxtfrom] = CalcAngle(Bullet[i].x[1], Bullet[i].y[1]);
                        if ( Weapon < 90 ) { fromt[nxtfrom] = 250; }
                        nxtfrom = nxtfrom + 1;
                        if ( nxtfrom > 5 ) { nxtfrom = 0; }
                        Bullet[i].Type = 0;
                    }
                    if ( PlayerX > 0 && Bullet[i].x[0] > LPX - 1 && Bullet[i].x[0] < LPX + 1 && Bullet[i].y[0] > LPY - 1 && Bullet[i].y[0] < LPY + 1 && Bullet[i].z[0] > LPZ - 0.5 && Bullet[i].z[0] < LPZ + 0.5 ) {
                        Health = 0;
                        fromr[nxtfrom] = CalcAngle(Bullet[i].x[1], Bullet[i].y[1]);
                        if ( Weapon < 90 ) { fromt[nxtfrom] = 250; }
                        nxtfrom = nxtfrom + 1;
                        if ( nxtfrom > 5 ) { nxtfrom = 0; }
                        Bullet[i].Type = 0;
                    }
                    
                    //if ( Bullet[i].Type = 0 ) { PlaySound App.Path + "\explosion.wav", 0, 1
                } else if ( Bullet[i].Type == 0 ) {
                    picture("explode.png", V[0].x - dsz, V[0].y - dsz, dsz * 2, dsz * 2, 0);
                    //if (lsttype == 2 || lsttype == 4 || lsttype == 34 || lsttype == 36) {
                    //Case 2, 4, 34, 36
                    //    if ( Bullet[i].Type = 0 ) { PlaySound App.Path + "\explosion.wav", 0, 1
                    //End Select
                } else if ( Bullet[i].Type == 2 ) {
                    //Me.FillStyle = 0;
                    //Me.FillColor = RGB(255, 0, 0);
                    fill(RGB(255, 0, 0));
                    ellipse(V[0].x, V[0].y, dsz * 2, RGB(255, 0, 0));
                    //Me.FillStyle = 1;
                    Bullet[i].x[0] = Bullet[i].x[0] + Bullet[i].x[1] / AvFrame * 5;
                    Bullet[i].y[0] = Bullet[i].y[0] + Bullet[i].y[1] / AvFrame * 5;
                    Bullet[i].z[0] = Bullet[i].z[0] + Bullet[i].z[1] / AvFrame * 5;
                } else if ( Bullet[i].Type == 3 ) {
                    for (lp = 0; lp <= 4; lp++) {
                        if ( Bullet[i].Type != 0 ) {
                            //'Me.Circle (V[0].x, V[0].y), 500, RGB(255, 0, 0)
                            Bullet[i].x[0] = Bullet[i].x[0] + Bullet[i].x[1] / AvFrame * 5;
                            Bullet[i].y[0] = Bullet[i].y[0] + Bullet[i].y[1] / AvFrame * 5;
                            Bullet[i].z[0] = Bullet[i].z[0] + Bullet[i].z[1] / AvFrame * 5;
                            
                            if ( Bullet[i].x[0] < 0 || Bullet[i].x[0] > size ) { Bullet[i].Type = 0; }
                            if ( Bullet[i].y[0] < 0 || Bullet[i].y[0] > size ) { Bullet[i].Type = 0; }
                            
                            if ( insidex == false && Elev(Bullet[i].x[0], Bullet[i].y[0]) > 0 && Bullet[i].z[0] < BallZ(Bullet[i].x[0], Bullet[i].y[0]) + 1.5 ) { Bullet[i].Type = 0; }
                            if ( doodad(Bullet[i].x[0], Bullet[i].y[0]) == 1 && Bullet[i].z[0] < BallZ(Bullet[i].x[0], Bullet[i].y[0]) + 0.5 ) { Bullet[i].Type = 0; }
                            if ( doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) >= 5 && doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) < 8 && Bullet[i].z[0] < BallZ(Bullet[i].x[0], Bullet[i].y[0]) + 3 ) { Bullet[i].Type = 0; }
                            if ( Bullet[i].z[0] < BallZ(Bullet[i].x[0], Bullet[i].y[0]) ) { Bullet[i].Type = 0; }
                            
                            for (plp = 0; plp <= PMax; plp++) {
                                 if ( plp != (PlayerX - 1) && Int(Bullet[i].x[0]) == Int(Plr[plp].x) && Int(Bullet[i].y[0]) == Int(Plr[plp].y) && Bullet[i].z[0] < BallZ(Plr[plp].x, Plr[plp].y) + 1 ) {
                                    if ( GameType = -5 && Plr[plp].Kills > 0 ) {
                                        Plr[plp].Kills = 0;
                                        KillInc();
                                    }
                                    Bullet[i].Type = 0;
                                    LstHit = plp;
                                    HitFor = 0;
                                    Hits = Hits + 1;
                                }
                            }; //Next plp
                            
                            if ( (doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) >= 500 || doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) == 210) && Bullet[i].z[0] < BallZ(Bullet[i].x[0], Bullet[i].y[0]) + 1 ) {
                                if ( doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) == 210 ) {
                                    //_Push[(Bullet[i].x[0] - 0.5)][(Bullet[i].y[0] - 0.5)] = 1;
                                } else {
                                    //newPush (Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5);
                                }
                                _doodad[Int(Bullet[i].x[0] - 0.5)+25][Int(Bullet[i].y[0] - 0.5)+25] = 0;
                                Hits = Hits + 1;
                                if ( doodad((Bullet[i].x[0] - 0.5), (Bullet[i].y[0] - 0.5)) == 0 ) {
                                    _doodad[Int(Bullet[i].x[0] - 0.5)+25][Int(Bullet[i].y[0] - 0.5)+25] = 0;
                                    KillInc();
                                    
                                    lava[NxtDad].x = Int(Bullet[i].x[0] - 0.5) + 0.5;
                                    lava[NxtDad].y = Int(Bullet[i].y[0] - 0.5) + 0.5;
                                    lava[NxtDad].Color = RGB(255, 155, 155);
                                    lava[NxtDad].Type = 77;
                                    lava[NxtDad].speed = 0.04;
                                    lava[NxtDad].Grav = true;
                                    lava[NxtDad].Height = 0.5;
                                    
                                    lava[NxtDad + 1].x = Int(Bullet[i].x[0] - 0.5) + 0.5;
                                    lava[NxtDad + 1].y = Int(Bullet[i].y[0] - 0.5) + 0.5;
                                    lava[NxtDad + 1].Color = RGB(200, 0, 0);
                                    lava[NxtDad + 1].Type = 1;
                                    lava[NxtDad + 1].speed = 0.02 + Rnd() * 0.02;
                                    lava[NxtDad + 1].Grav = true;
                                    lava[NxtDad + 1].Height = 0.2;
                                    
                                    lava[NxtDad + 2].x = Int(Bullet[i].x[0] - 0.5) + 0.5;
                                    lava[NxtDad + 2].y = Int(Bullet[i].y[0] - 0.5) + 0.5;
                                    lava[NxtDad + 2].Color = RGB(200, 0, 0);
                                    lava[NxtDad + 2].Type = 1;
                                    lava[NxtDad + 2].speed = 0.02 + Rnd() * 0.02;
                                    lava[NxtDad + 2].Grav = true;
                                    lava[NxtDad + 2].Height = 0.2;
                                    
                                    NxtDad = NxtDad + 3;
                                    
                                }
                                Bullet[i].Type = 0;
                            }
                            
                            if ( Bullet[i].Type == 0 ) {
                                var d3d = To3D((Bullet[i].x[0] - MX) * 100, (Bullet[i].y[0] - MY) * 100, (Bullet[i].z[0] - MZ) * 100);
                                //'V[0].x = .x / 15
                                //'V[0].y = .y / 15
                                if ( (d3d.x == 0 && d3d.y == 0) ) {
                                } else {
                                    picture("explode.png", d3d.x - d3d.size, d3d.y - d3d.size, d3d.size * 2, d3d.size * 2, 0);
                                }
                            }
                        }
                    }; //Next lp
                } else if ( Bullet[i].Type == 4 ) {
                    //Me.FillStyle = 0;
                    //Me.FillColor = RGB(155, 155, 155);
                    fill(RGB(155, 155, 155));
                    ellipse(V[0].x, V[0].y, dsz * 2, RGB(155, 155, 155));
                    //Me.FillStyle = 1;
                    Bullet[i].x[0] = Bullet[i].x[0] + Bullet[i].x[1] / AvFrame * 5;
                    Bullet[i].y[0] = Bullet[i].y[0] + Bullet[i].y[1] / AvFrame * 5;
                    Bullet[i].z[0] = Bullet[i].z[0] + Bullet[i].z[1] / AvFrame * 5;
                    Bullet[i].z[1] = Bullet[i].z[1] - 0.05 / AvFrame * 5;
                } else {
                    //'Me.Circle (V[0].x, V[0].y), 500, RGB(255, 0, 0)
                    Bullet[i].x[0] = Bullet[i].x[0] + Bullet[i].x[1] / AvFrame * 5;
                    Bullet[i].y[0] = Bullet[i].y[0] + Bullet[i].y[1] / AvFrame * 5;
                    Bullet[i].z[0] = Bullet[i].z[0] + Bullet[i].z[1] / AvFrame * 5;
                    var d3d = To3D((Bullet[i].x[0] - MX) * 100, (Bullet[i].y[0] - MY) * 100, (Bullet[i].z[0] - MZ) * 100);
                    //'V[0].x = .x / 15
                    //'V[0].y = .y / 15
                    if ( (d3d.x == 0 && d3d.y == 0) || (V[0].x == 0 && V[0].y == 0) ) {
                    } else {
                        line(V[0].x, V[0].y,d3d.x, d3d.y, RGB(255, 255, 255));
                    }
                }
                if ( Bullet[i].x[0] < 1 || Bullet[i].x[0] > size - 1 ) { Bullet[i].Type = 0; }
            } catch (e) {
            }
        }
        
        //'if ( doodad(Bullet[i].x[0] - 0.5, Bullet[i].y[0] - 0.5) != 180 && insidex = true ) { Bullet[i].Type = 0
        
        if ( TFreeze > 0 ) {
            Bullet[i].x[0] = TFX;
            Bullet[i].y[0] = TFY;
            Bullet[i].z[0] = TFZ;
        }
    }; //Next i

    if ( MZ < wl + 0.5 && Cond != 2 ) {
        GX = Math.cos((90 - RX) * 4 * Math.atan(1) / 180);
        GY = Math.sin((90 - RX) * 4 * Math.atan(1) / 180);
        
        GZ = To3D((GX), (GY), wl - MZ).y;
        GZ = GZ;
        //Me.FillStyle = 6;
        //Me.FillColor = RGB(0, 0, 255)
        var colXXX = RGB(0,0,255);
        if ( Cond == 3 ) { colXXX = RGB(255,100,100); }
        colXXX.a = 0.5;
        fill(colXXX);
        if (GZ < 0) {
            GZ = 0;
        }
        rect(0,GZ,width,height, colXXX);
        //line(0, GZ,width, height, RGB(0, 0, 255));
        
        //Me.FillStyle = 1;
    }
    fill(RGB(255,255,255));
    text ("Max Lanzetti (Gun Models)", 0, 15);
    text ("Christopher Rhys Jones", 0, 30);
    text ("Kills " + Kills, 0, height - height/20*3 - 15);
    //text (Weapon, 0, 60);
    

    //if ( Picture5.Visible = false && Picture11.Visible = false ) {
    if ( Weapon == 99 ) {
        DrawCar(PX, PY, LstR);
    } else if ( Weapon == 98 ) {
        DrawPlane(PX, PY, PZ, LstR);
    } else {
        WeaponDrw();
    }
    rect(height / 60,height - height / 20, height / 60*20,height / 80 * 3, RGB(255,200,200));
    rect(height / 60,height - height / 20, Health / 100 * (height / 60*20),height / 80 * 3, RGB(50,50,200));
    
    FillStyle = 1;
    
    if ( Zoom > 1 ) {
        //fill({'r':0,'g':0,'b':0,'a':0.1})
        _rect(width / 4, height / 4,width / 2, height /2, RGB(255, 255, 255)); 
        
    }
    
    Ln = Int(width / 300 / 15) * 15;
    rect(0, height - Ln * 9,Ln * 100, height, RGB(155, 155, 155));
    rect(0, height - Ln * 9,Ln * Health, height, RGB(0, 0, 255));
    
    /*RADAR
    if ( PlayerX > 0 || GameType == -5 ) {
        Me.DrawWidth = 5
        Me.Circle (Ln * 15, Label1.Height + Ln * 15), Ln * 15, RGB(255, 255, 155)
        Me.DrawWidth = 1
        Me.Circle (Ln * 15, Label1.Height + Ln * 15), Ln * 3, RGB(255, 255, 155)
        Me.FillStyle = 0
        Me.FillColor = RGB(0, 0, 255)
        Me.Circle (Ln * 15, Label1.Height + Ln * 15), 60, RGB(0, 0, 255)
        For i = 0 To PMax - 2
            if ( Plr[i].x > 0 && (i != (PlayerX - 1) || GameType = -5) ) {
            
                Yay = Math.abs(Plr[i].y - PY)
                j = CalcAngle(Plr[i].x - PX, Plr[i].y - PY) + 180 + RX
                if ( Math.abs(Plr[i].y - PY - size) < Yay ) {
                    Yay = (Plr[i].y - size)
                    j = CalcAngle(Plr[i].x - PX, Plr[i].y - PY - size) + 180 + RX
                } else if ( Math.abs(Plr[i].y - PY + size) < Yay ) {
                    Yay = (Plr[i].y + size)
                    j = CalcAngle(Plr[i].x - PX, Plr[i].y - PY + size) + 180 + RX
                } else {
                    Yay = Plr[i].y
                }
                
                if ( i != (PlayerX - 1) && Plr[i].Fire > 99 ) {
                    if ( Sqr(Math.abs(Plr[i].x - MX) ^ 2 + Math.abs(Yay - MY) ^ 2) < 10 ) {
                        DrawCar Plr[i].x, Yay, Plr[i].DirectX
                    } else if ( Sqr(Math.abs(Plr[i].x - MX) ^ 2 + Math.abs(Yay - MY) ^ 2) < 15 && Weapon = 98 ) {
                        DrawCar Plr[i].x, Yay, Plr[i].DirectX
                    }
                    if ( Sqr(Math.abs(Plr[i].x - PX) ^ 2 + Math.abs(Yay - PY) ^ 2) < 2 && Weapon != 98 && HtInc = 0 ) { Health = -1
                }
                
                if ( i != (PlayerX - 1) && Plr[i].Fire < 0 ) {
                    if ( Sqr(Math.abs(Plr[i].x - MX) ^ 2 + Math.abs(Yay - MY) ^ 2) < 10 ) { DrawPlane Plr[i].x, Yay, -Plr[i].Fire + BallZ(Plr[i].x, Yay), Plr[i].DirectX
                    if ( Sqr(Math.abs(Plr[i].x - PX) ^ 2 + Math.abs(Yay - PY) ^ 2) < 1 && -(Plr[i].Fire) + BallZ(Plr[i].x, Yay) >= PZ - 0.5 && -(Plr[i].Fire) + BallZ(Plr[i].x, Yay) <= PZ + 0.5 + Jmp + HtInc ) { Health = -1
                }
                
                if ( Plr[i].Fire = 101 ) {
                    GX = Math.cos((90 - Plr[i].DirectX) * 4 * Math.atan(1) / 180)
                    GY = Math.sin((90 - Plr[i].DirectX) * 4 * Math.atan(1) / 180)
                    Plr[i].x = Plr[i].x + GX / AvFrame * 4
                    Plr[i].y = Plr[i].y + GY / AvFrame * 4
                }
            
            
                
                GX = Math.cos(j * 4 * Math.atan(1) / 180) * Sqr(Math.abs(Plr[i].x - PX) ^ 2 + Math.abs(Yay - PY) ^ 2)
                GY = Math.sin(j * 4 * Math.atan(1) / 180) * Sqr(Math.abs(Plr[i].x - PX) ^ 2 + Math.abs(Yay - PY) ^ 2)
                Me.FillStyle = 0
                Me.FillColor = RGB(255, 0, 0)
                if ( Sqr(Math.abs(Plr[i].x - PX) ^ 2 + Math.abs(Yay - PY) ^ 2) < size / 4 ) {
                    Me.Circle (Ln * 15 + GX / size * 4 * Ln * 15, Label1.Height + Ln * 15 + GY / size * 4 * Ln * 15), 30, RGB(255, 0, 0)
                } else {
                    Me.Circle (Ln * 15 + GX / Sqr(Math.abs(Plr[i].x - PX) ^ 2 + Math.abs(Yay - PY) ^ 2) * Ln * 15, Label1.Height + Ln * 15 + GY / Sqr(Math.abs(Plr[i].x - PX) ^ 2 + Math.abs(Yay - PY) ^ 2) * Ln * 15), 30, RGB(255, 0, 0)
                }
            }
        }; //Next i
        Me.FillStyle = 1;
        
    }
    //}
    */

    if ( WpObj > 0 && Ammo == 0 && Weapon < 95 ) {
        var yd3d = To3D((PolyX(WpObj).x[0] + 0.5 - MX), (PolyX(WpObj).y[0] + 0.5 - MY), (PolyX(WpObj).z[0] + 0.2 - MZ));
        Hvr(yd3d.x, yd3d.y);
    }
}



function BuildMap() {
    //On Error Resume }; //Next
    var i = 0; //xAs Long
    var j = 0; //xAs Long
    var k = 0; //xAs Long
    var l = 0; //xAs Long
    var housex = 0; //xAs Long
    var housey = 0; //xAs Long
    var KanoX = new Array(80); // = 0; //xAs Long
    var KanoY = new Array(80); //(0 To 80) = 0; //xAs Long
    var KanoE = new Array(80); //(0 To 80) = 0; //xAs Double
    var KanoZ = new Array(80); //(0 To 80) = 0; //xAs Double
    var Dist = 0; //xAs Double
    //CAt = Seed
    //Randomize

    Cond = Int(Rnd()*4);
    if (Cond ==4) {Cond = 0;}

    //Picture22.AutoRedraw = true

    //Me.Cls
    Clip2 = false;

    Bat = 0;

    for (i = -20; i <= size + 20; i++) {
        _Elev[1 + 25][i + 25] = 12;
        //'Elev(i, Size - 1) = 12

        _Elev[size - 1 + 25][i + 25] = 12;
        //'Elev(i, 1) = 12
        
    }; //Next i

    //'1 car

    for (k = 0; k <= 50; k++) {
    //For k = 0 To 50
        j = Int(Rnd() * size);
        i = size - Int(Rnd() * size);
        _doodad[i+25][j+25] = 1;
    }; //Next k

    for (k = 0; k <= 400; k++) {
        j = size - Int(Rnd() * size);
        i = size - Int(Rnd() * size);
        _doodad[i+25][j+25] = 101 + Int(Rnd() * 6);
        if ( _doodad[i+25][j+25] == 107 ) { _doodad[i+25][j+25] = 101; }
    }; //Next k

    for (k = 0; k <= 200; k++) {
        i = size - Int(Rnd() * size);
        j = Int(Rnd() * size);
        _doodad[i+25][j+25] = 141;
    }; //Next k

    for (k = 0; k <= 50; k++) {
        housey = (size - 6) - Int(Rnd() * (size - 6));
        housex = (size - 6) - Int(Rnd() * (size - 6));
        for (i = housex - 1; i <= housex + 1; i++) {
            for (j = housey - 1; j <= housey + 1; j++) {
                _doodad[i+25][j+25] = 182;
            }; //Next j
        }; //Next i
        _doodad[housex + 25][housey - 3 + 25] = 190;
        _doodad[housex + 3 + 25][housey + 25] = 191;
        _doodad[housex + 25][housey + 3 + 25] = 192;
        _doodad[housex - 3 + 25][housey + 25] = 193;
        _doodad[housex + 25][housey - 2 + 25] = 194;
        _doodad[housex + 2 + 25][housey + 25] = 195;
        _doodad[housex + 25][housey + 2 + 25] = 196;
        _doodad[housex - 2 + 25][housey + 25] = 197;
    }; //Next k

    for (k = 0; k <= 100; k++) {
        housex = (size - 6) - Int(Rnd() * (size - 6));
        housey = (size - 6) - Int(Rnd() * (size - 6));
        //'l = crnd * 9
        var ddddcreate = true;
        for (i = housex; i <= housex + 5; i++) {
            for (j = housey; j <= housey + 5; j++) {
                if ( _Elev[i+25][j+25] > 0 ) { ddddcreate = false; }
            }; //Next j
        }; //Next i
        if (ddddcreate) {
            for (i = housex; i <= housex + 5; i++) {
                for (j = housey; j <= housey + 5; j++) {
                    if ( i == housex || i == housex + 5 || j == housey || j == housey + 5 ) {
                        if ( i != housex + 2 && j != housey + 2 ) {
                            _Elev[i+25][j+25] = 1;
                        } else {
                            if ( Int(Rnd() * 2) == 1 ) {
                                _Elev[i+25][j+25] = 99;
                            } else {
                                _Elev[i+25][j+25] = 1;
                            }
                        }
                    }
                    if ( i < housex + 5 && j < housey + 5 ) { _doodad[i+25][j+25] = 180; }
                }; //Next j
            }; //Next i
            
            if ( Int(Rnd() * 5) == 3 ) { _doodad[housex + 2 + 25][housey - 1 + 25] = 190; _Elev[housex + 2 + 25][housey + 25] = 99; }
            if ( Int(Rnd() * 5) == 3 ) { _doodad[housex + 5 + 25][housey + 2 + 25] = 191; _Elev[housex + 5 + 25][housey + 2 + 25] = 99; }
            if ( Int(Rnd() * 5) == 3 ) { _doodad[housex + 2 + 25][housey + 5 + 25] = 192; _Elev[housex + 2 + 25][housey + 5 + 25] = 99; }
            if ( Int(Rnd() * 5) == 3 ) { _doodad[housex - 1 + 25][housey + 2 + 25] = 193; _Elev[housex + 25][housey + 2 + 25] = 99; }
        }
        
    }; //Next k

    for (k = 0; k <= 20; k++) {
        housex = (size - 6) - Int(Rnd() * (size - 6));
        housey = (size - 6) - Int(Rnd() * (size - 6));
        //'l = crnd * 9
        var ddddcreate = true;
        for (i = housex; i <= housex + 7; i++) {
            for (j = housey; j <= housey + 7; j++) {
                if ( _Elev[i+25][j+25] > 0 ) { ddddcreate = false; }
            }; //Next j
        }; //Next i
        if (ddddcreate) {
            for (i = housex; i <= housex + 7; i++) {
                for (j = housey; j <= housey + 7; j++) {
                    if ( i == housex || i == housex + 7 || j == housey || j == housey + 7 ) {
                        if ( i != housex + 3 && j != housey + 3 ) {
                            _Elev[i+25][j+25] = 21;
                        } else {
                            _Elev[i+25][j+25] = 99;
                        }
                    }
                    if ( i < housex + 7 && j < housey + 7 ) { _doodad[i+25][j+25] = 181; }
                }; //Next j
            }; //Next i
            
            _doodad[housex + 2 + 25][housey + 2 + 25] = 190 + Rnd() * 8;
            _doodad[housex + 5 + 25][housey + 2 + 25] = 190 + Rnd() * 8;
            _doodad[housex + 2 + 25][housey + 5 + 25] = 190 + Rnd() * 8;
            _doodad[housex + 5 + 25][housey + 5 + 25] = 190 + Rnd() * 8;
        }
    }; //Next k


    for (k = 0; k <= 40; k++) {
        KanoX[k] = Int(Rnd() * size);
        KanoY[k] = Int(Rnd() * size);
        KanoE[k] = 2 + Rnd() * 4;
        KanoZ[k] = Rnd() * 4;
        l = Rnd() * 5;
        if ( l == 1 ) { _doodad[KanoX[k] + 25][KanoY[k] + 25] = 140; }
    }; //Next k


    //'101 wep
    //'_doodadSize / 2, Size / 2) = 133

    for (i = -20; i <= size + 20; i++) {
        for (j = -20; j <= size + 20; j++) {
            Dist = -size / 10;
            for (k = 0; k <= 40; k++) {
                if ( -dist(i, KanoX[k],j, KanoY[k]) / KanoE[k] - KanoZ[k] > Dist ) {
                    Dist = -dist(i, KanoX[k],j, KanoY[k]) / KanoE[k] - KanoZ[k];
                }
            }; //Next k
            _block[i+25][j+25] = Dist; //' / 3
            _block[i+25][j+25] = _block[i+25][j+25] - Rnd() * 0.3;
			//_block[i+25][j+25] = 0;
            //if (i == KanoX[0] && j == KanoY[0]) {
            //    _block[i+25][j+25] = -250;
            //}

            if ( i < 0 || i > size ) { _Elev[i+25][j+25] = 0; }
            if ( j < 0 || j > size ) { _Elev[i+25][j+25] = 0; }
            if ( _doodad[i+25][j+25] == 0 && _Elev[i+25][j+25] == 0 ) {
                k = Int(Rnd() * 17);
                if ( k == 1 ) { _doodad[i+25][j+25] = 5 + Int(Rnd() * 3); }
            }

            //if ( _Push[i+25][j+25] == 0 ) {
            //    _Push[i+25][j+25] = -1;
                //l = Picture22.Point(Picture22.Width / size * i, Picture22.Height / size * j)
                //For k = 0 To 7
                //    if ( l = Picture23[k].BackColor ) { Push(i, j) = k + 1
                //}; //Next k
            //}
        }; //Next j
    }; //Next i

    for (i = -20; i <= size + 20; i++) {
        for (j = -20; j <= 20; j++) {
            _block[i + 25][j + size + 25] = ((_block[i+25][j + size+25]) * (20 - j) + _block[i+25][j+25] * (j + 20)) / 40 - Rnd() * 0.3;
            _block[i+25][j+25] = _block[i + 25][j + size + 25];

            if ( j < 0 ) {
                _doodad[i+25][j+25] = _doodad[i + 25][j + size + 25];
                _Elev[i+25][j+25] = _Elev[i + 25][j + size + 25];
            } else {
                _doodad[i + 25][j + size + 25] = _doodad[i+25][j+25];
                _Elev[i + 25][j + size + 25] = _Elev[i+25][j+25];
            }
        }; //Next j
    }; //Next i

    for (k = 0; k <= 30; k++) {
        var ddddcreate = true;
        housey = (size - 8) - Int(Rnd() * (size - 8));
        housex = (size - 8) - Int(Rnd() * (size - 8));
        
        for (i = housex; i <= housex + 7; i++) {
            for (j = housey; j <= housey + 7; j++) {
                if ( _Elev[i+25][j+25] > 0 ) { ddddcreate = false; }
            }; //Next j
        }; //Next i
        
        //'l = crnd * 9
        if (ddddcreate) {
            for (i = housex; i <= housex + 7; i++) {
                for (j = housey; j <= housey + 7; j++) {
                    if ( i == housex || i == housex + 7 || j == housey || j == housey + 7 ) {
                        if ( i != housex + 3 && j != housey + 3 ) {
                            _Elev[i+25][j+25] = 16;
                        } else {
                            _Elev[i+25][j+25] = 99;
                        }
                    }
                }; //Next j
            }; //Next i
        }
    }; //Next k
    
    
    for (k = 0; k <= 700; k++) {
        j = size - Int(Rnd() * size);
        i = size - Int(Rnd() * size);
        if ( _doodad[i+25][j+25] == 0 ) { _doodad[i+25][j+25] = 500; } //210, 501-..
        //ENEMY
    };

    for (k = 0; k <= 50; k++) {
        j = size - Int(Rnd() * size);
        i = size - Int(Rnd() * size);
        if ( _doodad[i+25][j+25] == 0 ) { _doodad[i+25][j+25] = 1; }
    }; //Next k

    for (k = 0; k <= 200; k++) {
        i = size - Int(Rnd() * size);
        j = size - Int(Rnd() * size);
        if ( _doodad[i+25][j+25] == 0 ) { _doodad[i+25][j+25] = 144; }
    }; //Next k

    for (k = 0; k <= 15; k++) {
        i = size - Int(Rnd() * size);
        j = size - Int(Rnd() * size);
        if ( _doodad[i+25][j+25] == 0 ) { _doodad[i+25][j+25] = 2; }
    }; //Next k

    //LoadAlt();
    
    for (k = 0; k <= 5; k++) {
        fromt[k] = 0;
    }; //Next k

}

function Same(Tile1, Tile2) { //xAs Boolean
var Same = false;
if ( Tile1 == 2 || Tile2 == 2 ) { Same = true; }

if ( Tile1 == Tile2 ) { Same = true; }
if ( Tile1 > 0 && Tile2 > 0 ) { Same = true; }
return Same;
}





function BallZ(XX = 0, YY = 0) { //; //xAs Double) = 0; //xAs Double
	var i = 0; //xAs Double
	var x = 0; //xAs Long
	var y = 0; //xAs Long

	var H1 = 0; //xAs Double
	var H2 = 0; //xAs Double

	var Min = 0; //xAs Double
	var Min2 = 0; //xAs Double
	var Min3 = 0; //xAs Double
	var Min4 = 0; //xAs Double

	//'if ( x < 0 || x > Size || y < 0 || y > Size ) { Exit Function

	x = XX; //+ 0.5;
	y = YY; //+ 0.5;

	H1 = block(Int(x + 0.75), Int(y + 0.75));
	H2 = block(Int(x - 0.75), Int(y + 0.75));

	Min = (H2 - H1) * -(XX - Int(x - 0.75));
	Min = H2 + Min;

	H1 = block(Int(x + 0.75), Int(y - 0.75));
	H2 = block(Int(x - 0.75), Int(y - 0.75));

	Min2 = (H2 - H1) * -(XX - Int(x - 0.75));
	Min2 = H2 + Min2;

	return (Min2 + (Min2 - Min) * -(YY - Int(y - 0.75)));

}


function Disy(_col, hh) { //ByVal col = 0; //xAs Long, ByVal hh = 0; //xAs Double) = 0; //xAs Long
	var col = _col;
	var R = _col.r; //xAs Long
	var g = _col.g; //xAs Long
	var B = _col.b; //xAs Long

	//'hh = hh * 8

/*
	B = Int(col / (256 ^ 2));
	col = col - B * (256 ^ 2);
	g = Int(col / 256);
	col = col - g * 256;
	R = Int(col);
	col = col - R;
*/
	if ( R < 30 ) { R = 30; }
	if ( g < 30 ) { g = 30; }
	if ( B < 30 ) { B = 30; }
    
    if (hh < 0.5) {hh = 0.5}
    if (hh > 1) {hh = 1}
    // / hh
	return RGB(Int(R / hh), Int(g / hh), Int(B / hh));
}

function FromGrid() {
	var i = 0; //xAs Long
	var j = 0; //xAs Long
	var l = 0; //xAs Long
	var k = 0; //xAs Long
	var R = 0; //xAs Long
	var cp = 0; //xAs Long
	var XX = 0; //xAs Double
	var YY = 0; //xAs Double
	var GX = 0; //xAs Double
	var GY = 0; //xAs Double
	var Rr = 0; //xAs Long
	var Top = 0; //xAs Double
	var blockstart = 0; //xAs Long
	//var Done(0 To 100, 0 To 100) = false; //xAs Boolean
	//var V(0 To 4); //As POINTAPI
	var Done = new Array(601);
	for (i = 0; i <= 600; i++) {
		Done[i] = new Array(601);
		for (j = 0; j <= 600; j++) {
			Done[i][j] = false;
		}
	}
	var V = [0,0,0,0];

	for (Rr = RX * 4 - 600; Rr <= RX * 4 - 100; Rr++) {
        try {
            l = 0;
            
            blockstart = block(MX, MY);

            GX = Math.cos((0 - Rr) * 4 * Math.atan(1) / 720);
            GY = Math.sin((0 - Rr) * 4 * Math.atan(1) / 720);
            i = MX;
            j = MY;
            while (_block[i+25][j+25] == blockstart) {
                var skipz = false;
                if ( i < 1 || j < 1 || i > size - 1 || j > size - 1 ) {
                    skipz = true;
                    break; //over
                }
                if ( Done[i][j] == false ) {
                    if ( LineAt > 499995 ) { return; }
                    Top = 1;
                    if (_block[i+25][j+25] == 0) {
                        if ( block(i + 1, j) == 3 ) { Top = 0.5; }
                        if ( block(i - 1, j) == 3 ) { Top = 0.5; }
                        if ( block(i, j + 1) == 3 ) { Top = 0.5; }
                        if ( block(i, j - 1) == 3 ) { Top = 0.5; }
                    } else if (_block[i+25][j+25] == 1) {
                        for (k = 0; k <= 1; k++) {
                            PolyX[LineAt].x[0] = i - 0.5;
                            PolyX[LineAt].y[0] = j - 0.5;
                            PolyX[LineAt].z[0] = k;
                            PolyX[LineAt].x[1] = i - 0.5;
                            PolyX[LineAt].y[1] = j + 0.5;
                            PolyX[LineAt].z[1] = k;
                            PolyX[LineAt].x[2] = i + 0.5;
                            PolyX[LineAt].y[2] = j + 0.5;
                            PolyX[LineAt].z[2] = k;
                            PolyX[LineAt].x[3] = i + 0.5;
                            PolyX[LineAt].y[3] = j - 0.5;
                            PolyX[LineAt].z[3] = k;
                            PolyX[LineAt].Colour = RGB(0, 0, 255);
                            PolyX[LineAt].Type = 2;
                            PolyX[LineAt].size = 1;
                            LineAt = LineAt + 1;
                        }; //Next k
                    } else if (_block[i+25][j+25] == 2) {
                        PolyX[LineAt].x[0] = i - 0.5;
                        PolyX[LineAt].y[0] = j - 0.5;
                        PolyX[LineAt].z[0] = 0;
                        PolyX[LineAt].x[1] = i - 0.5;
                        PolyX[LineAt].y[1] = j + 0.5;
                        PolyX[LineAt].z[1] = 0;
                        PolyX[LineAt].x[2] = i + 0.5;
                        PolyX[LineAt].y[2] = j + 0.5;
                        PolyX[LineAt].z[2] = 0;
                        PolyX[LineAt].x[3] = i + 0.5;
                        PolyX[LineAt].y[3] = j - 0.5;
                        PolyX[LineAt].z[3] = 0;
                        PolyX[LineAt].Colour = RGB(0, 255, 0);
                        PolyX[LineAt].Type = 2;
                        PolyX[LineAt].size = 1;
                        LineAt = LineAt + 1;
                        //GoTo ovrz
                        skipz = true;
                    } else if (_block[i+25][j+25] == 3) {
                        PolyX[LineAt].x[0] = i - 0.5;
                        PolyX[LineAt].y[0] = j - 0.5;
                        PolyX[LineAt].z[0] = 0;
                        PolyX[LineAt].x[1] = i - 0.5;
                        PolyX[LineAt].y[1] = j + 0.5;
                        PolyX[LineAt].z[1] = 0;
                        PolyX[LineAt].x[2] = i + 0.5;
                        PolyX[LineAt].y[2] = j + 0.5;
                        PolyX[LineAt].z[2] = 0;
                        PolyX[LineAt].x[3] = i + 0.5;
                        PolyX[LineAt].y[3] = j - 0.5;
                        PolyX[LineAt].z[3] = 0;
                        PolyX[LineAt].Colour = RGB(255, 255, 0);
                        PolyX[LineAt].Type = 2;
                        PolyX[LineAt].size = 1;
                        LineAt = LineAt + 1;
                        Top = 0.5;
                    }
                    if (skipz == false) {
                        if ( Same(block(i - 1, j), _block[i+25][j+25]) == false ) {
                            PolyX[LineAt].x[0] = i - 0.5;
                            PolyX[LineAt].y[0] = j - 0.5;
                            PolyX[LineAt].z[0] = 0;
                            PolyX[LineAt].x[1] = i - 0.5;
                            PolyX[LineAt].y[1] = j - 0.5;
                            PolyX[LineAt].z[1] = Top;
                            PolyX[LineAt].x[2] = i - 0.5;
                            PolyX[LineAt].y[2] = j + 0.5;
                            PolyX[LineAt].z[2] = Top;
                            PolyX[LineAt].x[3] = i - 0.5;
                            PolyX[LineAt].y[3] = j + 0.5;
                            PolyX[LineAt].z[3] = 0;
                            PolyX[LineAt].Colour = RGB(255, 0, 0);
                            PolyX[LineAt].Type = 2;
                            LineAt = LineAt + 1;
                        }
                        if ( Same(block(i + 1, j), _block[i+25][j+25]) == false ) {
                            PolyX[LineAt].x[0] = i + 0.5;
                            PolyX[LineAt].y[0] = j - 0.5;
                            PolyX[LineAt].z[0] = 0;
                            PolyX[LineAt].x[1] = i + 0.5;
                            PolyX[LineAt].y[1] = j - 0.5;
                            PolyX[LineAt].z[1] = Top;
                            PolyX[LineAt].x[2] = i + 0.5;
                            PolyX[LineAt].y[2] = j + 0.5;
                            PolyX[LineAt].z[2] = Top;
                            PolyX[LineAt].x[3] = i + 0.5;
                            PolyX[LineAt].y[3] = j + 0.5;
                            PolyX[LineAt].z[3] = 0;
                            PolyX[LineAt].Colour = RGB(255, 0, 0);
                            PolyX[LineAt].Type = 2;
                            LineAt = LineAt + 1;
                        }
                        if ( Same(block(i, j - 1), _block[i+25][j+25]) == false ) {
                            PolyX[LineAt].x[0] = i - 0.5;
                            PolyX[LineAt].y[0] = j - 0.5;
                            PolyX[LineAt].z[0] = 0;
                            PolyX[LineAt].x[1] = i - 0.5;
                            PolyX[LineAt].y[1] = j - 0.5;
                            PolyX[LineAt].z[1] = Top;
                            PolyX[LineAt].x[2] = i + 0.5;
                            PolyX[LineAt].y[2] = j - 0.5;
                            PolyX[LineAt].z[2] = Top;
                            PolyX[LineAt].x[3] = i + 0.5;
                            PolyX[LineAt].y[3] = j - 0.5;
                            PolyX[LineAt].z[3] = 0;
                            PolyX[LineAt].Colour = RGB(255, 0, 0);
                            PolyX[LineAt].Type = 2;
                            LineAt = LineAt + 1;
                        }
                        if ( Same(block(i, j + 1), _block[i+25][j+25]) == false ) {
                            PolyX[LineAt].x[0] = i - 0.5;
                            PolyX[LineAt].y[0] = j + 0.5;
                            PolyX[LineAt].z[0] = 0;
                            PolyX[LineAt].x[1] = i - 0.5;
                            PolyX[LineAt].y[1] = j + 0.5;
                            PolyX[LineAt].z[1] = Top;
                            PolyX[LineAt].x[2] = i + 0.5;
                            PolyX[LineAt].y[2] = j + 0.5;
                            PolyX[LineAt].z[2] = Top;
                            PolyX[LineAt].x[3] = i + 0.5;
                            PolyX[LineAt].y[3] = j + 0.5;
                            PolyX[LineAt].z[3] = 0;
                            PolyX[LineAt].Colour = RGB(255, 0, 0);
                            PolyX[LineAt].Type = 2;
                            LineAt = LineAt + 1;
                        }
                    }//ovrz:
                    Done[i][j] = true;
                }
                l = l + 1;
                i = MX + (GX * l);
                j = MY + (GY * l);
                if ( blockstart == 2 || _block[i+25][j+25] == 2 ) { blockstart = _block[i+25][j+25]; }
                if ( blockstart > 0 && _block[i+25][j+25] > 0 ) { blockstart = _block[i+25][j+25]; }
            }//Loop
            //over:
            Done[Int(MX)][Int(MY)] = true;
    
        } catch (e) {
        }
	}; //Next Rr

}

function Surface() {
	//On Error Resume }; //Next
	var i = 0; //xAs Long
	var j = 0; //xAs Long
	var k = 0; //xAs Long
	var l = 0; //xAs Double
	var R = 0; //xAs Long
	var cp = 0; //xAs Long
	var XX = 0; //xAs Double
	var YY = 0; //xAs Double
	var GX = 0; //xAs Double
	var GY = 0; //xAs Double
	var GZ = 0; //xAs Double
	var Rr = 0; //xAs Long
	var minx = 0; //xAs Long
	var miny = 0; //xAs Long
	var Top = 0; //xAs Double
	var nn1 = 0; //xAs Long
	var Sidecut = 0; //xAs Long
	var newyy = 0; //xAs Double
	Surf = true;


	var RanGX = 0; //xAs Double
	var RanGY = 0; //xAs Double
	//'var blockstart = 0; //xAs Long
	var Done = new Array(601);
	for (i = 0; i <= 600; i++) {
		Done[i] = new Array(601);
		for (j = 0; j <= 600; j++) {
			Done[i][j] = false;
		}
	}
	var V = [0,0,0,0];


	var Hrzon = new Array(51); //As POINTAPI
	for (i = 0; i <= 50; i++) {
		Hrzon[i] = 0;
	}


	var tempx = 0; //xAs Long

	var R1 = 0; //xAs Double

	var Ovr = 0; //xAs Long

	//var HLst(-720 To 1440) = 0; //xAs Long
	//var dbs(-720 To 1440) = false; //xAs Boolean
	
	var HLst = new Array(3000);
	var dbs = new Array(3000);
	for (i = 0; i <= 3000; i++) {
		HLst[i] = 0;
		dbs[i] = false;
	}
	
	var CurH = 0; //xAs Long



	var loopx = 0; //xAs Long
	var loopy = 0; //xAs Long
	var Both = false; //xAs Boolean
	var T = 0; //xAs Double
	var W = 0; //xAs Double

	var hh = 0; //xAs Double
	var LstDad = 0; //xAs Long

	LineAt = NxtDad + 1;
	LstDad = NxtDad - 1;

	WpObj = 0;
	if ( PlayerX > 0 || GameType == -5 ) {
		for (k = 0; k <= PMax - 2; k++) {
			if ( (k != (PlayerX - 1) || GameType == -5) && Plr[k].Fire > 0 ) {
				if ( Plr[k].Fire > 99 || Plr[k].Fire < 0 ) {
				} else if ( Plr[k].Fire < 5 ) {
					Bullet[NxtBlt].x[0] = Plr[k].x;
					Bullet[NxtBlt].y[0] = Plr[k].y;
					Bullet[NxtBlt].z[0] = BallZ(Plr[k].x, Plr[k].y) + 0.5 + Plr[k].Jump;
					
					GX = Math.cos((90 - Plr[k].DirectX) * 4 * Math.atan(1) / 180);
					GY = Math.sin((90 - Plr[k].DirectX) * 4 * Math.atan(1) / 180);
					GZ = Math.cos((-Plr[k].DirectY - 90) * 4 * Math.atan(1) / 180);
					
					Bullet[NxtBlt].x[1] = GX * 2;
					Bullet[NxtBlt].y[1] = GY * 2;
					Bullet[NxtBlt].z[1] = GZ * 2;
					Bullet[NxtBlt].Type = 32 + Plr[k].Fire;
					NxtBlt = NxtBlt + 1;
					if ( NxtBlt > 300 ) { NxtBlt = 0; }
				} else if ( Plr[k].Fire == 5 ) {
					for (i = 0; i <= 10; i++) {
						Bullet[NxtBlt].x[0] = Plr[k].x;
						Bullet[NxtBlt].y[0] = Plr[k].y;
						Bullet[NxtBlt].z[0] = BallZ(Plr[k].x, Plr[k].y) + 0.5 + Plr[k].Jump;
						
						GX = Math.cos((93 - Plr[k].DirectX - Rnd() * 6) * 4 * Math.atan(1) / 180);
						GY = Math.sin((93 - Plr[k].DirectX - Rnd() * 6) * 4 * Math.atan(1) / 180);
						GZ = Math.cos((-Plr[k].DirectY - 93 + Rnd() * 6) * 4 * Math.atan(1) / 180);
						
						Bullet[NxtBlt].x[1] = GX * 2;
						Bullet[NxtBlt].y[1] = GY * 2;
						Bullet[NxtBlt].z[1] = GZ * 2;
						Bullet[NxtBlt].Type = 33;
						NxtBlt = NxtBlt + 1;
						if ( NxtBlt > 300 ) { NxtBlt = 0; }
					}; //Next i
				} else if ( Plr[k].Fire == 6 ) {
					Bullet[NxtBlt].x[0] = Plr[k].x;
					Bullet[NxtBlt].y[0] = Plr[k].y;
					Bullet[NxtBlt].z[0] = BallZ(Plr[k].x, Plr[k].y) + 0.5 + Plr[k].Jump;
					
					GX = Math.cos((93 - Plr[k].DirectX - Rnd() * 6) * 4 * Math.atan(1) / 180);
					GY = Math.sin((93 - Plr[k].DirectX - Rnd() * 6) * 4 * Math.atan(1) / 180);
					GZ = Math.cos((-Plr[k].DirectY - 93 + Rnd() * 6) * 4 * Math.atan(1) / 180);
					
					Bullet[NxtBlt].x[1] = GX * 2;
					Bullet[NxtBlt].y[1] = GY * 2;
					Bullet[NxtBlt].z[1] = GZ * 2;
					Bullet[NxtBlt].Type = 33;
					NxtBlt = NxtBlt + 1;
					if ( NxtBlt > 300 ) { NxtBlt = 0; }
				}
				if ( Plr[k].Fire < 100 && Plr[k].Fire > 0 ) { Plr[k].Fire = 0; }
			}
			j = 13;
			if ( Zoom > 1 ) { j = 25; }
			if ( dist(Plr[k].x, MX,Plr[k].y, MY) > dist(Plr[k].x, MX,Plr[k].y+ size, MY) ) {
				newyy = Plr[k].y + size;
			} else if ( dist(Plr[k].x, MX,Plr[k].y, MY) > dist(Plr[k].x, MX,Plr[k].y - size,MY) ) {
				newyy = Plr[k].y - size;
			} else {
				newyy = Plr[k].y;
			}
			if ( Plr[k].x > 0 && (k != (PlayerX - 1) || GameType == -5) && dist(Plr[k].x, MX,newyy, MY) < j ) {
				hh = dist(Plr[k].x, MX,newyy, MY) * 1 * Colup;
				if ( hh < 1.4 ) { hh = 1.4; }
				if ( Plr[k].Fire < 100 && Plr[k].Fire >= 0 ) {
					PolyX[LineAt].x[0] = Plr[k].x;
					PolyX[LineAt].y[0] = newyy;
					PolyX[LineAt].z[0] = BallZ(Plr[k].x, Plr[k].y) + 0.5 + Plr[k].Jump;
					PolyX[LineAt].Colour = RGB(255 / hh, 155 / hh, 155 / hh);
					PolyX[LineAt].Type = 77;
					PolyX[LineAt].size = 2;
					LineAt = LineAt + 1;
					
					PolyX[LineAt].x[0] = Plr[k].x;
					PolyX[LineAt].y[0] = newyy;
					PolyX[LineAt].z[0] = BallZ(Plr[k].x, Plr[k].y) + Plr[k].Jump;
					PolyX[LineAt].x[1] = Plr[k].x;
					PolyX[LineAt].y[1] = newyy;
					PolyX[LineAt].z[1] = BallZ(Plr[k].x, Plr[k].y) + 0.5 + Plr[k].Jump;
					PolyX[LineAt].Colour = RGB(255 / hh, 155 / hh, 155 / hh);
					PolyX[LineAt].Type = 5;
					PolyX[LineAt].size = 10;
					LineAt = LineAt + 1;
				}
			}
		}; //Next k
	}
	GX = 0;
	GY = 0;

	if ( Zoom > 1 ) {
		Sidecut = 200;
		//HScroll2Value = 25;
        HScroll2Value = 15;
		HScroll1Value = 5;
	} else {
		Sidecut = 0;
		//'HScroll2.Value = 10
		//HScroll2Value = 20;
        HScroll2Value = 10;
		HScroll1Value = 12
	}

	if ( Weapon == 98 || Weapon == 99 ) {
		Sidecut = 0;
		//'HScroll2.Value = 15
		//HScroll2Value = 25;
        HScroll2Value = 15;
		HScroll1Value = 12;
	}

	l = 0;
	while (l <= HScroll2Value + 2) { //'35
	
		for (Rr = RX * 4 - 600 + Sidecut; Rr <= RX * 4 - 100 - Sidecut; Rr += HScroll1Value) {
			try {
                if ( l < 2 ) { HLst[Rr + 720]  = height * 2; }
                
                GX = Math.cos((0 - Rr) * 4 * Math.atan(1) / 720);
                GY = Math.sin((0 - Rr) * 4 * Math.atan(1) / 720);
                i = Int(MX + GX * l);
                j = Int(MY + GY * l);
                
                if ( doodad(MX - GX * l, MY - GY * l) >= 500 ) {
                    mkdad(MX - GX * l, MY - GY * l, 2);
                }
                
                if ( (i < -19 || j < -19 || i > size + 19 || j > size + 19) == false ) {

                    //'if ( Done[i][j] = false ) {
                    /*
                    if ( GameType == 1 ) {
                        _doodad[i+25][j+25] = 0;
                        _Elev[i+25][j+25] = 0;
                        if ( block(i,j) > -7 ) { block(i,j) = -7; }
                        
                        var selp = Push(i, j);
                        if (selp == -1 || selp == 2) {
                        } else if (selp == 1) {
                            _doodad[i+25][j+25] = 180;
                            if ( Push(i - 1, j) == -1 || Push(i, j - 1) == -1 || Push(i - 1, j - 1) == -1 || Push(i + 1, j - 1) == -1 || Push(i - 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 1; }
                            if ( Push(i + 1, j) == -1 || Push(i, j + 1) == -1 || Push(i + 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 1; _doodad[i+25][j+25] = 0; }
                        } else if (selp == 20) {
                            _doodad[i+25][j+25] = 210;
                            if ( Push(i - 1, j) == -1 || Push(i, j - 1) == -1 || Push(i - 1, j - 1) == -1 || Push(i + 1, j - 1) == -1 || Push(i - 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 1; }
                            if ( Push(i + 1, j) == -1 || Push(i, j + 1) == -1 || Push(i + 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 1; _doodad[i+25][j+25] = 0; }
                        } else if (selp == 13) { //pistol
                            _doodad[i+25][j+25] = 204;
                            if ( Push(i - 1, j) == -1 || Push(i, j - 1) == -1 || Push(i - 1, j - 1) == -1 || Push(i + 1, j - 1) == -1 || Push(i - 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 1; }
                            if ( Push(i + 1, j) == -1 || Push(i, j + 1) == -1 || Push(i + 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 1; _doodad[i+25][j+25] = 0; }
                        } else if (selp == 15) { //shotgun
                            _doodad[i+25][j+25] = 201;
                            if ( Push(i - 1, j) == -1 || Push(i, j - 1) == -1 || Push(i - 1, j - 1) == -1 || Push(i + 1, j - 1) == -1 || Push(i - 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 1; }
                            if ( Push(i + 1, j) == -1 || Push(i, j + 1) == -1 || Push(i + 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 1; _doodad[i+25][j+25] = 0; }
                        } else if (selp == 18) { //scarh
                            _doodad[i+25][j+25] = 206;
                            if ( Push(i - 1, j) == -1 || Push(i, j - 1) == -1 || Push(i - 1, j - 1) == -1 || Push(i + 1, j - 1) == -1 || Push(i - 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 1; }
                            if ( Push(i + 1, j) == -1 || Push(i, j + 1) == -1 || Push(i + 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 1; _doodad[i+25][j+25] = 0; }
                        } else if (selp == 19) { //light
                            _doodad[i+25][j+25] = 209;
                            if ( Push(i - 1, j) == -1 || Push(i, j - 1) == -1 || Push(i - 1, j - 1) == -1 || Push(i + 1, j - 1) == -1 || Push(i - 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 1; }
                            if ( Push(i + 1, j) == -1 || Push(i, j + 1) == -1 || Push(i + 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 1; _doodad[i+25][j+25] = 0; }
                        } else if (selp == 3) {
                            if ( Push(i - 1, j) == -1 || Push(i, j - 1) == -1 || Push(i - 1, j - 1) == -1 || Push(i + 1, j - 1) == -1 || Push(i - 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 14; }
                            if ( Push(i + 1, j) == -1 || Push(i, j + 1) == -1 || Push(i + 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 14; }
                        } else if (selp == 4) {
                            if ( Push(i - 1, j) == -1 || Push(i, j - 1) == -1 || Push(i - 1, j - 1) == -1 || Push(i + 1, j - 1) == -1 || Push(i - 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 6; }
                            if ( Push(i + 1, j) == -1 || Push(i, j + 1) == -1 || Push(i + 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 6; }
                        } else if (selp == 5) {
                            //'_doodad[i+25][j+25] = 1
                            if ( Push(i - 1, j) == -1 || Push(i, j - 1) == -1 || Push(i - 1, j - 1) == -1 || Push(i + 1, j - 1) == -1 || Push(i - 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 26; }
                            if ( Push(i + 1, j) == -1 || Push(i, j + 1) == -1 || Push(i + 1, j + 1) == -1 ) { _Elev[i+25][j+25] = 26; }
                        } else if (selp == 9) { //healthpack
                            _doodad[i+25][j+25] = 133;
                        } else if (selp == 14) { //rl
                            _doodad[i+25][j+25] = 102;
                        } else if (selp == 16) { //sniper
                            _doodad[i+25][j+25] = 105;
                        } else if (selp == 11) { //rl
                            _doodad[i+25][j+25] = 1;
                        } else if (selp == 12) { //sniper
                            _doodad[i+25][j+25] = 2;
                        } else if (selp == 10) { //sniper
                            _doodad[i+25][j+25] = 500;
                        }
                    }*/
                    if ( Cond == 1 && block(i,j) < wl ) { _block[i+25][j+25] = wl; }
            
                    //if ( Check3Value == 1 ) { CurH = To3D(i - MX, j - MY, BallZ(i + 0, j + 0) - MZ).y; }
                    CurH = To3D(i - MX, j - MY, BallZ(i + 0, j + 0) - MZ).y;
                    if ( (CurH <= HLst[Rr + 720] || dbs[Rr + 720] == false) && l <= HScroll2Value ) {
                        if ( CurH > HLst[Rr + 720] ) {
                            dbs[Rr + 720] = true;
                        } else {
                            dbs[Rr + 720] = false;
                        }
                        
                        HLst[Rr + 720] = CurH;
                        
                        if ( Done[i+25][j+25] == false ) {
                                
                            if ( LineAt > 499990 ) { return; } //Exit Sub
                            
                            hh = dist(i, MX,j, MY) * 1 * Colup;
                            if ( hh < 1.4 ) { hh = 1.4; }
                            
                            //'For tempx = 0 To NxtDad
                            //'    if ( Int(lava(tempx).x) = i && Int(lava(tempx).y) = j ) {
                            //'        PolyX[LineAt].x[0] = lava(tempx).x
                            //'        PolyX[LineAt].y[0] = lava(tempx).y
                            //'        PolyX[LineAt].z[0] = BallZ(lava(tempx).x, lava(tempx).y)
                            //'        PolyX[LineAt].Colour = Disy(lava[i].Color, hh) //'
                            //'        PolyX[LineAt].Type = 3
                            //'        PolyX[LineAt].Size = 1
                            //'        LineAt = LineAt + 1
                            //'    }
                            //'}; //Next tempx
                            
                            if ( _Elev[i+25][j+25] > 0 && _Elev[i+25][j+25] != 99 ) {
                                if ( Elev(i + 1, j) > 0 ) {
                                    PolyX[LineAt].x[1] = i + 1;
                                    PolyX[LineAt].y[1] = j;
                                    PolyX[LineAt].z[1] = block(i + 1, j);
                                    PolyX[LineAt].x[2] = i + 1;
                                    PolyX[LineAt].y[2] = j;
                                    PolyX[LineAt].z[2] = block(i + 1, j) + 1.5;
                                    PolyX[LineAt].x[0] = i;
                                    PolyX[LineAt].y[0] = j;
                                    PolyX[LineAt].z[0] = block(i,j);
                                    PolyX[LineAt].x[3] = i;
                                    PolyX[LineAt].y[3] = j;
                                    PolyX[LineAt].z[3] = block(i,j) + 1.5;
                                    var sele = _Elev[i+25][j+25] - Int(_Elev[i+25][j+25] / 10) * 10;
                                    if (sele == 1) {
                                    //'    PolyX[LineAt].Colour = RGB(60 / hh, 60 / hh, 255 / hh)
                                        PolyX[LineAt].Colour = RGB(200 / hh, 200 / hh, 120 / hh);
                                    } else if (sele == 2) {
                                        PolyX[LineAt].Colour = RGB(255 / hh, 60 / hh, 60 / hh);
                                    } else if (sele == 3) {
                                        PolyX[LineAt].Colour = RGB(60 / hh, 255 / hh, 60 / hh);
                                    } else if (sele == 4) {
                                        PolyX[LineAt].Colour = RGB(255 / hh, 255 / hh, 60 / hh);
                                    } else if (sele == 5) {
                                        PolyX[LineAt].Colour = RGB(60 / hh, 255 / hh, 255 / hh);
                                    } else if (sele == 6) {
                                        PolyX[LineAt].Colour = RGB(255 / hh, 60 / hh, 255 / hh);
                                    //'Case 7
                                        
                                    //'Case 8
                                    //'    PolyX[LineAt].Colour = RGB(60 / hh, 60 / hh, 60 / hh)
                                    //'Case 9, 0
                                    //'    PolyX[LineAt].Colour = RGB(255 / hh, 155 / hh, 60 / hh)
                                    }
                                    PolyX[LineAt].Type = 2;
                                    if ( _Elev[i+25][j+25] > 10 && _Elev[i+25][j+25] < 20 ) { PolyX[LineAt].Type = 4; }
                                    if ( _Elev[i+25][j+25] == 12) {PolyX[LineAt].Type = 2; PolyX[LineAt].Colour.a = 0.5;}
                                    if ( _Elev[i+25][j+25] > 20 ) {
                                        PolyX[LineAt].z[2] = block(i + 1, j) + 3;
                                        PolyX[LineAt].z[3] = block(i + 1, j) + 3;
                                    }
                                    PolyX[LineAt].size = 0.1;
                                    LineAt = LineAt + 1;
                                }
                                
                                if ( Elev(i, j + 1) > 0 ) {
                                    PolyX[LineAt].x[1] = i;
                                    PolyX[LineAt].y[1] = j + 1;
                                    PolyX[LineAt].z[1] = block(i, j + 1);
                                    PolyX[LineAt].x[2] = i;
                                    PolyX[LineAt].y[2] = j + 1;
                                    PolyX[LineAt].z[2] = block(i, j + 1) + 1.5;
                                    PolyX[LineAt].x[0] = i;
                                    PolyX[LineAt].y[0] = j;
                                    PolyX[LineAt].z[0] = block(i,j);
                                    PolyX[LineAt].x[3] = i;
                                    PolyX[LineAt].y[3] = j;
                                    PolyX[LineAt].z[3] = block(i,j) + 1.5;
                                        
                                    var sele = _Elev[i+25][j+25] - Int(_Elev[i+25][j+25] / 10) * 10;
                                    if (sele == 1) {
                                        PolyX[LineAt].Colour = RGB(200 / hh, 200 / hh, 120 / hh);
                                    //'    PolyX[LineAt].Colour = RGB(40 / hh, 40 / hh, 255 / hh)
                                    } else if (sele == 2) {
                                        PolyX[LineAt].Colour = RGB(255 / hh, 40 / hh, 40 / hh);
                                    } else if (sele == 3) {
                                        PolyX[LineAt].Colour = RGB(40 / hh, 255 / hh, 40 / hh);
                                    } else if (sele == 4) {
                                        PolyX[LineAt].Colour = RGB(255 / hh, 255 / hh, 40 / hh);
                                    } else if (sele == 5) {
                                        PolyX[LineAt].Colour = RGB(40 / hh, 255 / hh, 255 / hh);
                                    } else if (sele == 6) {
                                        PolyX[LineAt].Colour = RGB(255 / hh, 40 / hh, 255 / hh);
                                    //'Case 7
                                        
                                    //'Case 8
                                    //'    PolyX[LineAt].Colour = RGB(40 / hh, 40 / hh, 40 / hh)
                                    //'Case 9, 0
                                    //'    PolyX[LineAt].Colour = RGB(255 / hh, 155 / hh, 40 / hh)
                                    }
                                    PolyX[LineAt].Type = 2;
                                    if ( _Elev[i+25][j+25] > 10 && _Elev[i+25][j+25] < 20 ) { PolyX[LineAt].Type = 4; }
                                    if ( _Elev[i+25][j+25] == 12) {PolyX[LineAt].Type = 2; PolyX[LineAt].Colour.a = 0.5;}
                                    if ( _Elev[i+25][j+25] > 20 ) {
                                        PolyX[LineAt].z[2] = block(i + 1, j) + 3;
                                        PolyX[LineAt].z[3] = block(i + 1, j) + 3;
                                    }
                                    PolyX[LineAt].size = 0.1;
                                    LineAt = LineAt + 1;
                                }
                            }
                            
                            if ( _doodad[i+25][j+25] != 0 ) { mkdad(i, j, hh); }
                            
                            if ( block(i,j) <= wl && Cond != 2 ) {
                                //'if ( Cond = 1 ) { block(i,j) = wl
                                PolyX[LineAt].x[0] = i;
                                PolyX[LineAt].y[0] = j;
                                PolyX[LineAt].z[0] = wl;
                                PolyX[LineAt].x[1] = i + 1;
                                PolyX[LineAt].y[1] = j;
                                PolyX[LineAt].z[1] = block(i + 1, j);
                                if ( block(i + 1, j) < wl ) { PolyX[LineAt].z[1] = wl; }
                                PolyX[LineAt].x[2] = i + 1;
                                PolyX[LineAt].y[2] = j + 1;
                                PolyX[LineAt].z[2] = block(i + 1, j + 1);
                                if ( block(i + 1, j + 1) < wl ) { PolyX[LineAt].z[2] = wl; }
                                PolyX[LineAt].x[3] = i;
                                PolyX[LineAt].y[3] = j + 1;
                                PolyX[LineAt].z[3] = block(i, j + 1);
                                if ( block(i, j + 1) < wl ) { PolyX[LineAt].z[3] = wl; }
                                PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh);
                                PolyX[LineAt].Type = 2;
                                //if ( Cond == 1 || Cond == 3 ) { PolyX[LineAt].Type = 2; }
                                if ( Cond == 3 ) { PolyX[LineAt].Colour = RGB(255 / hh, 50 / hh, 50 / hh); }
                                PolyX[LineAt].Colour.a = 0.5;
                                PolyX[LineAt].size = 0.1;
                                LineAt = LineAt + 1;
                            }
                            
                            if ( block(i,j) < wl && Cond == 1 ) {
                            } else {
                                PolyX[LineAt].x[0] = i;
                                PolyX[LineAt].y[0] = j;
                                PolyX[LineAt].z[0] = block(i,j);
                                PolyX[LineAt].x[1] = i + 1;
                                PolyX[LineAt].y[1] = j;
                                PolyX[LineAt].z[1] = block(i + 1, j);
                                PolyX[LineAt].x[2] = i + 1;
                                PolyX[LineAt].y[2] = j + 1;
                                PolyX[LineAt].z[2] = block(i + 1, j + 1);
                                PolyX[LineAt].x[3] = i;
                                PolyX[LineAt].y[3] = j + 1;
                                PolyX[LineAt].z[3] = block(i, j + 1);
                                
                                if (Cond == 0) {
                                    PolyX[LineAt].Colour = RGB(50 / hh, 255 / hh, 50 / hh);
                                } else if (Cond == 1) {
                                    PolyX[LineAt].Colour = RGB(255 / hh, 255 / hh, 255 / hh);
                                } else if (Cond == 2) {
                                    PolyX[LineAt].Colour = RGB(255 / hh, 200 / hh, 100 / hh);
                                } else if (Cond == 3) {
                                    PolyX[LineAt].Colour = RGB(255 / hh, 150 / hh, 150 / hh);
                                } else if (Cond == 4) {
                                    Cond = 0;
                                    if ( (15 + block(i,j)) * 10 < 0 ) {
                                        PolyX[LineAt].Colour = RGB(0, 0, -block(i,j) * 10);
                                    } else {
                                        PolyX[LineAt].Colour = RGB(0, (15 + block(i,j)) * 10, -block(i,j) * 10);
                                    }
                                }
                                //PolyX[LineAt].Colour = RGB(255, 255,255);
                                PolyX[LineAt].Type = 2;
                                PolyX[LineAt].size = 0.1;
                                LineAt = LineAt + 1;
                            }
                            
                            Done[i+25][j+25] = true;
                            
                        }
                        
                    }
                }
                
                if ( Done[i+25][j+25] == false && l < 3 ) {
                    hh = dist(i, MX,j, MY) * 1 * Colup
                    if ( hh < 1.4 ) { hh = 1.4; }
                    mkdad(i, j, hh);
                    Done[i+25][j+25] = true;
                }
        //'over:
            
            } catch (e) {
                l = l
            }
			//'if ( l = 35 ) { GoTo goout
		}; //Next Rr
		l = l + 1
	} //Loop
	//goout:

	l = 0;
	for (l = 1; l <= 100; l += 5) {
		nn1 = 0;
		for (Rr = RX * 4 - 500; Rr <= RX * 4 - 200; Rr += 24) {
            try {
                nn1 = nn1 + 1;
                
                if ( l < 2 ) { HLst[Rr + 720] = height * 2; }
                
                GX = Math.cos((0 - Rr) * 4 * Math.atan(1) / 720);
                GY = Math.sin((0 - Rr) * 4 * Math.atan(1) / 720);
                RanGX = MX + GX * l;
                RanGY = MY + GY * l;
                i = Int(MX + GX * l);
                j = Int(MY + GY * l);
                
                if ( (i < -19 || j < -19 || i > size + 19 || j > size + 19) == false ) {
                
                    //'if ( Done[i][j] = false ) {
                    //if ( Check3Value = 1 ) { 
                    CurH = To3D(i - MX, j - MY, BallZ(i + 0, j + 0) - MZ).y;
                    if ( CurH <= HLst[Rr + 720] || l <= (HScroll2Value + 5) ) {
                        //'if ( CurH > HLst[Rr + 720] ) {
                        //'    dbs[Rr + 720] = true
                        //'} else {
                        //'    dbs[Rr + 720] = false
                        //'}
                        
                        HLst[Rr + 720] = CurH;
                        
                        if ( Done[i+25][j+25] == false ) {
                                
                            
                            //'hh = (Sqr(Math.abs(i - MX) ^ 2 + Math.abs(j - MY) ^ 2)) * 2
                            //'if hh < 1.4 then hh = 1.4
                            
                            //'For tempx = 0 To NxtDad
                            //'    if ( Int(lava(tempx).x) = i && Int(lava(tempx).y) = j ) {
                            //'        PolyX[LineAt].x[0] = lava(tempx).x
                            //'        PolyX[LineAt].y[0] = lava(tempx).y
                            //'        PolyX[LineAt].z[0] = BallZ(lava(tempx).x, lava(tempx).y)
                            //'        PolyX[LineAt].Colour = Disy(lava[i].Color, hh) //'
                            //'        PolyX[LineAt].Type = 3
                            //'        PolyX[LineAt].Size = 1
                            //'        LineAt = LineAt + 1
                            //'    }
                            //'}; //Next tempx
                            
                                //'if ( LineAt > 499990 ) { Exit Sub
                                //'PolyX[LineAt].X[0] = RanGX
                                //'PolyX[LineAt].Y[0] = RanGY
                                //'PolyX[LineAt].z[0] = BallZ(RanGX + 0#, RanGY + 0#)
                
                                //'PolyX[LineAt].Colour = RGB(255, 50, 50)
                                //'PolyX[LineAt].Type = 3
                                //'PolyX[LineAt].Size = 0.5
                                //'LineAt = LineAt + 1
                            var d3d = To3D(RanGX - MX, RanGY - MY, BallZ(RanGX + 0, RanGY + 0) - MZ);
                            Hrzon[nn1].x = d3d.x / 15;
                            Hrzon[nn1].y = d3d.y / 15;
                            //End With
                            Done[i+25][j+25] = true;
                            
                        }
                    }
                } else if ( Hrzon[nn1].x == 0 ) {
                    nn1 = 0;
                }
            } catch (e) {
            }
	//'over:
			//'if ( l = 35 ) { GoTo goout
		}; //Next Rr
		l = l + 1;
	}; //Next

	nn1 = nn1 + 1;
	Hrzon[nn1].x = 0;
	Hrzon[nn1].y = height / 15;

	nn1 = nn1 + 1;
	Hrzon[nn1].x = width / 15;
	Hrzon[nn1].y = height / 15;

	//Me.FillStyle = 0
	//Me.FillColor = RGB(50, 250, 50)
	//Me.ForeColor = RGB(50, 250, 50)
	//Select Case Cond
	//Case 0, 4
	//	Me.FillColor = RGB(6 / Colup, 20 / Colup, 6 / Colup)
	//	Me.ForeColor = RGB(6 / Colup, 20 / Colup, 6 / Colup)
	//Case 1
	//	Me.FillColor = RGB(20 / Colup, 20 / Colup, 20 / Colup)
	//	Me.ForeColor = RGB(20 / Colup, 20 / Colup, 20 / Colup)
	//Case 2
	//	Me.FillColor = RGB(20 / Colup, 16 / Colup, 10 / Colup)
	//	Me.ForeColor = RGB(20 / Colup, 16 / Colup, 10 / Colup)
	//Case 3
	//	Me.FillColor = RGB(20 / Colup, 16 / Colup, 16 / Colup)
	//	Me.ForeColor = RGB(20 / Colup, 16 / Colup, 16 / Colup)
	//End Select



	//if ( Zoom < 2 && GameType != 1 ) {
		//Polygon Me.hDC, Hrzon[1], nn1
		//Me.FillStyle = 1
	//}

	if ( Rainfor >= 0 && PlayerX == 0 ) {
		k = Rnd() * 500;
		if ( k < nn1 ) {
			if ( Hrzon[k].x > 0 ) {
				Hrzon[nn1 + 2] = Hrzon[k];
				//Me.DrawWidth = 4;
				do {
					Hrzon[nn1 + 3] = Hrzon[nn1 + 2];
					Hrzon[nn1 + 2].x = Hrzon[nn1 + 2].x - (width / 256) + Rnd() * (width / 128);
					Hrzon[nn1 + 2].y = Hrzon[nn1 + 2].y + (width / 1024) - Rnd() * (width / 256);
					line(Hrzon[nn1 + 2].x * 15, Hrzon[nn1 + 2].y * 15,Hrzon[nn1 + 3].x * 15, Hrzon[nn1 + 3].y * 15, RGB(255, 255, 255));
				} while (Hrzon[nn1 + 2].y >= 0);
				//Me.DrawWidth = 0
			}
		}
	}

	Surf = false;

	i = 0;
	while (i < LstDad + 1) {
        try {
            if ( lava[i].Type == 0 ) {
                lava[i] = lava[i + 1];
                lava[i + 1].Type = 0;
            }
            if ( lava[i].Type == 0 ) { lava[i].Grav = false; }
            if ( lava[i].Grav == true && TFreeze < 1 ) {
                
                if ( lava[i].Height > 0 ) {
                    if ( lava[i].Type == 88 || lava[i].Type == 77 ) {
                        lava[i].Height = lava[i].Height - lava[i].speed / AvFrame * 40;
                    } else {
                        lava[i].Height = lava[i].Height - lava[i].speed / AvFrame * 100;
                    }
                    if ( lava[i].Height < 0 ) { lava[i].Height = 0; }
                } else {
                    lava[i].Height = 0;
                
                    T = BallZ(lava[i].x, lava[i].y);
                    if ( T < wl ) { lava[i].Type = 0; }
                    XX = lava[i].x;
                    YY = lava[i].y;
                    
                    for (loopx = -1; loopx <= 1; loopx++) {
                        for (loopy = -1; loopy <= 1; loopy++) {
                            W = BallZ(lava[i].x - lava[i].speed * loopx / AvFrame * 20, lava[i].y - lava[i].speed * loopy / AvFrame * 20);
                            if ( Rnd() * 200 == 1 ) {
                                //block(lava[i].x - lava[i].speed * loopx / AvFrame * 20, lava[i].y - lava[i].speed * loopy / AvFrame * 20) = block(XX, YY) - 0.05;s
                                _block[Int(lava[i].x - lava[i].speed * loopx / AvFrame * 20+25)][Int(lava[i].y - lava[i].speed * loopy / AvFrame * 20+25)] = _block[Int(XX)+25][Int(YY)+25] - 0.05;
                            }
                            if ( W < T ) {
                                XX = lava[i].x - lava[i].speed * loopx / AvFrame * 20;
                                YY = lava[i].y - lava[i].speed * loopy / AvFrame * 20;
                                T = W;
                            }
                        }; //Next loopy
                    }; //Next loopx
                    
                    W = T;
                    
                    if ( lava[i].Type == 88 || lava[i].Type == 77 ) {
                        if ( Elev(XX, YY) > 0 ) {
                        } else if ( doodad(XX, YY) > 0 && doodad(XX, YY) < 100 ) {
                        } else {
                            lava[i].x = XX;
                            lava[i].y = YY;
                        }
                    } else {
                        if ( XX == lava[i].x && YY == lava[i].y ) { lava[i].Type = 0; }
                        lava[i].x = XX;
                        lava[i].y = YY;
                        
                        if ( Elev(XX, YY) > 0 ) { lava[i].Type = 0; }
                        if ( doodad(XX, YY) > 0 && doodad(XX, YY) < 100 ) { lava[i].Type = 0; }
                    }
                    if ( Done[Int(XX)+25][Int(YY)+25] == false ) { lava[i].Type = 0; }
                }
            } else {
                PolyX[i].Type = 99;
            }
            if ( (lava[i].Type == 1 || lava[i].Type == 88 || lava[i].Type == 77) && Done[Int(lava[i].x)+25][Int(lava[i].y)+25] == true ) {
                
                hh = dist(lava[i].x, MX,lava[i].y, MY) * Colup; //' / 2  //' / 2
                //'if hh < 1.4 then hh = 1.4
                if ( hh < 1.4 ) { hh = 1.4; }
                PolyX[i].x[0] = lava[i].x;
                PolyX[i].y[0] = lava[i].y;
                PolyX[i].z[0] = BallZ(lava[i].x, lava[i].y) + lava[i].Height;
                PolyX[i].Colour = Disy(lava[i].Color, hh); //'
                PolyX[i].Type = 3;
                if ( lava[i].Type == 88 ) {
                    PolyX[i].size = 8;
                } else if ( lava[i].Type == 77 ) {
                    PolyX[i].size = 2;
                    PolyX[i].Type = 77;
                } else {
                    PolyX[i].size = 0.4;
                }
            } else {
                PolyX[i].Type = 99;
            }
            i = i + 1;
        } catch(e) {
            i = i + 1;
        }
	}

	if ( NxtDad > 1 ) {
		while (lava[NxtDad - 1].Type == 0 && NxtDad > 1) {
			NxtDad = NxtDad - 1;
		}
	}
    fill(RGB(255,255,255));
    //text ("Christopher Rhys Jones" + (Rr) + "," + RX + "," + RY + "," + PX + "," + PY+ "," + PZ, 0, height - 50);
}
var Check8Value = 0;
function mkdad(i = 0, j = 0, hh = 0) { //xAs Double)
	//Randomize
	var x = 0; //xAs Double
	var y = 0; //xAs Double
	var k = 0; //xAs Long
	var l = 0; //xAs Double
	var CurH = 0; //xAs Long
	var Ovr = 0; //xAs Long
	var GX = 0; //xAs Double
	var GY = 0; //xAs Double
	var GZ = 0; //xAs Double
	var Rr = 0; //xAs Long
	var GenCol = 0; //xAs Long
	var size = 0; //xAs Double
	var Dist = 0; //xAs Long
	var radorxki = 0; //xAs Long
	x = i
	y = j
	

	hh = hh / 2

	if (Cond == 0 || Cond == 4) {
		GenCol = RGB(0, 255 / hh, 50 / hh)
	} else if (Cond == 1) {
		GenCol = RGB(0, 255 / hh, 155 / hh)
	} else if (Cond == 2) {
		GenCol = RGB(155 / hh, 255 / hh, 50 / hh)
	} else if (Cond == 3) {
		GenCol = 0 //'RGB(155 / hh, 255 / hh, 50 / hh)
	}

	var dad = _doodad[i+25][j+25];
	if (dad == 1) {
		DrawCar((i + 0.5), (j + 0.5), 0);
	} else if (dad == 2) {
		DrawPlane((i + 0.5), (j + 0.5), BallZ(i + 0.5, j + 0.5), 0);
		
	} else if (dad == 5) { //'tree
		
		if ( Check8Value == 1 ) {
			PolyX[LineAt].x[0] = i + 0.5;
			PolyX[LineAt].y[0] = j + 0.5;
			PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5);
			PolyX[LineAt].Colour = RGB(155 / hh, 100 / hh, 50 / hh);
			PolyX[LineAt].Type = 21;
			PolyX[LineAt].size = 15;
			LineAt = LineAt + 1;
		} else {
			if ( Cond != 2 ) {
				PolyX[LineAt].x[0] = i + 0.5;
				PolyX[LineAt].y[0] = j + 1.2;
				PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 1.2) + 1.5;
				PolyX[LineAt].Colour = GenCol;
				PolyX[LineAt].Type = 3;
				PolyX[LineAt].size = 5;
				LineAt = LineAt + 1;
				
				PolyX[LineAt].x[0] = i + 0.5;
				PolyX[LineAt].y[0] = j + 0.5;
				PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 2;
				PolyX[LineAt].Colour = GenCol;
				PolyX[LineAt].Type = 3;
				PolyX[LineAt].size = 10;
				LineAt = LineAt + 1;
			}
			
			PolyX[LineAt].x[0] = i + 0.5;
			PolyX[LineAt].y[0] = j + 1.2;
			PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 1.2) + 1.5;
			PolyX[LineAt].x[1] = i + 0.5;
			PolyX[LineAt].y[1] = j + 0.5;
			PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5) + 0.7;
			PolyX[LineAt].Colour = RGB(155 / hh, 100 / hh, 50 / hh);
			PolyX[LineAt].Type = 5;
			PolyX[LineAt].size = 30;
			LineAt = LineAt + 1;
			
			PolyX[LineAt].x[0] = i + 0.5;
			PolyX[LineAt].y[0] = j + 0.5;
			PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5);
			PolyX[LineAt].x[1] = i + 0.5;
			PolyX[LineAt].y[1] = j + 0.5;
			PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5) + 2;
			PolyX[LineAt].Colour = RGB(155 / hh, 100 / hh, 50 / hh);
			PolyX[LineAt].Type = 5;
			PolyX[LineAt].size = 40;
			LineAt = LineAt + 1;
		}
	} else if (dad == 6) { //'tree
	
		if ( Check8Value == 1 ) {
			PolyX[LineAt].x[0] = i + 0.5;
			PolyX[LineAt].y[0] = j + 0.5;
			PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5);
			PolyX[LineAt].Colour = RGB(155 / hh, 100 / hh, 50 / hh);
			PolyX[LineAt].Type = 22;
			PolyX[LineAt].size = 10;
			LineAt = LineAt + 1;
		} else {
			if ( Cond == 2 ) {
				PolyX[LineAt].x[0] = i + 0.5;
				PolyX[LineAt].y[0] = j + 0.5;
				PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5);
				PolyX[LineAt].x[1] = i + 0.5;
				PolyX[LineAt].y[1] = j + 0.5;
				PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5) + 1;
				PolyX[LineAt].Colour = RGB(155 / hh, 255 / hh, 50 / hh);
				PolyX[LineAt].Type = 5;
				PolyX[LineAt].size = 40;
				LineAt = LineAt + 1;
			} else {
				PolyX[LineAt].x[0] = i + 0.5;
				PolyX[LineAt].y[0] = j + 0.5;
				PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 1;
				PolyX[LineAt].Colour = GenCol;
				PolyX[LineAt].Type = 3;
				PolyX[LineAt].size = 7;
				LineAt = LineAt + 1;
				
				PolyX[LineAt].x[0] = i + 0.5;
				PolyX[LineAt].y[0] = j + 0.5;
				PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5);
				PolyX[LineAt].x[1] = i + 0.5;
				PolyX[LineAt].y[1] = j + 0.5;
				PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5) + 1;
				PolyX[LineAt].Colour = RGB(155 / hh, 100 / hh, 50 / hh);
				PolyX[LineAt].Type = 5;
				PolyX[LineAt].size = 40;
				LineAt = LineAt + 1;
			}
		}
	} else if (dad == 7) { //'tree
		if ( Check8Value == 1 ) {
			PolyX[LineAt].x[0] = i + 0.5;
			PolyX[LineAt].y[0] = j + 0.5;
			PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5);
			PolyX[LineAt].Colour = RGB(155 / hh, 100 / hh, 50 / hh);
			PolyX[LineAt].Type = 23;
			PolyX[LineAt].size = 10;
			LineAt = LineAt + 1;
		} else {
			PolyX[LineAt].x[0] = i + 0.5;
			PolyX[LineAt].y[0] = j + 0.5;
			PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5);
			PolyX[LineAt].x[1] = i + 0.5;
			PolyX[LineAt].y[1] = j + 0.5;
			PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5) + 0.5;
			PolyX[LineAt].Colour = RGB(155 / hh, 100 / hh, 50 / hh);
			PolyX[LineAt].Type = 5;
			PolyX[LineAt].size = 40;
			LineAt = LineAt + 1;
			
			if ( Cond != 2 ) {
				PolyX[LineAt].x[0] = i + 0.5;
				PolyX[LineAt].y[0] = j + 0.7;
				PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 1.3;
				PolyX[LineAt].x[1] = i + 0.5;
				PolyX[LineAt].y[1] = j + 0.5;
				PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5) + 0.5;
				PolyX[LineAt].Colour = GenCol;
				PolyX[LineAt].Type = 5;
				PolyX[LineAt].size = 18;
				LineAt = LineAt + 1;
				
				PolyX[LineAt].x[0] = i + 0.2;
				PolyX[LineAt].y[0] = j + 0.3;
				PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 1.6;
				PolyX[LineAt].x[1] = i + 0.5;
				PolyX[LineAt].y[1] = j + 0.5;
				PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5) + 0.5;
				PolyX[LineAt].Colour = GenCol;
				PolyX[LineAt].Type = 5;
				PolyX[LineAt].size = 7;
				LineAt = LineAt + 1;
				
				PolyX[LineAt].x[0] = i + 0.8;
				PolyX[LineAt].y[0] = j + 0.4;
				PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 1.5;
				PolyX[LineAt].x[1] = i + 0.5;
				PolyX[LineAt].y[1] = j + 0.5;
				PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5) + 0.4;
				PolyX[LineAt].Colour = GenCol;
				PolyX[LineAt].Type = 5;
				PolyX[LineAt].size = 12;
				LineAt = LineAt + 1;
				
				PolyX[LineAt].x[0] = i + 0.6;
				PolyX[LineAt].y[0] = j + 0.1;
				PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 0.7;
				PolyX[LineAt].x[1] = i + 0.5;
				PolyX[LineAt].y[1] = j + 0.5;
				PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5) + 0.3;
				PolyX[LineAt].Colour = GenCol;
				PolyX[LineAt].Type = 5;
				PolyX[LineAt].size = 10;
				LineAt = LineAt + 1;
				
				PolyX[LineAt].x[0] = i + 0.9;
				PolyX[LineAt].y[0] = j + 0.1;
				PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 0.9;
				PolyX[LineAt].x[1] = i + 0.5;
				PolyX[LineAt].y[1] = j + 0.5;
				PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5) + 0.3;
				PolyX[LineAt].Colour = GenCol;
				PolyX[LineAt].Type = 5;
				PolyX[LineAt].size = 15;
				LineAt = LineAt + 1;
				
				PolyX[LineAt].x[0] = i + 0.7;
				PolyX[LineAt].y[0] = j + 0.6;
				PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 1.8;
				PolyX[LineAt].x[1] = i + 0.5;
				PolyX[LineAt].y[1] = j + 0.5;
				PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5) + 0.2;
				PolyX[LineAt].Colour = GenCol;
				PolyX[LineAt].Type = 5;
				PolyX[LineAt].size = 5;
				LineAt = LineAt + 1;
			}
		}
	} else if (dad == 8) { //'tree
		if ( Check8Value == 1 ) {
			PolyX[LineAt].x[0] = i + 0.5;
			PolyX[LineAt].y[0] = j + 0.5;
			PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5);
			PolyX[LineAt].Colour = RGB(155 / hh, 100 / hh, 50 / hh);
			PolyX[LineAt].Type = 24;
			PolyX[LineAt].size = 10;
			LineAt = LineAt + 1;
		} else {
			PolyX[LineAt].x[0] = i + 0.5;
			PolyX[LineAt].y[0] = j + 0.7;
			PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 1.3;
			PolyX[LineAt].x[1] = i + 0.5;
			PolyX[LineAt].y[1] = j + 0.5;
			PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5);
			PolyX[LineAt].Colour = GenCol;
			PolyX[LineAt].Type = 5;
			PolyX[LineAt].size = 18;
			LineAt = LineAt + 1;
			
			PolyX[LineAt].x[0] = i + 0.1;
			PolyX[LineAt].y[0] = j + 0.2;
			PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 1.6;
			PolyX[LineAt].x[1] = i + 0.5;
			PolyX[LineAt].y[1] = j + 0.5;
			PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5);
			PolyX[LineAt].Colour = GenCol;
			PolyX[LineAt].Type = 5;
			PolyX[LineAt].size = 21;
			LineAt = LineAt + 1;
			
			PolyX[LineAt].x[0] = i + 0.6;
			PolyX[LineAt].y[0] = j + 0.4;
			PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 1.1;
			PolyX[LineAt].x[1] = i + 0.5;
			PolyX[LineAt].y[1] = j + 0.5;
			PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5);
			PolyX[LineAt].Colour = GenCol;
			PolyX[LineAt].Type = 5;
			PolyX[LineAt].size = 14;
			LineAt = LineAt + 1;
			
			PolyX[LineAt].x[0] = i + 0.8;
			PolyX[LineAt].y[0] = j + 0.7;
			PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 0.9;
			PolyX[LineAt].x[1] = i + 0.5;
			PolyX[LineAt].y[1] = j + 0.5;
			PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5);
			PolyX[LineAt].Colour = GenCol;
			PolyX[LineAt].Type = 5;
			PolyX[LineAt].size = 9;
			LineAt = LineAt + 1;
			
			PolyX[LineAt].x[0] = i + 0.3;
			PolyX[LineAt].y[0] = j + 0.9;
			PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 0.7;
			PolyX[LineAt].x[1] = i + 0.5;
			PolyX[LineAt].y[1] = j + 0.5;
			PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5);
			PolyX[LineAt].Colour = GenCol;
			PolyX[LineAt].Type = 5;
			PolyX[LineAt].size = 18;
			LineAt = LineAt + 1;
		}
	} else if (dad == 144) { //'flame
		if ( _block[i+25][j+25] < wl ) {
			_doodad[i+25][j+25] = 0;
		} else if ( Cond == 1 ) {
			for (k = 0; k <= 50; k++) {
				l = Rnd() * 2;
				PolyX[LineAt].z[0] = BallZ(i + 0.5, j + 0.5) + l;
				PolyX[LineAt].x[0] = i + 0.5 - (l / 20) + Rnd() * (l / 10);
				PolyX[LineAt].y[0] = j + 0.5 - (l / 20) + Rnd() * (l / 10);
				PolyX[LineAt].Colour = RGB(55 / hh, 55 / hh, 255 / hh); //'RGB(255 / hh, 50 / hh, 255 / hh)
				PolyX[LineAt].Type = 3;
				PolyX[LineAt].size = 0.3;
				LineAt = LineAt + 1;
			}; //Next k
		} else {
			GX = 0.5;
			GY = 0.5;
			k = 255;
			size = 5;
			do {
				k = k - 1;
				if ( k < 158 ) {
					size = size - 0.8;
				} else {
					size = size + 1.5;
				}
				//'Dist = Dist - i
				//'Me.FillStyle = 0
				Dist = k * 2;
				Dist = Dist - size / 2;
				//'Me.Circle (Man(Mn).FlmX[i] + x - XX, y - Dist), size, RGB(255, 255 - (k / 2), 255 - i)
				PolyX[LineAt].x[0] = i + GX;
				PolyX[LineAt].y[0] = j + GY;
				PolyX[LineAt].z[0] = BallZ(i + 0.5, j + 0.5) + 0.6 - Dist / 1000;
				PolyX[LineAt].Colour = RGB(255, 255 - ((255 - k) / 2), k); //'RGB(255 / hh, 50 / hh, 255 / hh)
				PolyX[LineAt].Type = 3;
				PolyX[LineAt].size = size / 100;
				GX = GX - (PolyX[LineAt].size / 500) + Rnd() * (PolyX[LineAt].size / 250);
				GY = GY - (PolyX[LineAt].size / 500) + Rnd() * (PolyX[LineAt].size / 250);
				
				LineAt = LineAt + 1;
				
			} while (k > 1);
			
			if ( Cond != 3 ) {
				PolyX[LineAt].x[0] = i + 0.3;
				PolyX[LineAt].y[0] = j + 0.3;
				PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5);
				PolyX[LineAt].x[1] = i + 0.7;
				PolyX[LineAt].y[1] = j + 0.7;
				PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5);
				PolyX[LineAt].Colour = RGB(155 / hh, 100 / hh, 50 / hh);
				PolyX[LineAt].Type = 5;
				PolyX[LineAt].size = 18;
				LineAt = LineAt + 1;
				
				PolyX[LineAt].x[0] = i + 0.3;
				PolyX[LineAt].y[0] = j + 0.7;
				PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5);
				PolyX[LineAt].x[1] = i + 0.7;
				PolyX[LineAt].y[1] = j + 0.3;
				PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5);
				PolyX[LineAt].Colour = RGB(155 / hh, 100 / hh, 50 / hh);
				PolyX[LineAt].Type = 5;
				PolyX[LineAt].size = 18;
				LineAt = LineAt + 1;
			}
		}
	} else if (dad == 101 || dad == 201) {
		PolyX[LineAt].x[0] = i + 0.5;
		PolyX[LineAt].y[0] = j + 0.5;
		PolyX[LineAt].z[0] = BallZ(i + 0.5, j + 0.5);
		PolyX[LineAt].Colour = RGB(255 / hh, 50 / hh, 255 / hh);
		PolyX[LineAt].Type = 3;
		PolyX[LineAt].size = 2;
		LineAt = LineAt + 1;
		WpObj = LineAt;
	} else if (dad == 102) {
		PolyX[LineAt].x[0] = i + 0.5;
		PolyX[LineAt].y[0] = j + 0.5;
		PolyX[LineAt].z[0] = BallZ(i + 0.5, j + 0.5);
		PolyX[LineAt].Colour = RGB(255 / hh, 50 / hh, 50 / hh);
		PolyX[LineAt].Type = 3;
		PolyX[LineAt].size = 2;
		LineAt = LineAt + 1;
		WpObj = LineAt;
	} else if (dad == 103) {
		PolyX[LineAt].x[0] = i + 0.5;
		PolyX[LineAt].y[0] = j + 0.5;
		PolyX[LineAt].z[0] = BallZ(i + 0.5, j + 0.5);
		PolyX[LineAt].Colour = RGB(50 / hh, 255 / hh, 255 / hh);
		PolyX[LineAt].Type = 3;
		PolyX[LineAt].size = 2;
		LineAt = LineAt + 1;
		WpObj = LineAt;
	} else if (dad == 104 || dad == 204) {
		PolyX[LineAt].x[0] = i + 0.5;
		PolyX[LineAt].y[0] = j + 0.5;
		PolyX[LineAt].z[0] = BallZ(i + 0.5, j + 0.5);
		PolyX[LineAt].Colour = RGB(255 / hh, 255 / hh, 255 / hh);
		PolyX[LineAt].Type = 3;
		PolyX[LineAt].size = 2;
		LineAt = LineAt + 1;
		WpObj = LineAt;
	} else if (dad == 105) {
		PolyX[LineAt].x[0] = i + 0.5;
		PolyX[LineAt].y[0] = j + 0.5;
		PolyX[LineAt].z[0] = BallZ(i + 0.5, j + 0.5);
		PolyX[LineAt].Colour = RGB(255 / hh, 255 / hh, 50 / hh);
		PolyX[LineAt].Type = 3;
		PolyX[LineAt].size = 2;
		LineAt = LineAt + 1;
		WpObj = LineAt;
	} else if (dad == 106 || dad == 206) {
		PolyX[LineAt].x[0] = i + 0.5;
		PolyX[LineAt].y[0] = j + 0.5;
		PolyX[LineAt].z[0] = BallZ(i + 0.5, j + 0.5);
		PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh);
		PolyX[LineAt].Type = 3;
		PolyX[LineAt].size = 2;
		LineAt = LineAt + 1;
		WpObj = LineAt;
	} else if (dad == 209) {
		PolyX[LineAt].x[0] = i + 0.5;
		PolyX[LineAt].y[0] = j + 0.5;
		PolyX[LineAt].z[0] = BallZ(i + 0.5, j + 0.5) + 1.2;
		PolyX[LineAt].Colour = RGB(255 / hh, 255 / hh, 50 / hh);
		PolyX[LineAt].Type = 3;
		PolyX[LineAt].size = 2;
		LineAt = LineAt + 1;
		
		PolyX[LineAt].x[0] = i + 0.5;
		PolyX[LineAt].y[0] = j + 0.5;
		PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 1.2;
		PolyX[LineAt].x[1] = i + 0.5;
		PolyX[LineAt].y[1] = j + 0.5;
		PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5) + 1.5;
		PolyX[LineAt].Colour = 0; //'RGB(155 / hh, 100 / hh, 50 / hh)
		PolyX[LineAt].Type = 5;
		PolyX[LineAt].size = 4;
		LineAt = LineAt + 1;

	} else if (dad == 133) {
		
		PolyX[LineAt].x[0] = i + 0.5;
		PolyX[LineAt].y[0] = j + 0.5;
		PolyX[LineAt].z[0] = BallZ(i + 0.5, j + 0.5);
		PolyX[LineAt].x[1] = i + 0.5;
		PolyX[LineAt].y[1] = j + 0.5;
		PolyX[LineAt].z[1] = BallZ(i + 0.5, j + 0.5) + 4;
		PolyX[LineAt].Colour = RGB(255 / hh, 50 / hh, 50 / hh);
		PolyX[LineAt].Type = 5;
		PolyX[LineAt].size = 1;
		LineAt = LineAt + 1;
		
		PolyX[LineAt].x[0] = i + 0.5;
		PolyX[LineAt].y[0] = j + 0.5;
		PolyX[LineAt].z[0] = BallZ(i + 0.5, j + 0.5) + 4;
		PolyX[LineAt].Colour = RGB(255 / hh, 50 / hh, 50 / hh);
		PolyX[LineAt].Type = 3;
		PolyX[LineAt].size = 2;
		LineAt = LineAt + 1;
		


	} else if (dad == 140) {
		if ( TFreeze < 1 && Cond != 1 ) {
			Ovr = 20;
			for (k = 0; k <= NxtDad + 20; k++) {
				if ( lava[k].Type == 0 || k > NxtDad ) {
					if ( Ovr > 0 ) {
						Ovr = Ovr - 1;
						lava[k].x = x - 3 + Rnd() * 6;
						lava[k].y = y - 3 + Rnd() * 6;
						lava[k].Color = RGB(200 + Rnd() * 55, 0, 0);
						lava[k].Type = 1;
						lava[k].speed = 0.05 + Rnd() * 0.3;
						lava[k].Grav = true;
						lava[k].Height = 0;
						if ( k > NxtDad ) { NxtDad = k; }
					} else {
						lava[k] = lava[k + 1];
						lava[k + 1].Type = 0;
					}
				}
			}; //Next k
		}
	} else if (dad == 141) {
		var oktorun = true;
		
		//if ( Picture5.Visible == false && Picture6.Visible == false && Picture11.Visible == false ) { oktorun = false; }
		if ( PlayerX > 0 ) { oktorun = true; }
		if (oktorun) {
	//vv:
            
			if ( TFreeze < 1 ) {
				if ( Cond == 2 || Cond == 3 ) {
					Ovr = Rnd()*3;
					for (k = 0; k <= NxtDad + 5; k++) {
						if ( lava[k].Type == 0 || k > NxtDad ) {
							if ( Ovr > 0 ) {
								Ovr = 0;
								lava[k].x = i - 3 + Rnd() * 6;
								lava[k].y = j - 3 + Rnd() * 6;
								lava[k].Color = RGB(0, 0, 200 + Rnd() * 55);
								if ( Cond == 3 ) { lava[k].Color = RGB(200 + Rnd() * 55, 0, 0); }
								lava[k].Type = 1;
								lava[k].speed = 0.05 + Rnd() * 0.3;
								lava[k].Grav = true;
								lava[k].Height = 10;
								if ( k > NxtDad ) { NxtDad = k; }
							} else {
								lava[k] = lava[k + 1];
								lava[k + 1].Type = 0;
							}
						}
					}; //Next k
				} else {
					Ovr = 5;
					for (k = 0; k <= NxtDad + 5; k++) {
						if ( lava[k].Type == 0 || k > NxtDad ) {
							if ( Ovr > 0 ) {
								Ovr = Ovr - 1;
								lava[k].x = i - 3 + Rnd() * 6;
								lava[k].y = j - 3 + Rnd() * 6;
								lava[k].Color = RGB(0, 0, Int(200 + Rnd() * 55));
								lava[k].Type = 1;
								lava[k].speed = 0.05 + Rnd() * 0.3;
								lava[k].Grav = true;
								lava[k].Height = 10;
								if ( k > NxtDad ) { NxtDad = k; }
							} else {
								lava[k] = lava[k + 1];
								lava[k + 1].Type = 0;
							}
						}
					}; //Next k
				}
			}
		}
	} else if (dad == 180) {
		PolyX[LineAt].x[0] = i;
		PolyX[LineAt].y[0] = j;
		PolyX[LineAt].z[0] = _block[i+25][j+25] + 1.5;
		PolyX[LineAt].x[1] = i + 1;
		PolyX[LineAt].y[1] = j;
		PolyX[LineAt].z[1] = block(i + 1, j) + 1.5;
		PolyX[LineAt].x[2] = i + 1;
		PolyX[LineAt].y[2] = j + 1;
		PolyX[LineAt].z[2] = block(i + 1, j + 1) + 1.5;
		PolyX[LineAt].x[3] = i;
		PolyX[LineAt].y[3] = j + 1;
		PolyX[LineAt].z[3] = block(i, j + 1) + 1.5;
		//'PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh)
		PolyX[LineAt].Colour = RGB(200 / hh, 200 / hh, 120 / hh);
		PolyX[LineAt].Type = 2;
		PolyX[LineAt].size = 0.1;
		LineAt = LineAt + 1;
		
	} else if (dad == 181) {
		PolyX[LineAt].x[0] = i;
		PolyX[LineAt].y[0] = j;
		PolyX[LineAt].z[0] = _block[i+25][j+25] + 1.5;
		PolyX[LineAt].x[1] = i + 1;
		PolyX[LineAt].y[1] = j;
		PolyX[LineAt].z[1] = block(i + 1, j) + 1.5;
		PolyX[LineAt].x[2] = i + 1;
		PolyX[LineAt].y[2] = j + 1;
		PolyX[LineAt].z[2] = block(i + 1, j + 1) + 1.5;
		PolyX[LineAt].x[3] = i;
		PolyX[LineAt].y[3] = j + 1;
		PolyX[LineAt].z[3] = block(i, j + 1) + 1.5;
		//'PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh)
		PolyX[LineAt].Colour = RGB(200 / hh, 200 / hh, 120 / hh);
		PolyX[LineAt].Type = 2;
		PolyX[LineAt].size = 0.1;
		LineAt = LineAt + 1;
		
		PolyX[LineAt].x[0] = i;
		PolyX[LineAt].y[0] = j;
		PolyX[LineAt].z[0] = _block[i+25][j+25] + 3;
		PolyX[LineAt].x[1] = i + 1;
		PolyX[LineAt].y[1] = j;
		PolyX[LineAt].z[1] = block(i + 1, j) + 3;
		PolyX[LineAt].x[2] = i + 1;
		PolyX[LineAt].y[2] = j + 1;
		PolyX[LineAt].z[2] = block(i + 1, j + 1) + 3;
		PolyX[LineAt].x[3] = i;
		PolyX[LineAt].y[3] = j + 1;
		PolyX[LineAt].z[3] = block(i, j + 1) + 3;
		//'PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh)
		PolyX[LineAt].Colour = RGB(200 / hh, 200 / hh, 120 / hh);
		PolyX[LineAt].Type = 2;
		PolyX[LineAt].size = 0.1;
		LineAt = LineAt + 1;

	} else if (dad == 182) {
		PolyX[LineAt].x[0] = i;
		PolyX[LineAt].y[0] = j;
		PolyX[LineAt].z[0] = _block[i+25][j+25] + 3;
		PolyX[LineAt].x[1] = i + 1;
		PolyX[LineAt].y[1] = j;
		PolyX[LineAt].z[1] = block(i + 1, j) + 3;
		PolyX[LineAt].x[2] = i + 1;
		PolyX[LineAt].y[2] = j + 1;
		PolyX[LineAt].z[2] = block(i + 1, j + 1) + 3;
		PolyX[LineAt].x[3] = i;
		PolyX[LineAt].y[3] = j + 1;
		PolyX[LineAt].z[3] = block(i, j + 1) + 3;
		//'PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh)
		PolyX[LineAt].Colour = RGB(200 / hh, 200 / hh, 120 / hh);
		PolyX[LineAt].Type = 2;
		PolyX[LineAt].size = 0.1;
		LineAt = LineAt + 1;

	} else if (dad == 190) {
		PolyX[LineAt].x[0] = i;
		PolyX[LineAt].y[0] = j;
		PolyX[LineAt].z[0] = _block[i+25][j+25] + 0;
		PolyX[LineAt].x[1] = i + 1;
		PolyX[LineAt].y[1] = j;
		PolyX[LineAt].z[1] = block(i + 1, j) + 0;
		PolyX[LineAt].x[2] = i + 1;
		PolyX[LineAt].y[2] = j + 1;
		PolyX[LineAt].z[2] = block(i + 1, j + 1) + 1.5;
		PolyX[LineAt].x[3] = i;
		PolyX[LineAt].y[3] = j + 1;
		PolyX[LineAt].z[3] = block(i, j + 1) + 1.5;
		//'PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh)
		PolyX[LineAt].Colour = RGB(200 / hh, 120 / hh, 120 / hh);
		PolyX[LineAt].Type = 2;
		PolyX[LineAt].size = 0.1;
		LineAt = LineAt + 1;
		
	} else if (dad == 191) {
		PolyX[LineAt].x[0] = i;
		PolyX[LineAt].y[0] = j;
		PolyX[LineAt].z[0] = _block[i+25][j+25] + 1.5;
		PolyX[LineAt].x[1] = i + 1;
		PolyX[LineAt].y[1] = j;
		PolyX[LineAt].z[1] = block(i + 1, j) + 0;
		PolyX[LineAt].x[2] = i + 1;
		PolyX[LineAt].y[2] = j + 1;
		PolyX[LineAt].z[2] = block(i + 1, j + 1) + 0;
		PolyX[LineAt].x[3] = i;
		PolyX[LineAt].y[3] = j + 1;
		PolyX[LineAt].z[3] = block(i, j + 1) + 1.5;
		//'PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh)
		PolyX[LineAt].Colour = RGB(200 / hh, 120 / hh, 120 / hh);
		PolyX[LineAt].Type = 2;
		PolyX[LineAt].size = 0.1;
		LineAt = LineAt + 1;
		
	} else if (dad == 192) {
		PolyX[LineAt].x[0] = i;
		PolyX[LineAt].y[0] = j;
		PolyX[LineAt].z[0] = _block[i+25][j+25] + 1.5;
		PolyX[LineAt].x[1] = i + 1;
		PolyX[LineAt].y[1] = j;
		PolyX[LineAt].z[1] = block(i + 1, j) + 1.5;
		PolyX[LineAt].x[2] = i + 1;
		PolyX[LineAt].y[2] = j + 1;
		PolyX[LineAt].z[2] = block(i + 1, j + 1) + 0;
		PolyX[LineAt].x[3] = i;
		PolyX[LineAt].y[3] = j + 1;
		PolyX[LineAt].z[3] = block(i, j + 1) + 0;
		//'PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh)
		PolyX[LineAt].Colour = RGB(200 / hh, 120 / hh, 120 / hh);
		PolyX[LineAt].Type = 2;
		PolyX[LineAt].size = 0.1;
		LineAt = LineAt + 1;
		
	} else if (dad == 193) {
		PolyX[LineAt].x[0] = i;
		PolyX[LineAt].y[0] = j;
		PolyX[LineAt].z[0] = _block[i+25][j+25] + 0;
		PolyX[LineAt].x[1] = i + 1;
		PolyX[LineAt].y[1] = j;
		PolyX[LineAt].z[1] = block(i + 1, j) + 1.5;
		PolyX[LineAt].x[2] = i + 1;
		PolyX[LineAt].y[2] = j + 1;
		PolyX[LineAt].z[2] = block(i + 1, j + 1) + 1.5;
		PolyX[LineAt].x[3] = i;
		PolyX[LineAt].y[3] = j + 1;
		PolyX[LineAt].z[3] = block(i, j + 1) + 0;
		//'PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh)
		PolyX[LineAt].Colour = RGB(200 / hh, 120 / hh, 120 / hh);
		PolyX[LineAt].Type = 2;
		PolyX[LineAt].size = 0.1;
		LineAt = LineAt + 1;

	} else if (dad == 194) {
		PolyX[LineAt].x[0] = i;
		PolyX[LineAt].y[0] = j;
		PolyX[LineAt].z[0] = _block[i+25][j+25] + 1.5;
		PolyX[LineAt].x[1] = i + 1;
		PolyX[LineAt].y[1] = j;
		PolyX[LineAt].z[1] = block(i + 1, j) + 1.5;
		PolyX[LineAt].x[2] = i + 1;
		PolyX[LineAt].y[2] = j + 1;
		PolyX[LineAt].z[2] = block(i + 1, j + 1) + 3;
		PolyX[LineAt].x[3] = i;
		PolyX[LineAt].y[3] = j + 1;
		PolyX[LineAt].z[3] = block(i, j + 1) + 3;
		//'PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh)
		PolyX[LineAt].Colour = RGB(200 / hh, 120 / hh, 120 / hh);
		PolyX[LineAt].Type = 2;
		PolyX[LineAt].size = 0.1;
		LineAt = LineAt + 1;
		
	} else if (dad == 195) {
		PolyX[LineAt].x[0] = i;
		PolyX[LineAt].y[0] = j;
		PolyX[LineAt].z[0] = _block[i+25][j+25] + 3;
		PolyX[LineAt].x[1] = i + 1;
		PolyX[LineAt].y[1] = j;
		PolyX[LineAt].z[1] = block(i + 1, j) + 1.5;
		PolyX[LineAt].x[2] = i + 1;
		PolyX[LineAt].y[2] = j + 1;
		PolyX[LineAt].z[2] = block(i + 1, j + 1) + 1.5;
		PolyX[LineAt].x[3] = i;
		PolyX[LineAt].y[3] = j + 1;
		PolyX[LineAt].z[3] = block(i, j + 1) + 3;
		//'PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh)
		PolyX[LineAt].Colour = RGB(200 / hh, 120 / hh, 120 / hh);
		PolyX[LineAt].Type = 2;
		PolyX[LineAt].size = 0.1;
		LineAt = LineAt + 1;
		
	} else if (dad == 196) {
		PolyX[LineAt].x[0] = i;
		PolyX[LineAt].y[0] = j;
		PolyX[LineAt].z[0] = _block[i+25][j+25] + 3;
		PolyX[LineAt].x[1] = i + 1;
		PolyX[LineAt].y[1] = j;
		PolyX[LineAt].z[1] = block(i + 1, j) + 3;
		PolyX[LineAt].x[2] = i + 1;
		PolyX[LineAt].y[2] = j + 1;
		PolyX[LineAt].z[2] = block(i + 1, j + 1) + 1.5;
		PolyX[LineAt].x[3] = i;
		PolyX[LineAt].y[3] = j + 1;
		PolyX[LineAt].z[3] = block(i, j + 1) + 1.5;
		//'PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh)
		PolyX[LineAt].Colour = RGB(200 / hh, 120 / hh, 120 / hh);
		PolyX[LineAt].Type = 2;
		PolyX[LineAt].size = 0.1;
		LineAt = LineAt + 1;
		
	} else if (dad == 197) {
		PolyX[LineAt].x[0] = i;
		PolyX[LineAt].y[0] = j;
		PolyX[LineAt].z[0] = _block[i+25][j+25] + 1.5;
		PolyX[LineAt].x[1] = i + 1;
		PolyX[LineAt].y[1] = j;
		PolyX[LineAt].z[1] = block(i + 1, j) + 3;
		PolyX[LineAt].x[2] = i + 1;
		PolyX[LineAt].y[2] = j + 1;
		PolyX[LineAt].z[2] = block(i + 1, j + 1) + 3;
		PolyX[LineAt].x[3] = i;
		PolyX[LineAt].y[3] = j + 1;
		PolyX[LineAt].z[3] = block(i, j + 1) + 1.5;
		//'PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh)
		PolyX[LineAt].Colour = RGB(200 / hh, 120 / hh, 120 / hh);
		PolyX[LineAt].Type = 2;
		PolyX[LineAt].size = 0.1;
		LineAt = LineAt + 1;

	} else if (dad == 500 || dad == 501 || dad == 502 || dad == 503 || dad == 504 || dad == 505 || dad == 210) {
		PolyX[LineAt].x[0] = i + 0.5;
		PolyX[LineAt].y[0] = j + 0.5;
		PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5) + 0.5;
		PolyX[LineAt].Colour = RGB(255 / hh, 155 / hh, 155 / hh);
		PolyX[LineAt].Type = 77;
		PolyX[LineAt].size = 2;
		LineAt = LineAt + 1;
		
		PolyX[LineAt].x[0] = i + 0.5;
		PolyX[LineAt].y[0] = j + 0.5;
		PolyX[LineAt].z[0] = BallZ(x + 0.5, y + 0.5);
		PolyX[LineAt].x[1] = i + 0.5;
		PolyX[LineAt].y[1] = j + 0.5;
		PolyX[LineAt].z[1] = BallZ(x + 0.5, y + 0.5) + 0.5;
		PolyX[LineAt].Colour = RGB(255 / hh, 155 / hh, 155 / hh);
		PolyX[LineAt].Type = 5;
		PolyX[LineAt].size = 10;
		LineAt = LineAt + 1;
		
		if ( Tink == true && Int(Rnd() * (100)) == 1 ) { //6 - HScroll4Value
			x = x + 0.5;
			y = y + 0.5;
			
			Rr = CalcAngle(x - PX, y - PY);
			GX = Math.cos((180 + Rr) * 4 * Math.atan(1) / 180);
			GY = Math.sin((180 + Rr) * 4 * Math.atan(1) / 180);
			
			if ( Math.abs(PX - x) > Math.abs(PY - y) ) {
				Rr = CalcAngle((BallZ(x + 0.5, y + 0.5) + 0.5) - PZ, GX * dist(x, PX,y, PY));
                GZ = Math.cos((180 + Rr) * 4 * Math.atan(1) / 180);
			//'} else if (dad == 1
			} else {
				Rr = CalcAngle((BallZ(x + 0.5, y + 0.5) + 0.5) - PZ, GY * dist(x, PX,y, PY));
				GZ = Math.cos((180 + Rr) * 4 * Math.atan(1) / 180);
			}
			
			Bullet[NxtBlt].x[0] = x;
			Bullet[NxtBlt].y[0] = y;
			Bullet[NxtBlt].z[0] = BallZ(x + 0.5, y + 0.5) + 0.5;
			
			Bullet[NxtBlt].x[1] = GX * 2;
			Bullet[NxtBlt].y[1] = GY * 2;
			Bullet[NxtBlt].z[1] = GZ * 2;
			Bullet[NxtBlt].Type = 33;
			if ( _doodad[i+25][j+25] == 503 || (GameType > 0 && HScroll4Value > 3) ) {
				radorxki = Rnd() * 4;
				if ( radorxki != 1 ) { radorxki = 0; }
				Bullet[NxtBlt].Type = 33 + radorxki;
			}
			NxtBlt = NxtBlt + 1;
			if ( NxtBlt > 300 ) { NxtBlt = 0; }
		}
	}

	if ( _doodad[i+25][j+25] > 200 && _doodad[i+25][j+25] < 220 ) {
		PolyX[LineAt].x[0] = i;
		PolyX[LineAt].y[0] = j;
		PolyX[LineAt].z[0] = _block[i+25][j+25] + 1.5;
		PolyX[LineAt].x[1] = i + 1;
		PolyX[LineAt].y[1] = j;
		PolyX[LineAt].z[1] = block(i + 1, j) + 1.5;
		PolyX[LineAt].x[2] = i + 1;
		PolyX[LineAt].y[2] = j + 1;
		PolyX[LineAt].z[2] = block(i + 1, j + 1) + 1.5;
		PolyX[LineAt].x[3] = i;
		PolyX[LineAt].y[3] = j + 1;
		PolyX[LineAt].z[3] = block(i, j + 1) + 1.5;
		//'PolyX[LineAt].Colour = RGB(50 / hh, 50 / hh, 255 / hh)
		PolyX[LineAt].Colour = RGB(200 / hh, 200 / hh, 120 / hh);
		PolyX[LineAt].Type = 2;
		PolyX[LineAt].size = 0.1;
		LineAt = LineAt + 1;
	}
}

function DrawCar(XX = 0, YY = 0, Rot = 0) { //xAs Double)
    //On Error Resume }; //Next
	var GX = 0; //xAs Double
	var GY = 0; //xAs Double
	var i = 0; //xAs Long
	var j = 0; //xAs Long
	var k = 0; //xAs Long
	var l = 0; //xAs Double
	var V = [{"x":0,"y":0},{"x":0,"y":0},{"x":0,"y":0},{"x":0,"y":0}]; //As POINTAPI
	var Queue = new Array(31); //(0 To 30); //As Objectz
	var LAT = 0; //xAs Long
	var R1 = 0; //xAs Long
	var hi = 0; //xAs Double
	var FileFix = 0; //xAs Long
	var Swapn = false; //xAs Boolean

	for (i = 0; i <= 30; i++) {
		Queue[i] = {"x": [0,0,0,0],
                    "y": [0,0,0,0],
                    "z": [0,0,0,0],
                    "Type": 0,
                    "Colour": 0,
                    "Size": 0,
                    "Dis": 0};
	}

	var DistX = 0; //xAs Double
	var Temp = Queue[0]; //As Objectz
	var Temp2 = Queue[0]; //As Objectz
	var sz = 0; //xAs Double
		
	var Picture15 = [RGB(250,0,0), //0
					RGB(255,128,0),  //1
					RGB(250,250,0),  //2
					RGB(192,192,255),  //3
					RGB(0,0,0)]  //4

	part[0].x[0] = 0;
	part[0].y[0] = 0;
	part[0].z[0] = 0;
	part[0].x[1] = 0;
	part[0].y[1] = 1;
	part[0].z[1] = 0;
	part[0].x[2] = 0;
	part[0].y[2] = 1;
	part[0].z[2] = 0.24;
	part[0].x[3] = 0;
	part[0].y[3] = 0.05;
	part[0].z[3] = 0.15;
	part[0].Type = 1;
	part[0].Colour = Picture15[1];
	part[0].size = 0;
	part[1].x[0] = 0.5;
	part[1].y[0] = 0;
	part[1].z[0] = 0;
	part[1].x[1] = 0.5;
	part[1].y[1] = 1;
	part[1].z[1] = 0;
	part[1].x[2] = 0.5;
	part[1].y[2] = 1;
	part[1].z[2] = 0.24;
	part[1].x[3] = 0.5;
	part[1].y[3] = 0.05;
	part[1].z[3] = 0.15;
	part[1].Type = 1;
	part[1].Colour = Picture15[1];
	part[1].size = 0;
	part[2].x[0] = 0.5;
	part[2].y[0] = 0;
	part[2].z[0] = 0;
	part[2].x[1] = 0;
	part[2].y[1] = 0;
	part[2].z[1] = 0;
	part[2].x[2] = 0;
	part[2].y[2] = 0.05;
	part[2].z[2] = 0.15;
	part[2].x[3] = 0.5;
	part[2].y[3] = 0.05;
	part[2].z[3] = 0.15;
	part[2].Type = 1;
	part[2].Colour = Picture15[1];
	part[2].size = 0;
	part[3].x[0] = 0.5;
	part[3].y[0] = 1;
	part[3].z[0] = 0;
	part[3].x[1] = 0;
	part[3].y[1] = 1;
	part[3].z[1] = 0;
	part[3].x[2] = 0;
	part[3].y[2] = 1;
	part[3].z[2] = 0.24;
	part[3].x[3] = 0.5;
	part[3].y[3] = 1;
	part[3].z[3] = 0.24;
	part[3].Type = 1;
	part[3].Colour = Picture15[1];
	part[3].size = 0;
	part[4].x[0] = 0;
	part[4].y[0] = 0.2;
	part[4].z[0] = 0;
	part[4].x[1] = 0;
	part[4].y[1] = 0;
	part[4].z[1] = 0;
	part[4].x[2] = 0;
	part[4].y[2] = 0;
	part[4].z[2] = 0;
	part[4].x[3] = 0;
	part[4].y[3] = 0;
	part[4].z[3] = 0;
	part[4].Type = 3;
	part[4].Colour = Picture15[0];
	part[4].size = 1;
	part[5].x[0] = 0.5;
	part[5].y[0] = 0.2;
	part[5].z[0] = 0;
	part[5].x[1] = 0;
	part[5].y[1] = 0;
	part[5].z[1] = 0;
	part[5].x[2] = 0;
	part[5].y[2] = 0;
	part[5].z[2] = 0;
	part[5].x[3] = 0;
	part[5].y[3] = 0;
	part[5].z[3] = 0;
	part[5].Type = 3;
	part[5].Colour = Picture15[0];
	part[5].size = 1;
	part[6].x[0] = 0;
	part[6].y[0] = 0.8;
	part[6].z[0] = 0;
	part[6].x[1] = 0;
	part[6].y[1] = 0;
	part[6].z[1] = 0;
	part[6].x[2] = 0;
	part[6].y[2] = 0;
	part[6].z[2] = 0;
	part[6].x[3] = 0;
	part[6].y[3] = 0;
	part[6].z[3] = 0;
	part[6].Type = 3;
	part[6].Colour = Picture15[0];
	part[6].size = 1;
	part[7].x[0] = 0.5;
	part[7].y[0] = 0.8;
	part[7].z[0] = 0;
	part[7].x[1] = 0;
	part[7].y[1] = 0;
	part[7].z[1] = 0;
	part[7].x[2] = 0;
	part[7].y[2] = 0;
	part[7].z[2] = 0;
	part[7].x[3] = 0;
	part[7].y[3] = 0;
	part[7].z[3] = 0;
	part[7].Type = 3;
	part[7].Colour = Picture15[0];
	part[7].size = 1;


	var Check6Value = 1; //roof
	if ( Check6Value == 0 ) {
		part[9].x[0] = 0.5;
		part[9].y[0] = 1;
		part[9].z[0] = 0;
		part[9].x[1] = 0;
		part[9].y[1] = 1;
		part[9].z[1] = 0;
		part[9].x[2] = 0;
		part[9].y[2] = 1;
		part[9].z[2] = 0.24;
		part[9].x[3] = 0.5;
		part[9].y[3] = 1;
		part[9].z[3] = 0.24;
		part[9].Type = 1;
		part[9].Colour = Picture15[1];
		part[9].size = 0;
		
		part[10].x[0] = 0.5;
		part[10].y[0] = 0.7;
		part[10].z[0] = 0.35;
		part[10].x[1] = 0;
		part[10].y[1] = 0.7;
		part[10].z[1] = 0.35;
		part[10].x[2] = 0;
		part[10].y[2] = 1;
		part[10].z[2] = 0.24;
		part[10].x[3] = 0.5;
		part[10].y[3] = 1;
		part[10].z[3] = 0.24;
		part[10].Type = 1;
		part[10].Colour = Picture15[2];
		part[10].size = 0;
		
		part[11].x[0] = 0.5;
		part[11].y[0] = 0.35;
		part[11].z[0] = 0.35;
		part[11].x[1] = 0.5;
		part[11].y[1] = 0.7;
		part[11].z[1] = 0.35;
		part[11].x[2] = 0.5;
		part[11].y[2] = 1;
		part[11].z[2] = 0.24;
		part[11].x[3] = 0.5;
		part[11].y[3] = 0.25;
		part[11].z[3] = 0.16;
		part[11].Type = 1;
		part[11].Colour = Picture15[1];
		part[11].size = 0;
		part[12].x[0] = 0.5;
		part[12].y[0] = 0.25;
		part[12].z[0] = 0.16;
		part[12].x[1] = 4.16740210049116E-19;
		part[12].y[1] = 0.25;
		part[12].z[1] = 0.16;
		part[12].x[2] = 0;
		part[12].y[2] = 0.05;
		part[12].z[2] = 0.15;
		part[12].x[3] = 0.5;
		part[12].y[3] = 0.05;
		part[12].z[3] = 0.15;
		part[12].Type = 1;
		part[12].Colour = Picture15[2];
		part[12].size = 0;
		part[13].x[0] = 0.5;
		part[13].y[0] = 0.7;
		part[13].z[0] = 0.35;
		part[13].x[1] = 0;
		part[13].y[1] = 0.7;
		part[13].z[1] = 0.35;
		part[13].x[2] = 0;
		part[13].y[2] = 0.35;
		part[13].z[2] = 0.35;
		part[13].x[3] = 0.5;
		part[13].y[3] = 0.35;
		part[13].z[3] = 0.35;
		part[13].Type = 1;
		part[13].Colour = Picture15[2];
		part[13].size = 0;
		
		part[8].x[0] = 0;
		part[8].y[0] = 0.35;
		part[8].z[0] = 0.35;
		part[8].x[1] = 0;
		part[8].y[1] = 0.7;
		part[8].z[1] = 0.35;
		part[8].x[2] = 0;
		part[8].y[2] = 1;
		part[8].z[2] = 0.24;
		part[8].x[3] = 0;
		part[8].y[3] = 0.25;
		part[8].z[3] = 0.16;
		part[8].Type = 1;
		part[8].Colour = Picture15[1];
		part[8].size = 0;
		
		part[14].x[0] = 0.5;
		part[14].y[0] = 0.25;
		part[14].z[0] = 0.16;
		part[14].x[1] = 4.16740210049116E-19;
		part[14].y[1] = 0.25;
		part[14].z[1] = 0.16;
		part[14].x[2] = 0;
		part[14].y[2] = 0.35;
		part[14].z[2] = 0.35;
		part[14].x[3] = 0.5;
		part[14].y[3] = 0.35;
		part[14].z[3] = 0.35;
		part[14].Type = 1;
		part[14].Colour = Picture15[3];
		part[14].size = 0;
		FileFix = 15;
	} else {
		
		part[9].x[0] = 0;
		part[9].y[0] = 0;
		part[9].z[0] = 0.02;
		part[9].x[1] = 0.5;
		part[9].y[1] = 0;
		part[9].z[1] = 0.02;
		part[9].x[2] = 0.5;
		part[9].y[2] = 1;
		part[9].z[2] = 0.02;
		part[9].x[3] = 0;
		part[9].y[3] = 1;
		part[9].z[3] = 0.02;
		part[9].Type = 1;
		part[9].Colour = Picture15[1];
		part[9].size = 0;
		
		part[10].x[0] = 0;
		part[10].y[0] = 0.31;
		part[10].z[0] = 0.27;
		part[10].x[1] = 0;
		part[10].y[1] = 0.68;
		part[10].z[1] = 0.29;
		part[10].x[2] = 0;
		part[10].y[2] = 1;
		part[10].z[2] = 0.24;
		part[10].x[3] = 0;
		part[10].y[3] = 0.25;
		part[10].z[3] = 0.16;
		part[10].Type = 1;
		part[10].Colour = Picture15[1];
		part[10].size = 0;
		//'Part[11].Type = 0
		part[11].x[0] = 0.5;
		part[11].y[0] = 0.33;
		part[11].z[0] = 0.29;
		part[11].x[1] = 0.5;
		part[11].y[1] = 0.7;
		part[11].z[1] = 0.27;
		part[11].x[2] = 0.5;
		part[11].y[2] = 1;
		part[11].z[2] = 0.24;
		part[11].x[3] = 0.5;
		part[11].y[3] = 0.25;
		part[11].z[3] = 0.16;
		part[11].Type = 1;
		part[11].Colour = Picture15[1];
		part[11].size = 0;
		
		part[8].x[0] = 0.5;
		part[8].y[0] = 0.25;
		part[8].z[0] = 0.16;
		part[8].x[1] = 4.16740210049116E-19;
		part[8].y[1] = 0.25;
		part[8].z[1] = 0.16;
		part[8].x[2] = 0;
		part[8].y[2] = 0.05;
		part[8].z[2] = 0.15;
		part[8].x[3] = 0.5;
		part[8].y[3] = 0.05;
		part[8].z[3] = 0.15;
		part[8].Type = 1;
		part[8].Colour = Picture15[2];
		part[8].size = 0;
		
		part[12].x[0] = 0.5;
		part[12].y[0] = 0.25;
		part[12].z[0] = 0.16;
		part[12].x[1] = 4.16740210049116E-19;
		part[12].y[1] = 0.25;
		part[12].z[1] = 0.16;
		part[12].x[2] = 0;
		part[12].y[2] = 0.35;
		part[12].z[2] = 0.35;
		part[12].x[3] = 0.5;
		part[12].y[3] = 0.35;
		part[12].z[3] = 0.35;
		part[12].Type = 1;
		part[12].Colour = Picture15[3];
		part[12].size = 0;
		FileFix = 12;
	}

	for (i = 0; i <= FileFix; i++) {
		for (j = 0; j <= 3; j++) {
			part[i].x[j] = (part[i].x[j] - 0.25);
			part[i].y[j] = (part[i].y[j] - 0.5);
			R1 = -Rot + CalcAngle(part[i].x[j], part[i].y[j]) + 180;
			GX = Math.cos(R1 * 4 * Math.atan(1) / 180) * dist(part[i].x[j],0,part[i].y[j],0)
			GY = Math.sin(R1 * 4 * Math.atan(1) / 180) * dist(part[i].x[j],0,part[i].y[j],0)
			part[i].x[j] = GX;
			part[i].y[j] = GY;
			part[i].x[j] = part[i].x[j] + XX;
			part[i].y[j] = part[i].y[j] + YY;
			part[i].z[j] = part[i].z[j] + BallZ(XX, YY);
		}; //Next j
		DistX = size * 3;
		//var averagexx = Avge[i];
        if (part[i].Type == 4) {
            DistX = dist(MX, (part[i].x[0] + part[i].x[1] + part[i].x[2] + part[i].x[3])/4,MY, (part[i].y[0] + part[i].y[1] + part[i].y[2] + part[i].y[3])/4)
            DistX = dist(0,DistX,MZ + 0.5, (part[i].z[0] + part[i].z[1] + part[i].z[2] + part[i].z[3])/4)
        } else {
            DistX = dist(MX, part[i].x[0],MY, part[i].y[0])
            DistX = dist(0,DistX,MZ + 0.5, part[i].z[0])
        }
		//End With
		//'Part[i].Type = 1
		part[i].Dis = DistX;
		Swapn = false;
		for (j = 0; j <= LAT; j++) {
			if ( Swapn == true ) {
				Temp2 = Queue[j];
				Queue[j] = Temp;
				Temp = Temp2;
			} else if ( DistX > Queue[j].Dis || j == LAT ) {
				Temp = Queue[j];
				Swapn = true;
				Queue[j] = part[i];
			}
		}; //Next j
		LAT = LAT + 1;
		Temp.Type = 0;
	}; //Next i

	hi = dist(XX, MX,YY, MY) * 0.5 * Colup;
	if ( Surf == true ) {
		i = FileFix;
		while (i >= 0) {
			for (j = 0; j <= 3; j++) {
				PolyX[LineAt].x[j] = Queue[i].x[j];
				PolyX[LineAt].y[j] = Queue[i].y[j];
				PolyX[LineAt].z[j] = Queue[i].z[j];
			}; //Next j
			PolyX[LineAt].Colour = Disy(Queue[i].Colour, hi);
            //PolyX[LineAt].Colour = Queue[i].Colour;
            //PolyX[LineAt].Colour = RGB(255,0,0); //'
			PolyX[LineAt].size = Queue[i].size;
			if (Queue[i].Type == 1) {
				PolyX[LineAt].Type = 2;
			} else if (Queue[i].Type == 2) {
				PolyX[LineAt].Type = 1;
			} else if (Queue[i].Type == 3) {
				PolyX[LineAt].Type = 3;
			}
			LineAt = LineAt + 1;
			i = i - 1;
		}
	} else {
		for (i = 0; i <= FileFix; i++) {
            try {
                var drawit = true;
                for (j = 0; j <= 3; j++) {
                    var d3d = To3D((Queue[i].x[j] - MX)*100, (Queue[i].y[j] - MY)*100, (Queue[i].z[j] - MZ)*100);
                    V[j].x = d3d.x ; //' * 3
                    V[j].y = d3d.y ; //' * 3
                    if ( j == 0 ) { sz = d3d.size*1.5; }
                    if ( V[j].x == 0 && V[j].y == 0 ) { drawit = false; }
                }; //Next j
                if (drawit) {
                    //Me.FillColor = Disy(Queue[i].Colour, hi) //' / Colup
                    //Me.ForeColor = Disy(Queue[i].Colour, hi) //' / Colup
                    fill(Disy(Queue[i].Colour, hi));
                    if ( Queue[i].Type == 3 ) {
                        //ellipse(V[0].x - sz * Queue[i].size/2 , V[0].y - sz * Queue[i].size/2 , sz * Queue[i].size);
                        if ( sz > 20) {sz = 20}
                        ellipse(V[0].x - sz , V[0].y - sz , sz);
                    } else if ( Queue[i].Type == 2 ) {
                        //Me.DrawWidth = sz * Queue[i].size
                        line(V[0].x , V[0].y ,V[1].x , V[1].y , Disy(Queue[i].Colour, hi));
                        //Me.DrawWidth = 0
                    } else {
                        //Polygon Me.hDC, V[0], 4
                        quad(V[0].x,V[0].y,V[1].x,V[1].y,V[2].x,V[2].y,V[3].x,V[3].y);
                    }
                }
            } catch (e) {
            }
		}; //Next i
	}
}


function DrawPlane(XX = 0, YY = 0, ZZ = 0, Rot = 0) {
    //On Error Resume }; //Next
	var GX = 0; //xAs Double
	var GY = 0; //xAs Double
	var i = 0; //xAs Long
	var j = 0; //xAs Long
	var k = 0; //xAs Long
	var l = 0; //xAs Double
	var V = [{"x":0,"y":0},{"x":0,"y":0},{"x":0,"y":0},{"x":0,"y":0}]; //As POINTAPI
	var Queue = new Array(31); //(0 To 30); //As Objectz
	var LAT = 0; //xAs Long
	var R1 = 0; //xAs Long
	var hi = 0; //xAs Double
	var FileFix = 0; //xAs Long
	var Swapn = false; //xAs Boolean

	for (i = 0; i <= 30; i++) {
		Queue[i] = {"x": [0,0,0,0],
                    "y": [0,0,0,0],
                    "z": [0,0,0,0],
                    "Type": 0,
                    "Colour": 0,
                    "Size": 0,
                    "Dis": 0};
	}

	var DistX = 0; //xAs Double
	var Temp = Queue[0]; //As Objectz
	var Temp2 = Queue[0]; //As Objectz
	var sz = 0; //xAs Double
		
	var Picture15 = [RGB(250,0,0), //0
					RGB(255,128,0),  //1
					RGB(250,250,0),  //2
					RGB(192,192,255),  //3
					RGB(0,0,0)]  //4


    part[0].x[0] = 0.26
    part[0].y[0] = -0.02
    part[0].z[0] = -4.16740210049116E-19
    part[0].x[1] = 0
    part[0].y[1] = 1
    part[0].z[1] = 0
    part[0].x[2] = 0
    part[0].y[2] = 1
    part[0].z[2] = 0.24
    part[0].x[3] = 0.26
    part[0].y[3] = -0.02
    part[0].z[3] = -4.16740210049116E-19
    part[0].Type = 1
    part[0].Colour = Picture15[1]
    part[0].size = 0
    part[1].x[0] = 0.26
    part[1].y[0] = -0.02
    part[1].z[0] = -4.16740210049116E-19
    part[1].x[1] = 0.5
    part[1].y[1] = 1
    part[1].z[1] = -4.16740210049116E-19
    part[1].x[2] = 0.5
    part[1].y[2] = 1
    part[1].z[2] = 0.24
    part[1].x[3] = 0.26
    part[1].y[3] = -0.02
    part[1].z[3] = -4.16740210049116E-19
    part[1].Type = 1
    part[1].Colour = Picture15[1]
    part[1].size = 0
    part[2].x[0] = 0.5
    part[2].y[0] = 1
    part[2].z[0] = -4.16740210049116E-19
    part[2].x[1] = 0
    part[2].y[1] = 1
    part[2].z[1] = 0
    part[2].x[2] = 0
    part[2].y[2] = 1
    part[2].z[2] = 0.24
    part[2].x[3] = 0.5
    part[2].y[3] = 1
    part[2].z[3] = 0.24
    part[2].Type = 1
    part[2].Colour = Picture15[1]
    part[2].size = 0
    part[3].x[0] = 0.26
    part[3].y[0] = -0.02
    part[3].z[0] = -4.16740210049116E-19
    part[3].x[1] = 0
    part[3].y[1] = 1
    part[3].z[1] = 0.25
    part[3].x[2] = 0.5
    part[3].y[2] = 1
    part[3].z[2] = 0.25
    part[3].x[3] = 0.26
    part[3].y[3] = -0.02
    part[3].z[3] = -4.16740210049116E-19
    part[3].Type = 1
    part[3].Colour = Picture15[3]
    part[3].size = 0
    part[4].x[0] = 0.26
    part[4].y[0] = -0.02
    part[4].z[0] = -4.16740210049116E-19
    part[4].x[1] = -0.25
    part[4].y[1] = 1
    part[4].z[1] = 0.12
    part[4].x[2] = 0.75
    part[4].y[2] = 1
    part[4].z[2] = 0.12
    part[4].x[3] = 0.26
    part[4].y[3] = -0.02
    part[4].z[3] = -4.16740210049116E-19
    part[4].Type = 1
    part[4].Colour = Picture15[1]
    part[4].size = 0
    FileFix = 4


	for (i = 0; i <= FileFix; i++) {
		for (j = 0; j <= 3; j++) {
			part[i].x[j] = (part[i].x[j] - 0.25);
			part[i].y[j] = (part[i].y[j] - 0.5);
			R1 = -Rot + CalcAngle(part[i].x[j], part[i].y[j]) + 180;
			GX = Math.cos(R1 * 4 * Math.atan(1) / 180) * dist(part[i].x[j],0,part[i].y[j],0)
			GY = Math.sin(R1 * 4 * Math.atan(1) / 180) * dist(part[i].x[j],0,part[i].y[j],0)
			part[i].x[j] = GX;
			part[i].y[j] = GY;
			part[i].x[j] = part[i].x[j] + XX;
			part[i].y[j] = part[i].y[j] + YY;
			part[i].z[j] = part[i].z[j] + ZZ; //BallZ(XX, YY)
		}; //Next j
		DistX = size * 3;
		//var averagexx = Avge[i];
        if (part[i].Type == 4) {
            DistX = dist(MX, (part[i].x[0] + part[i].x[1] + part[i].x[2] + part[i].x[3])/4,MY, (part[i].y[0] + part[i].y[1] + part[i].y[2] + part[i].y[3])/4)
            DistX = dist(0,DistX,MZ + 0.5, (part[i].z[0] + part[i].z[1] + part[i].z[2] + part[i].z[3])/4)
        } else {
            DistX = dist(MX, part[i].x[0],MY, part[i].y[0])
            DistX = dist(0,DistX,MZ + 0.5, part[i].z[0])
        }
		//End With
		//'Part[i].Type = 1
		part[i].Dis = DistX;
		Swapn = false;
		for (j = 0; j <= LAT; j++) {
			if ( Swapn == true ) {
				Temp2 = Queue[j];
				Queue[j] = Temp;
				Temp = Temp2;
			} else if ( DistX > Queue[j].Dis || j == LAT ) {
				Temp = Queue[j];
				Swapn = true;
				Queue[j] = part[i];
			}
		}; //Next j
		LAT = LAT + 1;
		Temp.Type = 0;
	}; //Next i

	hi = dist(XX, MX,YY, MY) * 0.5 * Colup;
	if ( Surf == true ) {
		i = FileFix;
		while (i >= 0) {
			for (j = 0; j <= 3; j++) {
				PolyX[LineAt].x[j] = Queue[i].x[j];
				PolyX[LineAt].y[j] = Queue[i].y[j];
				PolyX[LineAt].z[j] = Queue[i].z[j];
			}; //Next j
			PolyX[LineAt].Colour = Disy(Queue[i].Colour, hi);
            //PolyX[LineAt].Colour = Queue[i].Colour;
            //PolyX[LineAt].Colour = RGB(255,0,0); //'
			PolyX[LineAt].size = Queue[i].size;
			if (Queue[i].Type == 1) {
				PolyX[LineAt].Type = 2;
			} else if (Queue[i].Type == 2) {
				PolyX[LineAt].Type = 1;
			} else if (Queue[i].Type == 3) {
				PolyX[LineAt].Type = 3;
			}
			LineAt = LineAt + 1;
			i = i - 1;
		}
	} else {
		for (i = 0; i <= FileFix; i++) {
            try {
                var drawit = true;
                for (j = 0; j <= 3; j++) {
                    var d3d = To3D((Queue[i].x[j] - MX)*100, (Queue[i].y[j] - MY)*100, (Queue[i].z[j] - MZ)*100);
                    V[j].x = d3d.x ; //' * 3
                    V[j].y = d3d.y ; //' * 3
                    if ( j == 0 ) { sz = d3d.size; }
                    if ( V[j].x == 0 && V[j].y == 0 ) { drawit = false; }
                }; //Next j
                if (drawit) {
                    //Me.FillColor = Disy(Queue[i].Colour, hi) //' / Colup
                    //Me.ForeColor = Disy(Queue[i].Colour, hi) //' / Colup
                    fill(Disy(Queue[i].Colour, hi));
                    if ( Queue[i].Type == 3 ) {
                        ellipse(V[0].x - sz * Queue[i].size , V[0].y - sz * Queue[i].size , sz * Queue[i].size);
                    } else if ( Queue[i].Type == 2 ) {
                        //Me.DrawWidth = sz * Queue[i].size
                        line(V[0].x , V[0].y ,V[1].x , V[1].y , Disy(Queue[i].Colour, hi));
                        //Me.DrawWidth = 0
                    } else {
                        //Polygon Me.hDC, V[0], 4
                        quad(V[0].x,V[0].y,V[1].x,V[1].y,V[2].x,V[2].y,V[3].x,V[3].y);
                    }
                }
            } catch (e) {
            }
		}; //Next i
	}
/*
*/
}
function KillInc() {
    Kills = Kills + 1;
}
/*

function DrawPlane(XX = 0; //xAs Double, YY = 0; //xAs Double, ZZ = 0; //xAs Double, Rot = 0; //xAs Double)
On Error Resume }; //Next
var GX = 0; //xAs Double
var GY = 0; //xAs Double
var i = 0; //xAs Long
var j = 0; //xAs Long
var k = 0; //xAs Long
var l = 0; //xAs Double
var V(0 To 4); //As POINTAPI
var Queue(0 To 30); //As Objectz
var LAT = 0; //xAs Long
var R1 = 0; //xAs Long
var hi = 0; //xAs Double
var FileFix = 0; //xAs Long
var Swapn = false; //xAs Boolean

var Dist = 0; //xAs Double
var Temp; //As Objectz
var Temp2; //As Objectz
var sz = 0; //xAs Double


part[0].x[0] = 0.26
part[0].y[0] = -0.02
part[0].z[0] = -4.16740210049116E-19
part[0].x[1] = 0
part[0].y[1] = 1
part[0].z[1] = 0
part[0].x[2] = 0
part[0].y[2] = 1
part[0].z[2] = 0.24
part[0].x[3] = 0.26
part[0].y[3] = -0.02
part[0].z[3] = -4.16740210049116E-19
part[0].Type = 1
part[0].Colour = Picture15[1].BackColor
part[0].size = 0
part[1].x[0] = 0.26
part[1].y[0] = -0.02
part[1].z[0] = -4.16740210049116E-19
part[1].x[1] = 0.5
part[1].y[1] = 1
part[1].z[1] = -4.16740210049116E-19
part[1].x[2] = 0.5
part[1].y[2] = 1
part[1].z[2] = 0.24
part[1].x[3] = 0.26
part[1].y[3] = -0.02
part[1].z[3] = -4.16740210049116E-19
part[1].Type = 1
part[1].Colour = Picture15[1].BackColor
part[1].size = 0
part[2].x[0] = 0.5
part[2].y[0] = 1
part[2].z[0] = -4.16740210049116E-19
part[2].x[1] = 0
part[2].y[1] = 1
part[2].z[1] = 0
part[2].x[2] = 0
part[2].y[2] = 1
part[2].z[2] = 0.24
part[2].x[3] = 0.5
part[2].y[3] = 1
part[2].z[3] = 0.24
part[2].Type = 1
part[2].Colour = Picture15[1].BackColor
part[2].size = 0
part[3].x[0] = 0.26
part[3].y[0] = -0.02
part[3].z[0] = -4.16740210049116E-19
part[3].x[1] = 0
part[3].y[1] = 1
part[3].z[1] = 0.25
part[3].x[2] = 0.5
part[3].y[2] = 1
part[3].z[2] = 0.25
part[3].x[3] = 0.26
part[3].y[3] = -0.02
part[3].z[3] = -4.16740210049116E-19
part[3].Type = 1
part[3].Colour = Picture15[3].BackColor
part[3].size = 0
part[4].x[0] = 0.26
part[4].y[0] = -0.02
part[4].z[0] = -4.16740210049116E-19
part[4].x[1] = -0.25
part[4].y[1] = 1
part[4].z[1] = 0.12
part[4].x[2] = 0.75
part[4].y[2] = 1
part[4].z[2] = 0.12
part[4].x[3] = 0.26
part[4].y[3] = -0.02
part[4].z[3] = -4.16740210049116E-19
part[4].Type = 1
part[4].Colour = Picture15[1].BackColor
part[4].size = 0
FileFix = 4


For i = 0 To FileFix
    For j = 0 To 3
        part[i].x[j] = (part[i].x[j] - 0.25)
        part[i].y[j] = (part[i].y[j] - 0.5)
        R1 = -Rot + CalcAngle(part[i].x[j], part[i].y[j]) + 180
        GX = Math.cos(R1 * 4 * Math.atan(1) / 180) * Sqr(Math.abs(part[i].x[j]) ^ 2 + Math.abs(part[i].y[j]) ^ 2)
        GY = Math.sin(R1 * 4 * Math.atan(1) / 180) * Sqr(Math.abs(part[i].x[j]) ^ 2 + Math.abs(part[i].y[j]) ^ 2)
        part[i].x[j] = GX
        part[i].y[j] = GY
        part[i].x[j] = part[i].x[j] + XX
        part[i].y[j] = part[i].y[j] + YY
        part[i].z[j] = part[i].z[j] + ZZ
    }; //Next j
    Dist = size * 3
    With Avge[i]
        Dist = Sqr(Math.abs(MX - .x) ^ 2 + Math.abs(MY - .y) ^ 2)
        Dist = Sqr(Math.abs(Dist) ^ 2 + Math.abs((MZ + 0.5) - .z) ^ 2)
    End With
    //'Part[i].Type = 1
    part[i].Dis = Dist
    Swapn = false
    For j = 0 To LAT
        if ( Swapn = true ) {
            Temp2 = Queue[j]
            Queue[j] = Temp
            Temp = Temp2
        } else if ( Dist > Queue[j].Dis || j = LAT ) {
            Temp = Queue[j]
            Swapn = true
            Queue[j] = part[i]
        }
    }; //Next j
    LAT = LAT + 1
    Temp.Type = 0
}; //Next i
Me.FillStyle = 0

hi = (Sqr(Math.abs(XX - MX) ^ 2 + Math.abs(YY - MY) ^ 2)) * 0.5 * Colup
if ( Surf = true ) {
    i = FileFix
    Do Until i < 0
        For j = 0 To 3
            PolyX[LineAt].x[j] = Queue[i].x[j]
            PolyX[LineAt].y[j] = Queue[i].y[j]
            PolyX[LineAt].z[j] = Queue[i].z[j]
        }; //Next j
        PolyX[LineAt].Colour = Disy(Queue[i].Colour, hi)
        PolyX[LineAt].size = Queue[i].size
        Select Case Queue[i].Type
        Case 1
            PolyX[LineAt].Type = 2
        Case 2
            PolyX[LineAt].Type = 1
        Case 3
            PolyX[LineAt].Type = 3
        End Select
        LineAt = LineAt + 1
        i = i - 1
    Loop
} else {
    For i = 0 To FileFix
        For j = 0 To 3
            With To3D((Queue[i].x[j] - MX) * 100, (Queue[i].y[j] - MY) * 100, (Queue[i].z[j] - MZ) * 100)
                V[j].x = .x / 15 //' * 3
                V[j].y = .y / 15 //' * 3
                if ( j = 0 ) { sz = .size
                if ( V[j].x = 0 && V[j].y = 0 ) { GoTo Ovrss
            End With
        }; //Next j
        Me.FillColor = Disy(Queue[i].Colour, hi) //' / Colup
        Me.ForeColor = Disy(Queue[i].Colour, hi) //' / Colup
        if ( Queue[i].Type = 3 ) {
            Me.Circle (V[0].x * 15, V[0].y * 15), sz * Queue[i].size
        } else if ( Queue[i].Type = 2 ) {
            Me.DrawWidth = sz * Queue[i].size
            Me.Line (V[0].x * 15, V[0].y * 15)-(V[1].x * 15, V[1].y * 15), Disy(Queue[i].Colour, hi)
            Me.DrawWidth = 0
        } else {
            Polygon Me.hDC, V[0], 4
        }
Ovrss:
    }; //Next i
}

Me.FillStyle = 1

}
function Avge(i = 0; //xAs Long); //As dubz
Select Case part[i].Type
Case 1
    Avge.x = (part[i].x[0] + part[i].x[1] + part[i].x[2] + part[i].x[3]) / 4
    Avge.y = (part[i].y[0] + part[i].y[1] + part[i].y[2] + part[i].y[3]) / 4
    Avge.z = (part[i].z[0] + part[i].z[1] + part[i].z[2] + part[i].z[3]) / 4
Case 2
    Avge.x = (part[i].x[0] + part[i].x[1]) / 2
    Avge.y = (part[i].y[0] + part[i].y[1]) / 2
    Avge.z = (part[i].z[0] + part[i].z[1]) / 2
Case 3
    Avge.x = part[i].x[0]
    Avge.y = part[i].y[0]
    Avge.z = part[i].z[0]
End Select

}
function StrNum() = ""; //xAs String
var i = 0; //xAs Double
var j = 0; //xAs Long
i = Kills
StrNum = i
For j = 0 To (4 - Len(StrNum))
    StrNum = "0" + StrNum
}; //Next j
}

function Timer2_Timer()
On Error Resume }; //Next
var j = 0; //xAs Long
var i = 0; //xAs Long
var Rep = false; //xAs Boolean
var mm = 0; //xAs Long
var txt = ""; //xAs String
var TopKills = 0; //xAs Long
var dd = 0; //xAs Long
var OldPlayer = 0; //xAs Long
var ff = 0; //xAs Double
var nsd = 0; //xAs Long //'newseed
var siki = 0; //xAs Long
var sikj = 0; //xAs Long

if ( PlayerX > 0 ) {
    //'Label1.Caption = PlayerX
    
    if ( Picture5.Visible = false ) {
        JTime = JTime + 1
        if ( JTime > 20 && JTime < 80 && Plr(PlayerX - 1).Name != Text4.Text ) {
            OldPlayer = PlayerX
            FileFish = true
            PlayerX = 0
            Command6_Click
            JTime = 0
            FileFish = false
            Open App.Path + "\Player" + (OldPlayer - 1) For Output; //As #1
                Print #1, 0
            Close #1
        }
    }
    
    if ( HitFor < 30 ) { HitFor = HitFor + 1
    
    if ( PlayerX = 1 ) {
        i = 0
        Do
            i = i + 1
            j = 0
            Open App.Path + "\Player" + i For Input; //As #1
                Input #1, j
                dd = 0
                
                if ( j = 2 ) {
                    Input #1, Plr[i].x, Plr[i].y, Plr[i].DirectX, Plr[i].DirectY, Plr[i].Fire, dd, Plr[i].Kills, Plr[i].Jump, Plr[i].Name
                    if ( dd > Plr[i].Deaths && LstHit = i && HitFor < 20 ) {
                        KillInc
                        Label14[1].Caption = "You Killed Player" + (i + 1) + ": " + Plr[i].Name
                        Label14[1].Tag = 60
                    }
                    if ( dd > Plr[i].Deaths && Weapon > 97 ) {
                        if ( Sqr(Math.abs(Plr(PlayerX - 1).x - Plr[i].LstX) ^ 2 + Math.abs(Plr(PlayerX - 1).y - Plr[i].LstY) ^ 2) < 6 ) {
                            KillInc
                            Label14[1].Caption = "You Killed Player" + (i + 1) + ": " + Plr[i].Name
                            Label14[1].Tag = 60
                        }
                    }
                    if ( dd > Plr[i].Deaths ) {
                        Label14[2].Caption = "Player" + (i + 1) + ": " + Plr[i].Name + " Died"
                        Label14[2].Tag = 60
                        
                        lava[NxtDad].x = Plr[i].LstX
                        lava[NxtDad].y = Plr[i].LstY
                        lava[NxtDad].Color = RGB(255, 155, 155)
                        lava[NxtDad].Type = 77
                        lava[NxtDad].speed = 0.04
                        lava[NxtDad].Grav = true
                        lava[NxtDad].Height = 0.5
                        
                        lava[NxtDad + 1].x = Plr[i].LstX
                        lava[NxtDad + 1].y = Plr[i].LstY
                        lava[NxtDad + 1].Color = RGB(200, 0, 0)
                        lava[NxtDad + 1].Type = 1
                        lava[NxtDad + 1].speed = 0.02 + Rnd() * 0.02
                        lava[NxtDad + 1].Grav = true
                        lava[NxtDad + 1].Height = 0.2
                        
                        lava[NxtDad + 2].x = Plr[i].LstX
                        lava[NxtDad + 2].y = Plr[i].LstY
                        lava[NxtDad + 2].Color = RGB(200, 0, 0)
                        lava[NxtDad + 2].Type = 1
                        lava[NxtDad + 2].speed = 0.02 + Rnd() * 0.02
                        lava[NxtDad + 2].Grav = true
                        lava[NxtDad + 2].Height = 0.2
                        
                        NxtDad = NxtDad + 3
                        Plr[i].Deaths = dd
                    }
                    Plr[i].LstX = Plr[i].x
                    Plr[i].LstY = Plr[i].y
                }
            Close #1
            if ( j != 2 ) {
                Plr[i].x = 0
                if ( Rep = false ) {
                    Rep = true
                } else {
                    GoTo Ovu
                }
            } else {
                Rep = false
            }
        Loop While i < 100
Ovu:
        PMax = i
        
        if ( Deaths > Plr[0].Deaths ) {
            Label14[2].Caption = "You Died"
            Label14[2].Tag = 60
        }
        
        Plr[0].x = PX
        Plr[0].y = PY
        Plr[0].DirectX = RX
        Plr[0].DirectY = RY
        Plr[0].Fire = 0
        Plr[0].Deaths = Deaths
        Plr[0].Kills = Kills
        Plr[0].Name = Text4.Text
        Plr[0].Jump = Jmp + HtInc
        if ( Fired = true || Weapon = 99 ) { Plr[0].Fire = (Weapon + 1)
        if ( Weapon = 98 ) {
            Plr[0].Fire = -(PZ - BallZ(PX, PY))
            if ( Plr[0].Fire >= 0 ) { Plr[0].Fire = -0.01
        }
        if ( (KeyDown(38) || KeyDown(87)) && Weapon = 99 ) { Plr[0].Fire = 101
        Open App.Path + "\Player0" For Output; //As #1
            Print #1, PMax
            For i = 0 To PMax - 2
                Print #1, Plr[i].x, Plr[i].y, Plr[i].DirectX, Plr[i].DirectY, Plr[i].Fire, Plr[i].Deaths, Plr[i].Jump, Plr[i].Name
                if ( Plr[i].Kills >= TopKills ) {
                    TopKills = Plr[i].Kills
                    txt = "Player" + (i + 1) + ": " + Plr[i].Name + " Is winning on " + Plr[i].Kills + " Kills"
                }
            }; //Next i
            if ( TopKills = 0 ) { txt = "Nobody is Winning"
            Print #1, Seed, Cond, txt
        Close #1
    } else {
        Open App.Path + "\Player0" For Input; //As #1
            Input #1, PMax
            For i = 0 To PMax - 2
                dd = 0
                Input #1, Plr[i].x, Plr[i].y, Plr[i].DirectX, Plr[i].DirectY, Plr[i].Fire, dd, Plr[i].Jump, Plr[i].Name
                if ( dd > Plr[i].Deaths && LstHit = i && HitFor < 20 ) {
                    KillInc
                    Label14[1].Caption = "You Killed Player" + (i + 1) + ": " + Plr[i].Name
                    Label14[1].Tag = 60
                }
                if ( dd > Plr[i].Deaths && Weapon = 99 ) {
                    if ( Sqr(Math.abs(Plr(PlayerX - 1).x - Plr[i].LstX) ^ 2 + Math.abs(Plr(PlayerX - 1).y - Plr[i].LstY) ^ 2) < 4 ) {
                        KillInc
                        
                        Label14[1].Caption = "You Killed Player" + (i + 1) + ": " + Plr[i].Name
                        Label14[1].Tag = 60
                    }
                }
                if ( dd > Plr[i].Deaths ) {
                    if ( i = (PlayerX - 1) ) {
                        Label14[2].Caption = "You Died"
                    } else {
                        Label14[2].Caption = "Player" + (i + 1) + ": " + Plr[i].Name + " Died"
                    }
                    Label14[2].Tag = 60
                    
                    lava[NxtDad].x = Plr[i].LstX
                    lava[NxtDad].y = Plr[i].LstY
                    lava[NxtDad].Color = RGB(255, 155, 155)
                    lava[NxtDad].Type = 77
                    lava[NxtDad].speed = 0.04
                    lava[NxtDad].Grav = true
                    lava[NxtDad].Height = 0.5
                    
                    lava[NxtDad + 1].x = Plr[i].LstX
                    lava[NxtDad + 1].y = Plr[i].LstY
                    lava[NxtDad + 1].Color = RGB(200, 0, 0)
                    lava[NxtDad + 1].Type = 1
                    lava[NxtDad + 1].speed = 0.02 + Rnd() * 0.02
                    lava[NxtDad + 1].Grav = true
                    lava[NxtDad + 1].Height = 0.2
                    
                    lava[NxtDad + 2].x = Plr[i].LstX
                    lava[NxtDad + 2].y = Plr[i].LstY
                    lava[NxtDad + 2].Color = RGB(200, 0, 0)
                    lava[NxtDad + 2].Type = 1
                    lava[NxtDad + 2].speed = 0.02 + Rnd() * 0.02
                    lava[NxtDad + 2].Grav = true
                    lava[NxtDad + 2].Height = 0.2
                    
                    NxtDad = NxtDad + 3
                    Plr[i].Deaths = dd
                }
                Plr[i].LstX = Plr[i].x
                Plr[i].LstY = Plr[i].y
            }; //Next i
            Input #1, nsd, Cond, txt
        Close #1
        if ( nsd != Seed && nsd != 0 ) {
            For siki = -20 To size + 20
                For sikj = -20 To size + 20
                    block(siki, sikj) = 0
                    doodad(siki, sikj) = 0
                    Elev(siki, sikj) = 0
                }; //Next sikj
            }; //Next siki
            Seed = nsd
            BuildMap
        }
        
        Open App.Path + "\Player" + (PlayerX - 1) For Output; //As #1
            Print #1, 2
            ff = 0
            mm = 0
            if ( Fired = true || Weapon = 99 ) { ff = (Weapon + 1)
            
            if ( Weapon = 99 && (KeyDown(38) || KeyDown(87)) ) { ff = 101
            if ( Weapon = 98 ) {
                ff = -(PZ - BallZ(PX, PY))
                if ( ff >= 0 ) { ff = -0.01
            }
            Print #1, PX, PY, RX, RY, ff, Deaths, Kills, (Jmp + HtInc), Text4.Text
        Close #1
        
        if ( PMax = 0 ) {
            ZPmx = ZPmx + 1
            if ( ZPmx > 5 * PlayerX ) {
                Open App.Path + "\Player" + (PlayerX - 1) For Output; //As #1
                    Print #1, 0
                Close #1
                PlayerX = 1
            }
        } else {
            ZPmx = 0
        }
        
    }
    Fired = false
}
if ( Picture5.Visible = true || Picture6.Visible = true ) {
    Open App.Path + "\Player0" For Input; //As #1
        j = 0
        Input #1, j
        if ( j = 0 ) {
            Label18.Caption = "Host"
        } else {
            Label18.Caption = "Join"
        }
    Close #1
}
Label14[0].Caption = txt
For i = 1 To 2
    if ( Int(Label14[i].Tag) <= 0 ) {
        Label14[i].Caption = ""
    } else {
        Label14[i].Tag = Label14[i].Tag - 1
    }
}; //Next i

LPX = PX
LPY = PY
LPZ = PZ

}
*/

/*
function CheckAch()
On Error Resume }; //Next
var shower = 0; //xAs Long
var i = 0; //xAs Long

shower = -1
if ( PlayerX = 0 ) {
    //'if ( GameType = 0 ) {
    //'    if ( Achieved[0] = 0 && Sqr(Math.abs(125 - MX) ^ 2 + Math.abs(125 - MY) ^ 2) < 2 && HScroll4Value > 1 ) {
    //'        shower = 0
    //'        Label16.Caption = "//'End Of The Line//': Reach the checkpoint on medium."
    //'    }
    //'    if ( Achieved[1] = 0 && Sqr(Math.abs(125 - MX) ^ 2 + Math.abs(125 - MY) ^ 2) < 5 && HScroll4Value = 4 ) {
    //'        shower = 1
    //'        Label16.Caption = "//'Fighting Blind//': Reach the checkpoint on insane."
    //'    }
    //'}
    
    if ( GameType = -5 ) {
        
        if ( Achieved(83) = 0 && Kills >= 10 ) {
            shower = 83
            Label16.Caption = "//'Novice//': Reach 10 kills  in Survival."
        }
        if ( Achieved[7] = 0 && Kills >= 15 ) {
            shower = 7
            Label16.Caption = "//'Commander//': Reach 15 kills in Survival."
        }
         if ( Achieved(84) = 0 && Kills >= 20 ) {
            shower = 84
            Label16.Caption = "//'Marine//': Reach 20 kills in Survival."
        }
        if ( Achieved(85) = 0 && Kills >= 25 ) {
            shower = 85
            Label16.Caption = "//'Specialist//': Reach 25 kills in Survival."
        }
        if ( Achieved[8] = 0 && Kills >= 30 ) {
            shower = 8
            Label16.Caption = "//'Hit Man//': Reach 30 kills in Survival."
        }
        if ( Achieved(82) = 0 && Kills >= 40 ) {
            shower = 82
            Label16.Caption = "//'Assassin//': Reach 40 kills in Survival."
        }
        if ( Achieved[9] = 0 && Kills >= 50 ) {
            shower = 9
            Label16.Caption = "//'Ninja//': Reach 50 kills in Survival."
        }
        if ( Achieved(86) = 0 && Kills >= 60 ) {
            shower = 86
            Label16.Caption = "//'Sargent//': Reach 60 kills in Survival."
        }
        if ( Achieved(87) = 0 && Kills >= 70 ) {
            shower = 87
            Label16.Caption = "//'Admiral//': Reach 70 kills in Survival."
        }
        if ( Achieved(93) = 0 && Kills >= 80 ) {
            shower = 93
            Label16.Caption = "//'Top Dog//': Reach 80 kills in Survival."
        }
        if ( Achieved(94) = 0 && Kills >= 90 ) {
            shower = 94
            Label16.Caption = "//'Insurgent//': Reach 90 kills in Survival."
        }
        if ( Achieved(95) = 0 && Kills >= 100 ) {
            shower = 95
            Label16.Caption = "//'Gun Nut//': Reach 100 kills in Survival."
        }
        if ( Achieved(96) = 0 && Kills >= 110 ) {
            shower = 96
            Label16.Caption = "//'Massacre//': Reach 110 kills in Survival."
        }
        
        //'if ( Achieved(71) = 0 && (Kills * HScroll4Value / 20) >= 5 ) {
        //'    shower = 71
        //'    Label16.Caption = "//'Learner//': Reach a score of 5 on any difficulty."
        //'}
        //'if ( Achieved(72) = 0 && (Kills * HScroll4Value / 20) >= 10 ) {
        //'    shower = 72
        //'    Label16.Caption = "//'Achiever//': Reach a score of 10 on any difficulty."
        //'}
        //'if ( Achieved(73) = 0 && (Kills * HScroll4Value / 20) >= 15 ) {
        //'    shower = 73
        //'    Label16.Caption = "//'Expert//': Reach a score of 15 on any difficulty."
        //'}
        //'if ( Achieved[10] = 0 && (Kills * HScroll4Value / 20) >= 20 ) {
        //'    shower = 10
        //'    Label16.Caption = "//'Pro Gamer//': Reach a score of 20 on any difficulty."
        //'}
    } else {
        //'if ( Achieved(71) = 0 && (Kills * HScroll4Value / 10) >= 5 ) {
        //'    shower = 71
        //'    Label16.Caption = "//'Learner//': Reach a score of 5 on any difficulty."
        //'}
        //'if ( Achieved(72) = 0 && (Kills * HScroll4Value / 10) >= 10 ) {
        //'    shower = 72
        //'    Label16.Caption = "//'Achiever//': Reach a score of 10 on any difficulty."
        //'}
        //'if ( Achieved(73) = 0 && (Kills * HScroll4Value / 10) >= 15 ) {
        //'    shower = 73
        //'    Label16.Caption = "//'Expert//': Reach a score of 15 on any difficulty."
        //'}
        //'if ( Achieved[10] = 0 && (Kills * HScroll4Value / 10) >= 20 ) {
        //'    shower = 10
        //'    Label16.Caption = "//'Pro Gamer//': Reach a score of 20 on any difficulty."
        //'}
    }
} else {
    if ( Achieved[11] = 0 && Kills >= 15 ) {
        shower = 11
        Label16.Caption = "//'Multiplayer//': Reach 15 kills in a multiplayer match."
    }
    if ( Achieved[12] = 0 && Kills >= 30 ) {
        shower = 12
        Label16.Caption = "//'Taking Off//': Reach 30 kills in a multiplayer match."
    }
    if ( Achieved[13] = 0 && Kills >= 45 ) {
        shower = 13
        Label16.Caption = "//'Piling Bodies//': Reach 45 kills in a multiplayer match."
    }
    if ( Achieved(98) = 0 && Kills >= 60 ) {
        shower = 98
        Label16.Caption = "//'Determination//': Reach 60 kills in a multiplayer match." //'
    }
    if ( Achieved(99) = 0 && Kills >= 70 ) {
        shower = 99
        Label16.Caption = "//'Solo//': Reach 70 kills in a multiplayer match." //'
    }
    if ( Achieved[14] = 0 && Kills >= 80 ) {
        shower = 14
        Label16.Caption = "//'Cheater//': Reach 80 kills in a multiplayer match."
    }
    if ( Achieved(100) = 0 && Kills >= 90 ) {
        shower = 100
        Label16.Caption = "//'Invincible//': Reach 90 kills in a multiplayer match." //'
    }
    if ( Achieved[15] = 0 && Kills >= 100 ) {
        shower = 15
        Label16.Caption = "//'Century//': Reach 100 kills in a multiplayer match."
    }
    
    i = InStr(Label14[0].Caption, " Is winning on ")
    if ( i != 0 ) {
        if ( Achieved(56) = 0 && Kills >= 10 && Kills = Int(Mid(Label14[0].Caption, i + 15, Len(Label14[0].Caption) - i - 20)) ) {
            shower = 56
            Label16.Caption = "//'Leader board//': Hold a top score over 10 in a multiplayer game"
        }
        if ( Achieved(57) = 0 && Kills >= 30 && Kills = Int(Mid(Label14[0].Caption, i + 15, Len(Label14[0].Caption) - i - 20)) ) {
            shower = 57
            Label16.Caption = "//'Best Player//': Hold a top score over 30 in a multiplayer game"
        }
        if ( Achieved(58) = 0 && Kills >= 60 && Kills = Int(Mid(Label14[0].Caption, i + 15, Len(Label14[0].Caption) - i - 20)) ) {
            shower = 58
            Label16.Caption = "//'Ownage//': Hold a top score over 60 in a multiplayer game"
        }
    }
    
    if ( Achieved(68) = 0 && Deaths > 0 && Kills >= (5 * Deaths) ) {
        shower = 68
        Label16.Caption = "//'Five to One//': Receive a kill death ratio of 5:1"
    }
    if ( Achieved(69) = 0 && Deaths > 0 && Kills >= (10 * Deaths) ) {
        shower = 69
        Label16.Caption = "//'Ten to One//': Receive a kill death ratio of 10:1"
    }
    if ( Achieved(70) = 0 && Deaths > 0 && Kills >= (15 * Deaths) ) {
        shower = 70
        Label16.Caption = "//'Fifteen to One//': Receive a kill death ratio of 15:1"
    }
    if ( Achieved(74) = 0 && Deaths > 0 && Kills >= (20 * Deaths) ) {
        shower = 74
        Label16.Caption = "//'Twenty to One//': Receive a kill death ratio of 20:1"
    }
}

//'0pistol
//'rlauncher
//'sniper
//'glauncher
//'shotgun
//'scarh
if ( Achieved(16) = 0 && WKills[0] >= 10 ) {
    shower = 16
    Label16.Caption = "//'Shooter//': Kill 10 opponents with a Pistol."
}
if ( Achieved(17) = 0 && WKills[1] >= 10 ) {
    shower = 17
    Label16.Caption = "//'Cannon//': Kill 10 opponents with a Rocket Launcher."
}
if ( Achieved(18) = 0 && WKills[2] >= 10 ) {
    shower = 18
    Label16.Caption = "//'HeadShot//': Kill 10 opponents with a Sniper."
}
if ( Achieved(19) = 0 && WKills[3] >= 10 ) {
    shower = 19
    Label16.Caption = "//'Thrower//': Kill 10 opponents with a Grenade Launcher."
}
if ( Achieved(20) = 0 && WKills[4] >= 10 ) {
    shower = 20
    Label16.Caption = "//'CloseKill//': Kill 10 opponents with a Shotgun."
}
if ( Achieved(21) = 0 && WKills[5] >= 10 ) {
    shower = 21
    Label16.Caption = "//'Assault//': Kill 10 opponents with a ScarH."
}
if ( Achieved(77) = 0 && WKills(99) >= 10 ) {
    shower = 77
    Label16.Caption = "//'Driver//': Kill 10 opponents with a Vehicle."
}

if ( Achieved(22) = 0 && WKills[0] >= 25 ) {
    shower = 22
    Label16.Caption = "//'Marksman//': Kill 25 opponents with a Pistol."
}
if ( Achieved(23) = 0 && WKills[1] >= 25 ) {
    shower = 23
    Label16.Caption = "//'Cavalry//': Kill 25 opponents with a Rocket Launcher."
}
if ( Achieved(24) = 0 && WKills[2] >= 25 ) {
    shower = 24
    Label16.Caption = "//'Specialist//': Kill 25 opponents with a Sniper."
}
if ( Achieved(25) = 0 && WKills[3] >= 25 ) {
    shower = 25
    Label16.Caption = "//'Bomber//': Kill 25 opponents with a Grenade Launcher."
}
if ( Achieved(26) = 0 && WKills[4] >= 25 ) {
    shower = 26
    Label16.Caption = "//'Hero//': Kill 25 opponents with a Shotgun."
}
if ( Achieved(27) = 0 && WKills[5] >= 25 ) {
    shower = 27
    Label16.Caption = "//'Villain//': Kill 25 opponents with a ScarH."
}
if ( Achieved(28) = 0 && WKills(99) >= 25 ) {
    shower = 28
    Label16.Caption = "//'The Ram//': Kill 25 opponents with a Vehicle."
}

if ( Achieved(29) = 0 && WKills[0] >= 60 ) {
    shower = 29
    Label16.Caption = "//'SharpShooter//': Kill 60 opponents with a Pistol."
}
if ( Achieved(30) = 0 && WKills[1] >= 60 ) {
    shower = 30
    Label16.Caption = "//'Terrorist//': Kill 60 opponents with a Rocket Launcher."
}
if ( Achieved(31) = 0 && WKills[2] >= 60 ) {
    shower = 31
    Label16.Caption = "//'Sniper//': Kill 60 opponents with a Sniper."
}
if ( Achieved(32) = 0 && WKills[3] >= 60 ) {
    shower = 32
    Label16.Caption = "//'Crazy//': Kill 60 opponents with a Grenade Launcher."
}
if ( Achieved(33) = 0 && WKills[4] >= 60 ) {
    shower = 33
    Label16.Caption = "//'Offender//': Kill 60 opponents with a Shotgun."
}
if ( Achieved(34) = 0 && WKills[5] >= 60 ) {
    shower = 34
    Label16.Caption = "//'Hired Gun//': Kill 60 opponents with a ScarH."
}
if ( Achieved(35) = 0 && WKills(99) >= 60 ) {
    shower = 35
    Label16.Caption = "//'Women Driver//': Kill 60 opponents with a Vehicle."
}
if ( Achieved(36) = 0 && TreeDown >= 10 ) {
    shower = 36
    Label16.Caption = "//'Gardener//': Destroy 10 trees in a single game."
}
if ( Achieved(37) = 0 && WKills(55) >= 5 ) {
    shower = 37
    Label16.Caption = "//'Zoom//': Kill 5 opponents while zoomed in."
}
if ( Achieved(38) = 0 && WKills(55) >= 15 ) {
    shower = 38
    Label16.Caption = "//'Stealth//': Kill 15 opponents while zoomed in."
}
if ( Achieved(39) = 0 && WKills(55) >= 40 ) {
    shower = 39
    Label16.Caption = "//'Ranger//': Kill 40 opponents while zoomed in."
}
if ( Achieved(40) = 0 && WKills(55) >= 80 ) {
    shower = 40
    Label16.Caption = "//'Old School//': Kill 80 opponents while zoomed in."
}
if ( Achieved(41) = 0 && WKills(66) >= 10 ) {
    shower = 41
    Label16.Caption = "//'End Game//': Kill 10 opponents while on less than 20% health."
}
if ( Achieved(42) = 0 && WKills(66) >= 20 ) {
    shower = 42
    Label16.Caption = "//'Killer Death//': Kill 20 opponents while on less than 20% health."
}
if ( Achieved(43) = 0 && WKills(66) >= 30 ) {
    shower = 43
    Label16.Caption = "//'Late Luck//': Kill 30 opponents while on less than 20% health."
}
if ( Achieved(44) = 0 && WKills(66) >= 40 ) {
    shower = 44
    Label16.Caption = "//'Undefeatable//': Kill 40 opponents while on less than 20% health."
}

if ( Achieved(48) = 0 && RKills > 4 ) {
    shower = 48
    Label16.Caption = "//'Overkill//': Kill five opponents within 3 seconds."
}
if ( Achieved(47) = 0 && RKills > 3 ) {
    shower = 47
    Label16.Caption = "//'Quadruple Kill//': Kill four opponents within 3 seconds."
}
if ( Achieved(46) = 0 && RKills > 2 ) {
    shower = 46
    Label16.Caption = "//'Triple Kill//': Kill three opponents within 3 seconds."
}
if ( Achieved(45) = 0 && RKills > 1 ) {
    shower = 45
    Label16.Caption = "//'Double Kill//': Kill two opponents within 3 seconds."
}

//'if ( GameType != 1 ) {
//'    if ( Achieved(49) = 0 && Health = 100 && Kills >= 10 ) {
//'        shower = 49
//'        Label16.Caption = "//'Early Luck//': Kill 10 opponents without losing any health."
//'    }
//'    if ( Achieved(50) = 0 && Health = 100 && Kills >= 20 ) {
//'        shower = 50
//'        Label16.Caption = "//'Legend//': Kill 20 opponents without losing any health."
//'    }
//'    if ( Achieved(51) = 0 && Health = 100 && Kills >= 30 ) {
//'        shower = 51
//'        Label16.Caption = "//'Untouchable//': Kill 30 opponents without losing any health."
//'    }
//'}
if ( Achieved(52) = 0 && Record > 10 && Hits >= Record ) {
    shower = 52
    Label16.Caption = "//'Perfect//': Fire at least 10 bullets with 100% accuracy"
}
if ( Achieved(53) = 0 && Record > 20 && Hits >= Record ) {
    shower = 53
    Label16.Caption = "//'On A Roll//': Fire at least 20 bullets with 100% accuracy"
}

if ( Achieved(54) = 0 && Weapon = 99 && doodad(MX, MY) = 180 ) {
    shower = 54
    Label16.Caption = "//'Implant//': Drive a vehicle inside a house"
}
if ( Achieved(55) = 0 && Int(Format(Now - Start, "MM")) >= 30 ) {
    shower = 55
    Label16.Caption = "//'Patience//': Play any game type for half an hour"
}

//'59 jump bullet
//'60 destroy a wall

if ( Achieved(61) = 0 && WKills[5] >= 1 && WKills[4] >= 1 && WKills[3] >= 1 && WKills[2] >= 1 && WKills[1] >= 1 && WKills[0] >= 1 ) {
    shower = 61
    Label16.Caption = "//'Multitask//': Kill 1 opponent with every avalable weapon"
}
if ( Achieved(62) = 0 && WKills[5] >= 3 && WKills[4] >= 3 && WKills[3] >= 3 && WKills[2] >= 3 && WKills[1] >= 3 && WKills[0] >= 3 ) {
    shower = 62
    Label16.Caption = "//'Consistency//': Kill 3 opponents with every avalable weapon"
}
if ( Achieved(63) = 0 && WKills[5] >= 5 && WKills[4] >= 5 && WKills[3] >= 5 && WKills[2] >= 5 && WKills[1] >= 5 && WKills[0] >= 5 ) {
    shower = 63
    Label16.Caption = "//'All Rounder//': Kill 5 opponents with every avalable weapon"
}

if ( Achieved(64) = 0 && WKills(99) = 0 && Weapon = 99 && Kills > 20 ) {
    shower = 64
    Label16.Caption = "//'Partial Driver//': Enter a Vehicle only after 20 kills"
}
if ( Achieved(65) = 0 && WKills(99) = 0 && Weapon = 99 && Kills > 40 ) {
    shower = 65
    Label16.Caption = "//'Getaway//': Enter a Vehicle only after 40 kills"
}
if ( Achieved(66) = 0 && WKills(99) = 0 && Weapon = 99 && Kills > 60 ) {
    shower = 66
    Label16.Caption = "//'Late Evac//': Enter a Vehicle only after 60 kills"
}

//'67 die by rocket

if ( Achieved(75) = 0 && (WKills[1] + WKills[3]) > 25 && Picture7.Visible = false ) {
    shower = 75
    Label16.Caption = "//'Detonator//': Kill a total of 25 opponents with heavy weapons"
}
if ( Achieved(76) = 0 && (WKills[1] + WKills[3]) > 10 && Picture7.Visible = false ) {
    shower = 76
    Label16.Caption = "//'Pyromaniac//': Kill a total of 10 opponents with heavy weapons"
}
if ( Achieved(97) = 0 && (WKills[1] + WKills[3]) > 60 && Picture7.Visible = false ) {
    shower = 97
    Label16.Caption = "//'Pyromaniac//': Kill a total of 60 opponents with heavy weapons"
}
//'77

if ( Achieved(78) = 0 && APPs > 20 && Picture7.Visible = false ) {
    shower = 78
    Label16.Caption = "//'Bonus 20//': Reach 20 Achievement Points"
}
if ( Achieved(79) = 0 && APPs > 40 && Picture7.Visible = false ) {
    shower = 79
    Label16.Caption = "//'Bonus 40//': Reach 40 Achievement Points"
}
if ( Achieved(80) = 0 && APPs > 60 && Picture7.Visible = false ) {
    shower = 80
    Label16.Caption = "//'Bonus 60//': Reach 60 Achievement Points"
}
if ( Achieved(81) = 0 && APPs > 80 && Picture7.Visible = false ) {
    shower = 81
    Label16.Caption = "//'Bonus 80//': Reach 80 Achievement Points"
}
if ( Achieved(143) = 0 && APPs > 100 && Picture7.Visible = false ) {
    shower = 143
    Label16.Caption = "//'Bonus 100//': Reach 100 Achievement Points"
}
if ( Achieved(144) = 0 && APPs > 120 && Picture7.Visible = false ) {
    shower = 144
    Label16.Caption = "//'Bonus 120//': Reach 120 Achievement Points"
}
if ( Achieved(145) = 0 && APPs > 140 && Picture7.Visible = false ) {
    shower = 145
    Label16.Caption = "//'Bonus 140//': Reach 140 Achievement Points"
}


if ( GameType = -5 ) {
    if ( Achieved(105) = 0 && Kills > 5 ) {
        shower = 105
        Label16.Caption = "Tournament: Killed 5 players in a tournament"
    }
    if ( Achieved(106) = 0 && Kills > 10 ) {
        shower = 106
        Label16.Caption = "Derby Driver: Killed 10 players in a tournament"
    }
    if ( Achieved(107) = 0 && Kills > 15 ) {
        shower = 107
        Label16.Caption = "Boxer: Killed 15 players in a tournament"
    }
    if ( Achieved(108) = 0 && Kills > 20 ) {
        shower = 108
        Label16.Caption = "Wresteler: Killed 20 players in a tournament"
    }
    if ( Achieved(109) = 0 && Kills > 25 ) {
        shower = 109
        Label16.Caption = "Champion: Killed 25 players in a tournament"
    }
    if ( Achieved(110) = 0 && Kills > 30 ) {
        shower = 110
        Label16.Caption = "Psycho: Killed 30 players in a tournament"
    }
    if ( Achieved(111) = 0 && Kills > 35 ) {
        shower = 111
        Label16.Caption = "Eliminator: Killed 35 players in a tournament"
    }
    if ( Achieved(112) = 0 && Kills > 40 ) {
        shower = 112
        Label16.Caption = "Terminator: Killed 40 players in a tournament"
    }
    if ( Achieved(113) = 0 && Kills > 50 ) {
        shower = 113
        Label16.Caption = "Eradicator: Killed 50 players in a tournament"
    }
    if ( Achieved(114) = 0 && Kills > 60 ) {
        shower = 114
        Label16.Caption = "Eradicator: Killed 60 players in a tournament"
    }
    if ( Achieved(115) = 0 && Kills > 70 ) {
        shower = 115
        Label16.Caption = "Professional: Killed 70 players in a tournament"
    }
    if ( Achieved(116) = 0 && Kills > 80 ) {
        shower = 116
        Label16.Caption = "Inhalator: Killed 80 players in a tournament"
    }
} else if ( GameType = 1 ) {
    if ( HScroll4Value > 1 ) {
        if ( Achieved(127) = 0 && objz > 4 ) {
            shower = 127
            Label16.Caption = "Objective1: Completed the first Four checkpoints on medium"
        }
        if ( Achieved(128) = 0 && objz > 7 ) {
            shower = 128
            Label16.Caption = "Objective2: Completed the first Seven checkpoints on medium"
        }
        if ( Achieved(129) = 0 && objz > 9 ) {
            shower = 129
            Label16.Caption = "Objective3: Completed the first Nine checkpoints on medium"
        }
        if ( Achieved(130) = 0 && objz > 11 ) {
            shower = 130
            Label16.Caption = "Objective4: Completed the mission on medium"
        }
    }
    if ( HScroll4Value > 2 ) {
        if ( Achieved(131) = 0 && objz > 4 ) {
            shower = 131
            Label16.Caption = "Objective5: Completed the first Four checkpoints on hard"
        }
        if ( Achieved(132) = 0 && objz > 7 ) {
            shower = 132
            Label16.Caption = "Objective6: Completed the first Seven checkpoints on hard"
        }
        if ( Achieved(133) = 0 && objz > 9 ) {
            shower = 133
            Label16.Caption = "Objective7: Completed the first Nine checkpoints on hard"
        }
        if ( Achieved(134) = 0 && objz > 11 ) {
            shower = 134
            Label16.Caption = "Objective8: Completed the mission on hard"
        }
    }
    if ( HScroll4Value > 3 ) {
        if ( Achieved(135) = 0 && objz > 4 ) {
            shower = 135
            Label16.Caption = "Objective9: Completed the first Four checkpoints on insane"
        }
        if ( Achieved(136) = 0 && objz > 7 ) {
            shower = 136
            Label16.Caption = "Objective10: Completed the first Seven checkpoints on insane"
        }
        if ( Achieved(137) = 0 && objz > 9 ) {
            shower = 137
            Label16.Caption = "Objective11: Completed the first Nine checkpoints on insane"
        }
        if ( Achieved(138) = 0 && objz > 11 ) {
            shower = 138
            Label16.Caption = "Objective12: Completed the mission on insane"
        }
    }
    if ( Achieved(139) = 0 && Kills >= 20 ) {
        shower = 139
        Label16.Caption = "Shoot through: Killed 20 opponents in a mission"
    }
    if ( Achieved(140) = 0 && Kills >= 40 ) {
        shower = 140
        Label16.Caption = "Drive through: Killed 40 opponents in a mission"
    }
    if ( Achieved(141) = 0 && Kills >= 50 ) {
        shower = 141
        Label16.Caption = "Fly through: Killed 50 opponents in a mission"
    }
    if ( Achieved(142) = 0 && Kills >= 60 ) {
        shower = 142
        Label16.Caption = "Blast through: Killed 60 opponents in a mission"
    }
}

//'145

if ( shower > -1 ) {
    if ( Achieved(shower) = 0 ) {
        Achieved(shower) = 1
        SaveSetting "Jonesy", "PP", "Ach" + shower, 1
        Picture7.Visible = true
        Picture7.Tag = 80
        Label15.Caption = "Achievement Unlocked"
    }
}
if ( Picture7.Visible = true ) {
    Picture7.Tag = Int(Picture7.Tag) - 1
    if ( Int(Picture7.Tag) <= 0 ) {
        Picture7.Visible = false
    }
}

}

function KillInc()
Kills = Kills + 1
RKills = RKills + 1
if ( RKDown = 0 ) { RKDown = 3: RKills = 1
WKills(Weapon) = WKills(Weapon) + 1
if ( Zoom > 1 ) { WKills(55) = WKills(55) + 1
if ( Health < 20 ) { WKills(66) = WKills(66) + 1
HitFor = 30
}


function ListX()
var i = 0; //xAs Long
var txt = ""; //xAs String
List2.Clear


List2.AddItem AchGot(105) + "Tournament: Killed 5 players in a tournament"
List2.AddItem AchGot(106) + "Derby Driver: Killed 10 players in a tournament"
List2.AddItem AchGot(107) + "Boxer: Killed 15 players in a tournament"
List2.AddItem AchGot(108) + "Wresteler: Killed 20 players in a tournament"
List2.AddItem AchGot(109) + "Champion: Killed 25 players in a tournament"
List2.AddItem AchGot(110) + "Psycho: Killed 30 players in a tournament"
List2.AddItem AchGot(111) + "Eliminator: Killed 35 players in a tournament"
List2.AddItem AchGot(112) + "Terminator: Killed 40 players in a tournament"
List2.AddItem AchGot(113) + "Eradicator: Killed 50 players in a tournament"
List2.AddItem AchGot(114) + "Eradicator: Killed 60 players in a tournament"
List2.AddItem AchGot(115) + "Professional: Killed 70 players in a tournament"
List2.AddItem AchGot(116) + "Inhalator: Killed 80 players in a tournament"

//'List2.AddItem AchGot(139) + "Shoot through: Killed 20 opponents in a mission"
//'List2.AddItem AchGot(140) + "Drive through: Killed 40 opponents in a mission"
//'List2.AddItem AchGot(141) + "Fly through: Killed 50 opponents in a mission"
//'List2.AddItem AchGot(142) + "Blast through: Killed 60 opponents in a mission"

//'List2.AddItem AchGot(127) + "Objective1: Completed the first Four checkpoints on medium"
//'List2.AddItem AchGot(128) + "Objective2: Completed the first Seven checkpoints on medium"
//'List2.AddItem AchGot(129) + "Objective3: Completed the first Nine checkpoints on medium"
//'List2.AddItem AchGot(130) + "Objective4: Completed the mission on medium"
//'List2.AddItem AchGot(131) + "Objective5: Completed the first Four checkpoints on hard"
//'List2.AddItem AchGot(132) + "Objective6: Completed the first Seven checkpoints on hard"
//'List2.AddItem AchGot(133) + "Objective7: Completed the first Nine checkpoints on hard"
//'List2.AddItem AchGot(134) + "Objective8: Completed the mission on hard"
//'List2.AddItem AchGot(135) + "Objective9: Completed the first Four checkpoints on insane"
//'List2.AddItem AchGot(136) + "Objective10: Completed the first Seven checkpoints on insane"
//'List2.AddItem AchGot(137) + "Objective11: Completed the first Nine checkpoints on insane"
//'List2.AddItem AchGot(138) + "Objective12: Completed the mission on insane"

List2.AddItem AchGot(83) + "//'Novice//': Reach 10 kills  in Survival."
List2.AddItem AchGot[7] + "//'Commander//': Reach 15 kills in Survival."
List2.AddItem AchGot(84) + "//'Marine//': Reach 20 kills in Survival."
List2.AddItem AchGot(85) + "//'Specialist//': Reach 25 kills in Survival."
List2.AddItem AchGot[8] + "//'Hit Man//': Reach 30 kills in Survival."
List2.AddItem AchGot(82) + "//'Assassin//': Reach 40 kills in Survival."
List2.AddItem AchGot[9] + "//'Ninja//': Reach 50 kills in Survival."
List2.AddItem AchGot(86) + "//'Sargent//': Reach 60 kills in Survival."
List2.AddItem AchGot(87) + "//'Admiral//': Reach 70 kills in Survival."
List2.AddItem AchGot(93) + "//'Top Dog//': Reach 80 kills in Survival."
List2.AddItem AchGot(94) + "//'Insurgent//': Reach 90 kills in Survival."
List2.AddItem AchGot(95) + "//'Gun Nut//': Reach 100 kills in Survival."
List2.AddItem AchGot(96) + "//'Massacre//': Reach 110 kills in Survival."

//'List2.AddItem AchGot(71) + "//'Learner//': Reach a score of 5 in any game."
//'List2.AddItem AchGot(72) + "//'Achiever//': Reach a score of 10 in any game."
//'List2.AddItem AchGot(73) + "//'Expert//': Reach a score of 15 in any game."
//'List2.AddItem AchGot[10] + "//'Pro Gamer//': Reach a score of 20 in any game."

List2.AddItem AchGot[11] + "//'Multiplayer//': Reach 15 kills in a multiplayer match."
List2.AddItem AchGot[12] + "//'Taking Off//': Reach 30 kills in a multiplayer match."
List2.AddItem AchGot[13] + "//'Piling Bodies//': Reach 45 kills in a multiplayer match."
List2.AddItem AchGot(98) + "//'Determination//': Reach 60 kills in a multiplayer match."
List2.AddItem AchGot(99) + "//'Solo//': Reach 70 kills in a multiplayer match."
List2.AddItem AchGot[14] + "//'Cheater//': Reach 80 kills in a multiplayer match."
List2.AddItem AchGot(100) + "//'Invincible//': Reach 90 kills in a multiplayer match."
List2.AddItem AchGot[15] + "//'Century//': Reach 100 kills in a multiplayer match."

List2.AddItem AchGot(56) + "//'Leader board//': Hold a top score over 10 in a multiplayer game"
List2.AddItem AchGot(57) + "//'Best Player//': Hold a top score over 30 in a multiplayer game"
List2.AddItem AchGot(58) + "//'Ownage//': Hold a top score over 60 in a multiplayer game"

List2.AddItem AchGot(68) + "//'Five to One//': Receive a kill death ratio of 5:1"
List2.AddItem AchGot(69) + "//'Ten to One//': Receive a kill death ratio of 10:1"
List2.AddItem AchGot(70) + "//'Fifteen to One//': Receive a kill death ratio of 15:1"
List2.AddItem AchGot(74) + "//'Twenty to One//': Receive a kill death ratio of 20:1"

List2.AddItem AchGot(16) + "//'Shooter//': kill 10 opponents with a Pistol."
List2.AddItem AchGot(22) + "//'Marksman//': kill 25 opponents with a Pistol."
List2.AddItem AchGot(29) + "//'SharpShooter//': kill 60 opponents with a Pistol."
List2.AddItem AchGot(17) + "//'Cannon//': kill 10 opponents with a Rocket Launcher."
List2.AddItem AchGot(23) + "//'Cavalry//': kill 25 opponents with a Rocket Launcher."
List2.AddItem AchGot(30) + "//'Terrorist//': kill 60 opponents with a Rocket Launcher."
List2.AddItem AchGot(18) + "//'HeadShot//': kill 10 opponents with a Sniper."
List2.AddItem AchGot(24) + "//'Specialist//': kill 25 opponents with a Sniper."
List2.AddItem AchGot(31) + "//'Sniper//': kill 60 opponents with a Sniper."
List2.AddItem AchGot(19) + "//'Thrower//': kill 10 opponents with a Grenade Launcher."
List2.AddItem AchGot(25) + "//'Bomber//': kill 25 opponents with a Grenade Launcher."
List2.AddItem AchGot(32) + "//'Crazy//': kill 60 opponents with a Grenade Launcher."
List2.AddItem AchGot(20) + "//'CloseKill//': kill 10 opponents with a Shotgun."
List2.AddItem AchGot(26) + "//'Hero//': kill 25 opponents with a Shotgun."
List2.AddItem AchGot(33) + "//'Offender//': kill 60 opponents with a Shotgun."
List2.AddItem AchGot(21) + "//'Assault//': kill 10 opponents with a ScarH."
List2.AddItem AchGot(27) + "//'Villain//': kill 25 opponents with a ScarH."
List2.AddItem AchGot(34) + "//'Hired Gun//': kill 60 opponents with a ScarH."
List2.AddItem AchGot(77) + "//'Driver//': kill 10 opponents with a Vehicle."
List2.AddItem AchGot(28) + "//'The Ram//': kill 25 opponents with a Vehicle."
List2.AddItem AchGot(35) + "//'Women Driver//': kill 60 opponents with a Vehicle."
List2.AddItem AchGot(76) + "//'Pyromaniac//': Kill a total of 10 opponents with heavy weapons"
List2.AddItem AchGot(75) + "//'Detonator//': Kill a total of 25 opponents with heavy weapons"
List2.AddItem AchGot(97) + "//'Pyromaniac//': Kill a total of 60 opponents with heavy weapons"

List2.AddItem AchGot(61) + "//'Multitask//': Kill 1 opponent with every avalable weapon"
List2.AddItem AchGot(62) + "//'Consistency//': Kill 3 opponents with every avalable weapon"
List2.AddItem AchGot(63) + "//'All Rounder//': Kill 5 opponents with every avalable weapon"

//'List2.AddItem AchGot(49) + "//'Early Luck//': kill 10 opponents without losing any health."
//'List2.AddItem AchGot(50) + "//'Legend//': kill 20 opponents without losing any health."
//'List2.AddItem AchGot(51) + "//'Untouchable//': kill 30 opponents without losing any health."

List2.AddItem AchGot(41) + "//'End Game//': kill 10 opponents while on less than 20% health."
List2.AddItem AchGot(42) + "//'Killer Death//': kill 20 opponents while on less than 20% health."
List2.AddItem AchGot(43) + "//'Late Luck//': kill 30 opponents while on less than 20% health."
List2.AddItem AchGot(44) + "//'Undefeatable//': kill 40 opponents while on less than 20% health."

List2.AddItem AchGot(45) + "//'Double Kill//': Kill two opponents within 3 seconds."
List2.AddItem AchGot(46) + "//'Triple Kill//': Kill three opponents within 3 seconds."
List2.AddItem AchGot(47) + "//'Quadruple Kill//': Kill four opponents within 3 seconds."
List2.AddItem AchGot(48) + "//'Overkill//': Kill five opponents within 3 seconds."

List2.AddItem AchGot(52) + "//'Perfect//': Fire at least 10 bullets with 100% accuracy"
List2.AddItem AchGot(53) + "//'On A Roll//': Fire at least 20 bullets with 100% accuracy"

List2.AddItem AchGot(37) + "//'Zoom//': kill 5 opponents while zoomed in."
List2.AddItem AchGot(38) + "//'Stealth//': kill 15 opponents while zoomed in."
List2.AddItem AchGot(39) + "//'Ranger//': kill 40 opponents while zoomed in."
List2.AddItem AchGot(40) + "//'Old School//': kill 80 opponents while zoomed in."

List2.AddItem AchGot(64) + "//'Partial Driver//': Enter a Vehicle only after 20 kills"
List2.AddItem AchGot(65) + "//'Getaway//': Enter a Vehicle only after 40 kills"
List2.AddItem AchGot(66) + "//'Late Evac//': Enter a Vehicle only after 60 kills"

//'List2.AddItem AchGot[0] + "//'End Of The Line//': Reach the checkpoint on medium."
//'List2.AddItem AchGot[1] + "//'Fighting Blind//': Reach the checkpoint on insane."

List2.AddItem AchGot(36) + "//'Gardener//': Destroy 10 trees in a single game."
List2.AddItem AchGot(54) + "//'Implant//': Drive a vehicle inside a house"
List2.AddItem AchGot(55) + "//'Patience//': Play any game type for half an hour"
List2.AddItem AchGot(59) + "//'Skill//': Jump over an approaching bullet"
List2.AddItem AchGot(60) + "//'Rage//': Destroy one wall piece in a single game"
List2.AddItem AchGot(67) + "//'Unlucky//': From full health, die of a lethal shot"

List2.AddItem AchGot(78) + "//'Bonus 20//': Reach 20 Achievement Points"
List2.AddItem AchGot(79) + "//'Bonus 40//': Reach 40 Achievement Points"
List2.AddItem AchGot(80) + "//'Bonus 60//': Reach 60 Achievement Points"
List2.AddItem AchGot(81) + "//'Bonus 80//': Reach 80 Achievement Points"
//'List2.AddItem AchGot(143) + "//'Bonus 100//': Reach 100 Achievement Points"
//'List2.AddItem AchGot(144) + "//'Bonus 120//': Reach 120 Achievement Points"
//'List2.AddItem AchGot(145) + "//'Bonus 140//': Reach 140 Achievement Points"

}

function AchGot(i = 0; //xAs Long) = ""; //xAs String
if ( Achieved[i] > 0 ) {
    AchGot = "Y "
} else {
    AchGot = "  "
}
}
function Hvr(x, y) {
var tr1 = 0; //xAs Long
var tr2 = 0; //xAs Long
var i = 0; //xAs Long
tr1 = Target
tr2 = Target + 60
if ( tr2 > 360 ) { tr2 = tr2 - 360
Me.DrawWidth = 3
For i = 0 To 3
    Me.Circle (x, y), 1000, RGB(255, 0, 0), tr1 / 45 * Math.atan(1), tr2 / 45 * Math.atan(1)
    tr1 = tr1 + 90
    tr2 = tr2 + 90
    if ( tr1 > 360 ) { tr1 = tr1 - 360
    if ( tr2 > 360 ) { tr2 = tr2 - 360
}; //Next i
Me.DrawWidth = 0
}

function drawface(x, y, size) {
var part = 0; //xAs Double
var i = 0; //xAs Long
var j = 0; //xAs Long
var k = 0; //xAs Long
part = size / 10
Picture18.PaintPicture Image2.Picture, 0, 0, Picture18.Width, Picture18.Height
For i = 0 To 18
    For j = 0 To 18
        k = Picture18.Point(Picture18.Width / 20 * (i + 0.5), Picture18.Height / 20 * (j + 0.5))
        if ( k != Picture15[4].BackColor ) {
            Me.Line (x - size + i * part, y - size + j * part)-(x - size + (i + 1) * part, y - size + (j + 1) * part), k, BF
        }
    }; //Next j
}; //Next i

//'drawface width / 2, height / 2, 1000
}

function testface()
var part = 0; //xAs Double
var i = 0; //xAs Long
var j = 0; //xAs Long
var k = 0; //xAs Long
Picture19.Cls
part = Picture19.Width / 40
For i = 0 To 36
    For j = 0 To 36
        k = Picture18.Point(Picture18.Width / 40 * (i + 0.5), Picture18.Height / 40 * (j + 0.5))
        if ( k != Picture15[4].BackColor ) {
            Picture19.Line (i * part, j * part)-((i + 1) * part, (j + 1) * part), k, BF
        }
    }; //Next j
}; //Next i

//'drawface width / 2, height / 2, 1000
}

function LoadAlt()
Push[204][107] = 11
Push[92][200] = 12
Push[97][200] = 12
Push[97][205] = 12
Push[92][205] = 12
Push[135][58] = 15
Push[122][33] = 18
Push[206][40] = 16
Push[85][35] = 19
Push[89][55] = 19
Push[165][50] = 19
Push[219][96] = 19
Push[63][53] = 19
Push[68][47] = 20
Push[82][48] = 20
Push[85][35] = 20
Push[99][42] = 20
Push[120][28] = 20
Push[123][28] = 20
Push[123][22] = 20
Push[119][21] = 20
Push[122][17] = 20
Push[141][54] = 20
Push[140][59] = 20
Push[147][60] = 20
Push[147][55] = 20
Push[152][58] = 20
Push[96][64] = 20
Push[118][65] = 10
Push[89][74] = 10
Push[95][77] = 10
Push[100][76] = 10
Push[107][76] = 10
Push[112][77] = 10
Push[116][75] = 10
Push[120][75] = 10
Push[118][79] = 10
Push[123][74] = 10
Push[126][72] = 10
Push[125][78] = 10
Push[110][77] = 10
Push[102][77] = 10
Push[193][32] = 10
Push[205][46] = 10
Push[208][46] = 10
Push[205][51] = 10
Push[208][52] = 10
Push[206][58] = 10
Push[222][81] = 10
Push[225][84] = 10
Push[214][96] = 20
Push[188][109] = 10
Push[193][118] = 10
Push[206][118] = 10
Push[185][118] = 10
Push[182][110] = 10
Push[192][116] = 10
Push[203][124] = 10
Push[191][129] = 10
Push[210][128] = 10
Push[220][127] = 10
Push[226][133] = 10
Push[227][138] = 10
Push[212][140] = 10
Push[205][136] = 10
Push[193][133] = 10
Push[191][140] = 10
Push[211][140] = 10
Push[220][133] = 10
Push[220][140] = 10
Push[197][140] = 10
Push[195][138] = 10
Push[195][141] = 10
Push[205][144] = 10
Push[212][148] = 10
Push[220][146] = 10
Push[225][140] = 10
Push[235][138] = 10
Push[230][145] = 10
Push[214][150] = 10
Push[198][151] = 10
Push[189][149] = 10
Push[186][150] = 10
Push[183][152] = 10
Push[187][158] = 10
Push[195][159] = 10
Push[215][160] = 10
Push[220][157] = 10
Push[223][162] = 10
Push[224][167] = 10
Push[220][172] = 10
Push[212][171] = 10
Push[208][165] = 10
Push[204][161] = 10
Push[194][157] = 10
Push[190][163] = 10
Push[190][168] = 10
Push[197][172] = 10
Push[206][174] = 10
Push[210][177] = 10
Push[203][179] = 10
Push[217][179] = 10
Push[218][177] = 10
Push[205][170] = 10
Push[189][160] = 10
Push[185][165] = 10
Push[187][170] = 10
Push[182][170] = 10
Push[181][158] = 10
Push[175][144] = 10
Push[176][145] = 10
Push[175][162] = 10
Push[171][164] = 10
Push[166][167] = 10
Push[169][181] = 10
Push[182][172] = 10
Push[187][170] = 10
Push[172][166] = 10
Push[172][162] = 10
Push[155][169] = 10
Push[155][160] = 10
Push[158][163] = 10
Push[159][167] = 10
Push[160][177] = 10
Push[157][182] = 10
Push[154][183] = 10
Push[144][185] = 10
Push[144][189] = 10
Push[143][193] = 10
Push[148][192] = 10
Push[162][187] = 10
Push[162][197] = 10
Push[158][198] = 10
Push[165][195] = 10
Push[175][183] = 10
Push[168][188] = 10
Push[161][201] = 10
Push[165][206] = 10
Push[175][212] = 10
Push[179][216] = 10
Push[173][210] = 10
Push[182][204] = 10
Push[196][200] = 10
Push[189][201] = 10
Push[175][202] = 10
Push[191][201] = 10
Push[207][195] = 10
Push[208][190] = 10
Push[210][195] = 10
Push[220][197] = 10
Push[215][200] = 10
Push[218][201] = 10
Push[209][200] = 10
Push[200][199] = 10
Push[216][202] = 10
Push[219][201] = 10
Push[220][207] = 10
Push[197][202] = 10
Push[212][200] = 10
Push[216][201] = 10
Push[220][205] = 10
Push[218][207] = 10
Push[221][206] = 10
Push[211][215] = 10
Push[210][213] = 10
Push[218][208] = 10
Push[220][218] = 10
Push[208][227] = 10
Push[202][230] = 10
Push[206][235] = 10
Push[193][234] = 10
Push[192][230] = 10
Push[193][227] = 10
Push[180][220] = 10
Push[177][224] = 10
Push[174][232] = 10
Push[176][238] = 10
Push[177][245] = 10
Push[167][245] = 10
Push[160][245] = 10
Push[155][244] = 10
Push[147][245] = 10
Push[141][246] = 10
Push[133][247] = 10
Push[143][243] = 10
Push[157][235] = 10
Push[160][229] = 10
Push[175][223] = 10
Push[156][223] = 10
Push[171][214] = 10
Push[159][226] = 10
Push[147][229] = 10
Push[142][225] = 10
Push[132][232] = 10
Push[130][235] = 10
Push[127][227] = 10
Push[125][220] = 10
Push[129][224] = 10
Push[128][219] = 10
Push[128][213] = 10
Push[124][212] = 10
Push[127][211] = 10
Push[137][217] = 10
Push[151][215] = 10
Push[154][207] = 10
Push[147][216] = 10
Push[158][214] = 10
Push[164][218] = 10
Push[150][220] = 10
Push[147][214] = 10
Push[159][199] = 10
Push[139][189] = 10
Push[149][187] = 10
Push[142][192] = 10
Push[145][183] = 10
Push[158][183] = 10
Push[160][196] = 10
Push[145][202] = 10
Push[131][199] = 10
Push[130][198] = 10
Push[137][192] = 10
Push[124][190] = 10
Push[122][194] = 10
Push[120][183] = 10
Push[118][191] = 10
Push[125][190] = 10
Push[122][182] = 10
Push[120][178] = 10
Push[119][176] = 10
Push[118][172] = 10
Push[114][170] = 10
Push[115][173] = 10
Push[115][166] = 10
Push[124][168] = 10
Push[117][171] = 10
Push[123][167] = 10
Push[127][176] = 10
Push[123][183] = 10
Push[119][190] = 10
Push[117][200] = 10
Push[130][201] = 10
Push[141][192] = 10
Push[132][183] = 10
Push[122][184] = 10
Push[100][175] = 10
Push[100][165] = 10
Push[104][168] = 10
Push[93][176] = 10
Push[88][171] = 10
Push[87][173] = 10
Push[87][182] = 10
Push[89][191] = 10
Push[85][184] = 10
Push[85][175] = 10
Push[89][171] = 10
Push[87][216] = 10
Push[84][212] = 10
Push[83][207] = 10
Push[84][210] = 10
Push[89][216] = 10
Push[94][215] = 10
Push[100][211] = 10
Push[100][206] = 10
Push[102][197] = 10
Push[102][211] = 10
Push[99][220] = 10
Push[88][222] = 10
Push[83][222] = 10
Push[74][217] = 10
Push[73][222] = 10
Push[71][215] = 10
Push[73][226] = 10
Push[80][230] = 10
Push[84][234] = 10
Push[84][235] = 10
Push[75][238] = 10
Push[80][232] = 10
Push[92][237] = 10
Push[89][235] = 10
Push[91][233] = 10
Push[88][241] = 10
Push[84][242] = 10
Push[83][244] = 10
Push[87][244] = 10
Push[91][245] = 10
Push[71][242] = 10
Push[66][243] = 10
Push[58][243] = 10
Push[52][245] = 10
Push[52][242] = 10
Push[54][241] = 10
Push[50][235] = 10
Push[52][228] = 10
Push[57][222] = 10
Push[57][229] = 10
Push[55][228] = 10
Push[49][224] = 10
Push[45][217] = 10
Push[40][219] = 10
Push[40][225] = 10
Push[36][220] = 10
Push[36][219] = 10
Push[40][222] = 10
Push[39][212] = 10
Push[40][211] = 10
Push[35][213] = 10
Push[36][211] = 10
Push[44][201] = 10
Push[49][204] = 10
Push[50][208] = 10
Push[49][213] = 10
Push[50][209] = 10
Push[52][212] = 10
Push[46][204] = 10
Push[51][197] = 10
Push[56][195] = 10
Push[63][196] = 10
Push[61][146] = 10
Push[63][145] = 10
Push[65][147] = 10
Push[66][141] = 10
Push[65][137] = 10
Push[66][132] = 10
Push[71][127] = 10
Push[76][126] = 10
Push[74][127] = 10
Push[68][129] = 10
Push[75][127] = 10
Push[80][130] = 10
Push[84][135] = 10
Push[82][143] = 10
Push[73][146] = 10
Push[71][150] = 10
Push[80][145] = 10
Push[137][132] = 10
Push[132][130] = 10
Push[130][120] = 10
Push[133][117] = 10
Push[142][115] = 10
Push[145][118] = 10
Push[148][125] = 10
Push[145][132] = 10
Push[135][135] = 10
Push[150][129] = 10
Push[151][124] = 10
Push[150][117] = 10
Push[126][111] = 10
Push[17][93] = 10
Push[22][95] = 10
Push[31][90] = 10
Push[35][85] = 10
Push[32][76] = 10
Push[30][74] = 10
Push[32][72] = 10
Push[37][80] = 10
Push[33][88] = 10
Push[20][95] = 10
Push[10][87] = 10
Push[18][80] = 10
Push[22][75] = 10
Push[11][81] = 10
Push[5][75] = 10
Push[7][77] = 10
Push[8][80] = 10
Push[6][84] = 10
Push[14][89] = 10
Push[9][89] = 10
Push[22][72] = 10
Push[27][70] = 10
Push[35][71] = 10
Push[38][75] = 10
Push[29][62] = 10
Push[16][61] = 10
Push[16][59] = 10
Push[18][58] = 10
Push[11][57] = 10
Push[6][57] = 10
Push[3][57] = 10
Push[9][55] = 10
Push[27][57] = 10
Push[33][57] = 10
Push[20][129] = 10
Push[24][135] = 10
Push[17][130] = 10
Push[23][131] = 10
Push[24][138] = 10
Push[10][137] = 10
Push[11][132] = 10
Push[25][135] = 10
Push[56][152] = 10
Push[55][155] = 10
Push[52][159] = 10
Push[4][235] = 10
Push[7][245] = 10
Push[106][77] = 14

Push[92][38] = 20
Push[104][40] = 20
Push[157][26] = 20
Push[157][21] = 20
Push[165][21] = 20
Push[165][26] = 20
Push[169][24] = 20
Push[136][15] = 20
Push[159][41] = 20
Push[223][83] = 9

}

function newPush(x, y)

if ( Push(x, y - 1) != -1 && Push(x, y + 1) != -1 ) {
    Push(x, y) = Push(x, y + 1)
} else if ( Push(x - 1, y) != -1 && Push(x + 1, y) != -1 ) {
    Push(x, y) = Push(x + 1, y)
} else {
    Push(x, y) = -1
}

}
*/
/*
function CalcAngle(FirstX = 0; //xAs Double, FirstY = 0; //xAs Double) = 0; //xAs Double
On Error Resume }; //Next
var Angle = 0; //xAs Double

Angle = (Math.atan(FirstY / FirstX)) * (180 / (Math.atan(1) * 4))

if ( FirstX = 0 ) {
    if ( FirstY <= 0 ) {
        CalcAngle = 270
    } else {
        CalcAngle = 90
    }
} else if ( FirstX < 0 ) {
    CalcAngle = 180 + Angle
} else {
    if ( FirstY <= 0 ) {
        CalcAngle = 360 + Angle
    } else {
        CalcAngle = Angle
    }
}

}
*/
function WeaponDrw() {
    
    //text (Weapon, 0, 50);
    //ellipse(width/2 - 5,height/2-5,10,RGB(255,255,255));
    
    if (Rcoil > 0) {
        line(width/2 - 5,height/2,width/2 + 5,height/2,RGB(255,0,0));
        line(width/2,height/2 - 5,width/2,height/2 + 5,RGB(255,0,0));
    } else {
        line(width/2 - 10,height/2,width/2 + 10,height/2,RGB(255,255,255));
        line(width/2,height/2 - 10,width/2,height/2 + 10,RGB(255,255,255));
        fill({'r':255,'g':255,'b':255,'a':0})
        stroke(RGB(255,255,255))
        ellipse(width/2-20,height/2-20,20,RGB(255,255,255));
    }
    //Weapon = 1;
    if ( Zoom <= 1 ) {
        var wepw = height / 600 * 800;
        if (Weapon == 0) {
            picture((width - wepw)/2,0,wepw,height,"Pistol",0);
        } else if (Weapon == 1) {
            picture(-width*0.15,width*0.04,width*1.15,height,"Rocket",0);
        } else if (Weapon == 2) {
            picture((width - wepw)/2,0,wepw,height,"Sniper",0);
        } else if (Weapon == 3) {
            picture((width - wepw)/2,0,wepw,height,"Grenade",0);
        } else if (Weapon == 4) {
            picture((width - wepw)/2,0,wepw,height,"Shotgun",0);
        } else if (Weapon == 5) {
            picture((width - wepw)/2,0,wepw,height,"Rifle",0);
        }
    }

    var Max = 0;
    if (Weapon == 0) { Max = 17; }
    if (Weapon == 1) { Max = 2; }
    if (Weapon == 2) { Max = 5; }
    if (Weapon == 3) { Max = 6; }
    if (Weapon == 4) { Max = 12; }
    if (Weapon == 5) { Max = 20; }
    if (Clip2 == true) {
        for (var i = 0; i < Max; i++) {
            rect((i+1) * height / 60,height - height / 20 *3, height / 80,height / 80 * 3, RGB(255,0,0));
        }
        if (Ammo == 0) {
            Clip2 = false
            Ammo = Max
        }
    }
    for (var i = 0; i < Max; i++) {
        if (i < Ammo) {
            rect((i+1) * height / 60,height - height / 20 * 2, height / 80,height / 80 * 3, RGB(255,0,0));
        } else {
            rect((i+1) * height / 60,height - height / 20 * 2, height / 80,height / 80 * 3, RGB(255,200,200));
        }
    }
}
/*
function WeaponDrw()
On Error Resume }; //Next
var i = 0; //xAs Long
var j = 0; //xAs Long
var k = 0; //xAs Long
var Ln = 0; //xAs Long
var Lu = 0; //xAs Long
var Clr = 0; //xAs Long

Clr = RGB(0, 0, 255)

if ( Ammo > 0 || Clip2 = true ) {
    Ln = Int(width / 300 / 15) * 15
    For i = 1 To Ammo + 1
        if ( i = Ammo + 1 && Clip2 = true ) {
            Me.Line (Ln * 3 * (i - 1), height - Ln * 20)-(Ln * 3 * (i - 1) + Ln * 5, height - Ln * 10), RGB(255, 0, 0), BF
            if ( i = 1 ) {
                Select Case Weapon
                Case 0 //'pistol
                    Ammo = 17
                Case 5 //'scarh
                    Ammo = 20
                Case 3 //'glauncher
                    Ammo = 6
                Case 1 //'rlauncher
                    Ammo = 2
                Case 4 //'shotgun
                    Ammo = 12
                Case 2 //'sniper
                    Ammo = 5
                End Select
                Clip2 = false
            }
        } else if ( i < Ammo + 1 ) {
            Me.Line (Ln * 3 * (i - 1), height - Ln * 20)-(Ln * 3 * (i - 1) + Ln * 2, height - Ln * 10), RGB(255, 0, 0), BF
        }
    }; //Next i
    
    if ( Rcoil > 0 ) {
        Me.DrawWidth = 2
        Me.Line (width / 15 * 8, height / 15 * 8)-(width / 15 * 7, height / 15 * 7), RGB(255, 255, 0)
        Me.Line (width / 15 * 7, height / 15 * 8)-(width / 15 * 8, height / 15 * 7), RGB(255, 255, 0)
    } else {
        Me.DrawWidth = 5
        Select Case Weapon
        Case 0
            Me.Circle (width / 2, height / 2), width / 100, Clr
        Case 2
            Me.Circle (width / 2, height / 2), width / 150, Clr
        Case 3
            Me.Circle (width / 2, height / 2), width / 30, Clr
            Me.Line (width / 10 * 5, height / 10 * 5)-(width / 10 * 5, height / 10 * 6), Clr
        Case 1
            Me.Circle (width / 2, height / 2), width / 20, Clr
            Me.Circle (width / 2, height / 2), width / 15, Clr, 0, Math.atan(1) * 4
        Case 4
            Me.Line (width / 10 * 4, height / 10 * 5)-(width / 10 * 6, height / 10 * 5), Clr
            Me.Line (width / 10 * 5, height / 10 * 4)-(width / 10 * 5, height / 10 * 6), Clr
        Case 5
            Me.Line (width / 20 * 9, height / 20 * 9)-(width / 20 * 11, height / 20 * 11), Clr
            Me.Line (width / 20 * 9, height / 20 * 11)-(width / 20 * 11, height / 20 * 9), Clr
        End Select
    }
    
    Me.DrawWidth = 1
} else {
    Me.DrawWidth = 5
    Me.Line (width / 10 * 4, height / 10 * 4)-(width / 10 * 6, height / 10 * 6), RGB(255, 0, 0)
    Me.Line (width / 10 * 6, height / 10 * 4)-(width / 10 * 4, height / 10 * 6), RGB(255, 0, 0)
    Me.DrawWidth = 1
}

Me.DrawWidth = 5
For k = 0 To 5
    if ( fromt[k] > 0 ) {
        fromt[k] = fromt[k] - 3
        i = 360 - (fromr[k] + RX) - 20
        j = 360 - (fromr[k] + RX) + 20
        if ( i > 360 ) { i = i - 360
        if ( i < 0 ) { i = i + 360
        if ( j > 360 ) { j = j - 360
        if ( j < 0 ) { j = j + 360
        Me.Circle (width / 2, height / 2), width / 13, RGB(fromt[k], 0, 0), i / 45 * Math.atan(1), j / 45 * Math.atan(1)
    }
}; //Next k
Me.DrawWidth = 1

Ln = Int(width / 3 / 15) * 15 //' across
Lu = Int(Ln / 4 * 3 / 15) * 15 //'up

if ( Zoom = 1 ) {
    Select Case Weapon
    Case 0 //'pistol
        Me.PaintPicture Picture8[0].Picture, width - Ln, height - Lu, Ln, Lu
        //'Me.PaintPicture Picture8[1].Picture, width - Ln, height - Lu * 2, Ln, Lu
        Exit Sub
    Case 5 //'scarh
        Me.PaintPicture Picture8[2].Picture, width - Ln, height - Lu, Ln, Lu
        Me.PaintPicture Picture8[3].Picture, width - Ln * 2, height - Lu, Ln, Lu
        Exit Sub
    Case 3 //'glauncher
        Me.PaintPicture Picture8[4].Picture, width - Ln, height - Lu, Ln, Lu
        Me.PaintPicture Picture8[5].Picture, width - Ln * 2, height - Lu, Ln, Lu
        Exit Sub
    Case 1 //'rlauncher
        Me.PaintPicture Picture8[6].Picture, width - Ln, height - Lu, Ln, Lu
        Me.PaintPicture Picture8[7].Picture, width - Ln * 2, height - Lu, Ln, Lu
        Me.PaintPicture Picture8[8].Picture, width - Ln * 3, height - Lu, Ln, Lu
        Exit Sub
    Case 4 //'shotgun
        Me.PaintPicture Picture8[9].Picture, width - Ln, height - Lu, Ln, Lu
        Me.PaintPicture Picture8[10].Picture, width - Ln * 2, height - Lu, Ln, Lu
        Exit Sub
    Case 2 //'sniper
        Me.PaintPicture Picture8[11].Picture, width - Ln, height - Lu, Ln, Lu
        Me.PaintPicture Picture8[12].Picture, width - Ln * 2, height - Lu, Ln, Lu
        Me.PaintPicture Picture8[13].Picture, width - Ln, height - Lu * 2, Ln, Lu
        Exit Sub
    End Select
}
}

*/



</script>

</body>
</html>